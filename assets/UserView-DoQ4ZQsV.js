import{d as Y,a2 as ee,e as u,B as O,h as ae,N as p,O as C,k as e,V as t,a8 as _,a3 as V,a0 as i,a4 as te,U as I,a1 as oe,a5 as g,Z as R,Q as ne}from"./index-zZenVJyi.js";import{C as le,_ as se,a as ue}from"./index-Dcq4Csls.js";import{M as re}from"./index-D7FkeaBf.js";import{I as de,_ as ie,B as me,F as pe,b as _e}from"./index-D9b0YG0K.js";import{T as ce,S as ve}from"./index-DK8MMHZs.js";import{_ as fe,a as ye,b as ge}from"./index-CULPYIt3.js";import"./index-D8Wg6yGu.js";import"./PlusOutlined-jRU3ZTOg.js";import"./FolderOutlined-BasV0p63.js";const ke={class:"user"},be={class:"tools"},Ce=Y({__name:"UserView",setup(Ie){const r=ee({keyword:"",pageNumber:1,pageSize:10}),w=u([]),h=u([{title:"用户名",key:"username",dataIndex:"username"},{title:"名称",key:"name",dataIndex:"name"},{title:"邮箱",key:"email",dataIndex:"email"},{title:"角色",key:"roleId",dataIndex:"roleId"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),k=u(!1),x=u(),z=()=>{var o;(o=x.value)==null||o.resetFields(),m()},F=u(0),$=()=>{r.pageNumber=1,r.pageSize=10,m()},L=o=>{const{current:a,pageSize:l}=o;r.pageNumber=a,r.pageSize=l,m()},m=()=>{k.value=!0,_.getList(r).then(o=>{const{code:a,data:l}=o;a==200&&(w.value=l.data,F.value=l.total),k.value=!1})};O(()=>{m()});const c=u(!1),s=u({username:"",name:"",password:"",email:"",avatar:"",roleId:""}),v=u("add"),M=ae(()=>({add:"新增用户",edit:"编辑用户"})[v.value]),N=u(),j=()=>{v.value="add",c.value=!0,s.value={username:"",name:"",password:"",email:"",avatar:"",roleId:""}},E=async o=>{const{code:a,data:l}=await _.getDetail(o.username);a==200&&(s.value=l,v.value="edit",c.value=!0)},P=async o=>{const{code:a,msg:l,data:d}=await _.remove(o.username);a==200&&(V.success(d),m())},T=()=>{var o;(o=N.value)==null||o.resetFields()},A=()=>{let o;v.value=="add"?o=_.add:o=_.update,o(s.value).then(a=>{const{code:l}=a;l==200&&(V.success(v.value=="add"?"新增成功":"编辑成功"),m()),T(),c.value=!1})},U=u([]),Q=()=>{_.getRoleDict().then(o=>{const{code:a,data:l,msg:d}=o;a==200&&(U.value=l)})};return O(()=>{Q()}),(o,a)=>{const l=de,d=ie,D=se,f=me,Z=ue,S=pe,B=le,b=ce,q=fe,G=ye,H=ge,J=_e,K=ve,W=re;return p(),C("div",ke,[e(B,{class:"search-area"},{default:t(()=>[e(S,{ref_key:"searchFormRef",ref:x,model:r,onFinish:$},{default:t(()=>[e(Z,{gutter:24},{default:t(()=>[e(D,{span:4},{default:t(()=>[e(d,{label:"用户名",name:"keyword"},{default:t(()=>[e(l,{value:r.keyword,"onUpdate:value":a[0]||(a[0]=n=>r.keyword=n)},null,8,["value"])]),_:1})]),_:1}),e(D,{span:4,style:{"text-align":"right"}},{default:t(()=>[e(f,{type:"primary","html-type":"submit"},{default:t(()=>[i("搜索")]),_:1}),e(f,{style:{margin:"0 8px"},onClick:z},{default:t(()=>[i(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(B,null,{default:t(()=>[te("div",be,[e(f,{type:"primary",onClick:j},{default:t(()=>[i("新增")]),_:1})]),e(H,{loading:k.value,columns:h.value,"data-source":w.value,scroll:{y:440},onChange:L,pagination:{current:r.pageNumber,total:F.value}},{bodyCell:t(({column:n,record:y})=>[n.key=="role"?(p(),I(b,{key:0},{default:t(()=>[i(oe(y.role),1)]),_:2},1024)):g("",!0),n.key=="action"?(p(),C(R,{key:1},[e(f,{type:"link",onClick:X=>E(y)},{default:t(()=>[i("编辑")]),_:2},1032,["onClick"]),e(q,{type:"vertical"}),e(G,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:X=>P(y)},{default:t(()=>[e(f,{type:"link",danger:""},{default:t(()=>[i("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):g("",!0),n.key=="userType"?(p(),C(R,{key:2},[y.userType=="app"?(p(),I(b,{key:0,color:"#2db7f5"},{default:t(()=>[i("菜单")]),_:1})):g("",!0),y.userType=="directory"?(p(),I(b,{key:1,color:"#87d068"},{default:t(()=>[i("目录")]),_:1})):g("",!0)],64)):g("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(W,{open:c.value,"onUpdate:open":a[6]||(a[6]=n=>c.value=n),onOk:A,title:M.value,onCancel:T},{default:t(()=>[e(S,{model:s.value,"label-col":{span:8},ref_key:"modalFormRef",ref:N},{default:t(()=>[e(d,{label:"用户名"},{default:t(()=>[e(l,{value:s.value.username,"onUpdate:value":a[1]||(a[1]=n=>s.value.username=n)},null,8,["value"])]),_:1}),e(d,{label:"密码"},{default:t(()=>[e(J,{value:s.value.password,"onUpdate:value":a[2]||(a[2]=n=>s.value.password=n)},null,8,["value"])]),_:1}),e(d,{label:"角色"},{default:t(()=>[e(K,{value:s.value.roleId,"onUpdate:value":a[3]||(a[3]=n=>s.value.roleId=n),fieldNames:{label:"roleName",value:"roleId"},options:U.value},null,8,["value","options"])]),_:1}),e(d,{label:"名称"},{default:t(()=>[e(l,{value:s.value.name,"onUpdate:value":a[4]||(a[4]=n=>s.value.name=n)},null,8,["value"])]),_:1}),e(d,{label:"邮箱"},{default:t(()=>[e(l,{value:s.value.email,"onUpdate:value":a[5]||(a[5]=n=>s.value.email=n)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Oe=ne(Ce,[["__scopeId","data-v-b9e1fb1f"]]);export{Oe as default};
