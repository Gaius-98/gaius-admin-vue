import{_ as G}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-BoPyR6Hq.js";import{t as K}from"./table-CpzgOonY.js";import{h as M}from"./http-3qxdZzfw.js";import{d as O,au as j,r as u,p as Z,w as S,D as b,I,E as $,F as i,U as D,g as e,R as q,$ as H,M as F,Z as T,G as k,S as U,N as V,V as L,aD as J,K as Q}from"./index-Cq8ALRAC.js";import{C as W,_ as X,a as Y}from"./index-D9kNgwu2.js";import{U as tt}from"./index-BdqCsRYR.js";import{D as at}from"./index-DD_NySnd.js";import{B as et}from"./index-Dm_lgmPP.js";import{I as ot}from"./index-aIXwfiX9.js";import{S as nt}from"./SyncOutlined-C9ShVASm.js";import{_ as st,a as rt}from"./index-shavymTP.js";import{a as lt}from"./LowCodeForm.vue_vue_type_script_setup_true_lang-BrxHCIH2.js";import"./form-CnxAt-Qx.js";import"./index-DqWLH9mZ.js";import"./PlusOutlined-DGl1G9RV.js";import"./SwapOutlined-Byyryh5r.js";import"./FolderOutlined-iU2bDNCJ.js";import"./ArrowRightOutlined-Cso8Hjmj.js";import"./index-LtVkyVXa.js";import"./index-V4X8t6ob.js";import"./index-CwmgX1of.js";import"./common-Czp8UCrs.js";import"./index-B_2L_z_B.js";import"./index-CHt5pdN2.js";import"./SwapRightOutlined-rRDcYFwa.js";import"./index-BUyU8qsm.js";const it=r=>{const l={};return r.reduce((o,t)=>(o[t.key]=t.defaultValue,o),l),l},ct=async(r,l,o)=>{try{const t=await M.run(r.interfaceUrl,{...l,...o});return new Function("res",r.handlerFunc)(t.data)}catch(t){return t}},z={refreshData:ct,transformParamsData:it},ut={class:"low-code-table"},pt={style:{"font-size":"12px"}},mt={class:"tools"},_t=["href"],dt=O({__name:"LowCodeTable",props:{id:{}},setup(r){const l=r,{id:o}=j(l),t=u({}),m=u([]),p=u({}),h=u(!1),w=()=>{p.value={},f()},_=u(!1),B=Z(()=>{var n,a,s,g,C,v;return((s=(a=(n=t.value)==null?void 0:n.global)==null?void 0:a.filterCfg)==null?void 0:s.show)&&((v=(C=(g=t.value)==null?void 0:g.global)==null?void 0:C.filterCfg)==null?void 0:v.formId)}),d=u({});S(()=>o.value,()=>{K.getDetail(o.value).then(n=>{const{code:a,data:s,msg:g}=n;a==200&&(t.value=s,d.value=z.transformParamsData(t.value.variablePool),f())})},{immediate:!0}),S(()=>d.value,()=>{f()},{deep:!0});const N=u(0),f=async()=>{h.value=!0;try{const{data:n,total:a}=await z.refreshData(t.value.dataSource,d.value,p.value);m.value=n,a&&(N.value=a)}catch(n){q.error("获取数据失败:"+n)}h.value=!1};return(n,a)=>{const s=et,g=X,C=Y,v=W,R=ot,A=st,E=rt;return b(),I("div",ut,[B.value?(b(),$(v,{key:0,class:"filter-panel"},{default:i(()=>[e(G,{formData:p.value,"onUpdate:formData":a[0]||(a[0]=y=>p.value=y),id:t.value.global.filterCfg.formId,class:H(["filter-form",_.value?"expand":""])},null,8,["formData","id","class"]),e(C,null,{default:i(()=>[e(g,{span:24,style:{"text-align":"right"}},{default:i(()=>[e(s,{type:"primary","html-type":"submit",onClick:f},{default:i(()=>[F("搜索")]),_:1}),e(s,{style:{margin:"0 8px"},onClick:w},{default:i(()=>[F("重置")]),_:1}),e(s,{type:"link",icon:T(_.value?k(tt):k(at)),onClick:a[1]||(a[1]=y=>_.value=!_.value)},{default:i(()=>[U("span",pt,V(_.value?"收起":"展开"),1)]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})):D("",!0),e(v,{class:"table-container"},{default:i(()=>{var y,P;return[U("div",mt,[e(s,{icon:T(k(nt)),type:"link",title:"刷新数据",style:{float:"right"},onClick:f},null,8,["icon"])]),e(A,{columns:t.value.columns,"data-source":m.value,scroll:{y:B.value?300:500},loading:h.value,pagination:!1},{bodyCell:i(({column:c,record:x})=>[c.type=="image"?(b(),$(R,{key:0,src:`${x[c.dataIndex]}`,height:"130px",width:"100%"},null,8,["src"])):D("",!0),c.type=="link"?(b(),I("a",{key:1,href:`${x[c.dataIndex]}`,target:"_blank"},V(x[c.dataIndex]),9,_t)):D("",!0)]),_:1},8,["columns","data-source","scroll","loading"]),e(E,{style:{display:"flex","justify-content":"flex-end"},current:d.value.pageNumber,"onUpdate:current":a[2]||(a[2]=c=>d.value.pageNumber=c),defaultPageSize:(P=(y=t.value.global)==null?void 0:y.pagination)==null?void 0:P.pageSize,total:N.value,"show-less-items":""},null,8,["current","defaultPageSize","total"])]}),_:1})])}}}),ft=L(dt,[["__scopeId","data-v-18601a39"]]),gt=O({__name:"PreviewTable",props:{id:{}},setup(r){const l=r,{id:o}=j(l),t=J(),m=()=>{t.go(-1)};return(p,h)=>{const w=lt;return b(),I(Q,null,[e(w,{title:"预览表格",onBack:m,class:"page-header"}),e(ft,{id:k(o)},null,8,["id"])],64)}}}),Gt=L(gt,[["__scopeId","data-v-50c7d057"]]);export{Gt as default};
