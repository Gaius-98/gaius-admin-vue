import{d as j,R as Y,r as $,S as L,L as J,w as Q,o as ee,U as R,V as C,W as te,X as ae,F as se,Y as oe,Z as H,u as le}from"./@vue-erW_et9m.js";var re=Object.defineProperty,ue=(e,t,a)=>t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,ne=(e,t,a)=>ue(e,t+"",a),M,ie=new Uint8Array(16);function de(){if(!M&&(M=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!M))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return M(ie)}const he=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function fe(e){return typeof e=="string"&&he.test(e)}var r=[];for(var S=0;S<256;++S)r.push((S+256).toString(16).substr(1));function ve(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase();if(!fe(a))throw TypeError("Stringified UUID is invalid");return a}function pe(e,t,a){e=e||{};var o=e.random||(e.rng||de)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,ve(o)}const ce=(e,t)=>{const a=e.__vccOpts||e;for(const[o,n]of t)a[o]=n;return a},me=(e,t)=>{let a=null;return(...o)=>{a||(e.apply(void 0,o),a=window.setTimeout(()=>{a=null},t))}},ge={class:"container"},be=["onMousedown"],we=j({__name:"GuDragResizePlus",props:Y({minh:{default:10},minw:{default:10},disabled:{type:Boolean,default:!1},width:{default:100},height:{default:100},top:{default:0},left:{default:0},nodeKey:{default:pe()},active:{type:Boolean,default:!0},wait:{default:10},scaleX:{default:1},scaleY:{default:1}},{left:{required:!0},leftModifiers:{},top:{required:!0},topModifiers:{},width:{required:!0},widthModifiers:{},height:{required:!0},heightModifiers:{}}),emits:Y(["update","beforeTransform"],["update:left","update:top","update:width","update:height"]),setup(e,{emit:t}){const a=$(null),o=L(e,"left"),n=L(e,"top"),m=L(e,"width"),g=L(e,"height"),I=e,O=$([{name:"top-point",direction:"t"},{name:"left-point",direction:"l"},{name:"bottom-point",direction:"b"},{name:"right-point",direction:"r"}]),{nodeKey:_,minh:V,minw:z,disabled:k,wait:A,scaleX:T,scaleY:B}=J(I),G=(s,f)=>{if(k.value)return;const{direction:l}=f,u=s.x,i=s.y,{top:d,left:v,width:h,height:c}=K(a.value);X({width:h,top:d,left:v,height:c,nodeKey:_.value});const y=E=>{const p={width:h,top:d,left:v,height:c},b=(E.y-i)/B.value,w=(E.x-u)/T.value;switch(l){case"t":p.height=c-b,p.top=d+b;break;case"l":p.width=h-w,p.left=v+w;break;case"b":p.height=c+b;break;case"r":p.width=h+w;break}U(p)},x=()=>{W(),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",x)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",x)},N=s=>{if(k.value)return;const f=s.x,l=s.y,u=a.value.parentElement.offsetWidth,i=a.value.parentElement.offsetHeight,{top:d,left:v,width:h,height:c}=K(a.value);X({width:h,top:d,left:v,height:c,nodeKey:_.value});const y=E=>{const p={width:h,top:d,left:v,height:c},b=(E.y-l)/B.value,w=(E.x-f)/T.value;v+w+h>u?p.left=u-h:p.left=v+w,d+b+c>i?p.top=i-c:p.top=d+b,U(p)},x=()=>{W(),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",x)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",x)},K=s=>{let f=/(\d+px, \d+px)/;const l=s.style.transform;let u="0",i="0";return l&&([u,i]=l.match(f)[0].split(",")),{left:parseFloat(u),top:parseFloat(i),width:parseFloat(s.style.width),height:parseFloat(s.style.height)}},P=t,q=$(!0),F=s=>{const{top:f,left:l,width:u,height:i}=Z(s);if(q.value=!1,n.value=f,o.value=l,m.value=u,g.value=i,a.value){const d=a.value.style.transform;a.value.style.width=`${m.value}px`,a.value.style.height=`${g.value}px`,a.value.style.transform=`${D(d)} translate3d(${o.value}px, ${n.value}px,0)`}},U=me(F,A.value),D=s=>s?s.replace(/^translate3d\([^)]+\)$/,""):"",Z=s=>{const{height:f,width:l,left:u,top:i}=s,d=a.value.parentElement;if(!d||q.value)return{height:f,width:l,left:u,top:i};const v=d.offsetHeight,h=d.offsetWidth;return f<V.value?s.height=V.value:f>v&&(s.height=v),l<z.value?s.width=z.value:l>h&&(s.width=h),u<0?s.left=0:u+l>h&&(s.width=h-u),i<0?s.top=0:i+f>v&&(s.height=v-i),s},W=()=>{P("update",{top:n.value,left:o.value,width:m.value,height:g.value,nodeKey:_.value})},X=s=>{P("beforeTransform",s)};return Q(()=>[o.value,m.value,g.value,n.value],()=>{if(a.value){const s=a.value.style.transform;a.value.style.width=`${m.value}px`,a.value.style.height=`${g.value}px`,a.value.style.transform=`${D(s)} translate3d(${o.value}px, ${n.value}px,0)`}}),ee(()=>{F({width:m.value,height:g.value,left:o.value,top:n.value})}),(s,f)=>(R(),C("div",{ref_key:"guDragResizePlusRef",ref:a,class:H(["gu-drag-resize-plus",{disabled:le(k),active:s.active}]),onMousedown:N},[te("div",ge,[ae(s.$slots,"default",{},void 0)]),(R(!0),C(se,null,oe(O.value,l=>(R(),C("div",{key:l.name,class:H(["resize-point",l.name]),onMousedown:u=>G(u,l)},null,42,be))),128))],34))}}),xe=ce(we,[["__scopeId","data-v-8cb2546c"]]);class Ee{constructor(){ne(this,"_subscribers"),this._subscribers=new Map}onSubscribe(t,a){let o=this._subscribers.get(t)||[];o.push(a),this._subscribers.set(t,o)}onPublish(t,...a){let o=this._subscribers.get(t);o&&o.map(n=>n(...a))}once(t,a){let o=(...n)=>{a(...n),this.unsubscribe(t,o)};this.onPublish(t,o)}unsubscribe(t,a){let o=this._subscribers.get(t)||[];this._subscribers.set(t,o.filter(n=>n!==a))}}export{Ee as d,xe as s};
