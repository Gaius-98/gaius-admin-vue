import{u as R}from"./vue-router-CblwwlxB.js";import{d as f,r as D,a as V,R as _,S as y,U as b,F as B,a1 as I,W as z,a8 as d,_ as N,u as v,$ as S,Y as A,X as O,m as $,c,J as g}from"./@vue-aP0pPEyH.js";import{d as P,s as W}from"./pinia-BukgqtI9.js";import{c as w}from"./lodash-es-PU94eZQX.js";import{W as J}from"./gaius-utils-DPmzP5t9.js";import{v as M}from"./uuid-CQkTLCs1.js";import{J as E,B as F,t as X,T as Y}from"./ant-design-vue-xt7LDby6.js";import"./@babel-BiFW4_mA.js";import"./@ant-design-Bw6LI3J4.js";import"./@ctrl-DOFZgDuz.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./dayjs-X-x4l2Bb.js";import"./throttle-debounce-CUWDS_la.js";import"./async-validator-DKvM95Vc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";const H=f({__name:"NodeRelationship",setup(t){return(i,n)=>"node"}}),L=f({__name:"MaterialArea",setup(t){return(i,n)=>"material"}}),U=f({__name:"CfgArea",setup(t){return(i,n)=>"cfg"}}),j=P("visual",()=>{const t=D({componentData:[],name:"",id:"",img:"",height:1080,width:1920}),i=D({name:"",label:"",id:"",props:{},position:{top:0,left:0},size:{width:0,height:0}}),n=V([]),s=D(0),l=()=>{n[s.value++]=w(t.value.componentData)};return{undo:()=>{s.value>0&&(s.value--,t.value.componentData=w(n[s.value]))},redo:()=>{s.value<n.length-1&&(s.value++,t.value.componentData=w(n[s.value]))},setSnapshot:l,onClickComp:e=>{const a=t.value.componentData.findIndex(o=>o.id===e.id);a!=-1&&(i.value=t.value.componentData[a])},visualData:t,curCompData:i,addComp:e=>{t.value.componentData.push(e),l()},removeComp:e=>{const a=t.value.componentData.findIndex(o=>o.id===e.id);a!=-1&&(t.value.componentData.splice(a,1),l())},updateCompPosition:e=>{const a=t.value.componentData.findIndex(o=>o.id===e.id);a!=-1&&(t.value.componentData[a]={...t.value.componentData[a],position:{...t.value.componentData[a].position,top:e.top,left:e.left},size:{...t.value.componentData[a].size,width:e.width,height:e.height}},l())}}}),q=f({__name:"DesignArea",setup(t){const i=j(),{visualData:n,curCompData:s}=W(i),{onClickComp:l,setSnapshot:C,updateCompPosition:x,addComp:k}=i,u=D(),m=()=>{const{width:o,height:p}=n.value;return u.value?{width:o+"px",height:p+"px",transform:`scale(${(u.value.offsetWidth-40)/o},${(u.value.offsetHeight-40)/p})`,"transform-origin":"0 0 "}:{width:"100%",height:"100%"}},h=o=>{o.preventDefault()},e=o=>{o.preventDefault();let p=JSON.parse(o.dataTransfer.getData("componentData"));p.id=M(),p.position={top:o.offsetY,left:o.offsetX},p.size.width=100,p.size.height=100,k(p)},a=()=>{};return(o,p)=>(_(),y("div",{ref_key:"container",ref:u,class:"view-design-container"},[b("div",{class:"container",style:S(m()),onDragover:h,onDrop:e},[(_(!0),y(B,null,I(v(n).componentData,(r,T)=>(_(),z(v(J),{key:r.id,minh:"20",minw:"20",width:r.size.width,height:r.size.height,top:r.position.top,left:r.position.left,"node-key":r.id,class:N([r.id==v(s).id?"active":"","drag"]),style:S({zIndex:`${T+100}`}),onOnDragResize:a,onClick:K=>v(l)(r)},{default:d(()=>[(_(),z(A(r.name),O({ref_for:!0},r.props),null,16))]),_:2},1032,["width","height","top","left","node-key","class","style","onClick"]))),128))],36)],512))}}),G={class:"design-container"},gt=f({__name:"VisualEditor",setup(t){const i=R(),n=$(()=>"title"),s=$(()=>"desc"),l=()=>{},C=()=>{},x=()=>{i.go(-1)};return(k,u)=>{const m=F,h=X,e=Y,a=E;return _(),y(B,null,[c(a,{title:n.value,subTitle:s.value,onBack:x,ghost:!1,style:{padding:"10px 24px"}},{extra:d(()=>[c(h,null,{default:d(()=>[c(m,{onClick:l,class:"variable-btn"},{default:d(()=>[g(" 变量池配置 ")]),_:1}),c(m,{onClick:C,type:"primary",class:"save-btn"},{default:d(()=>[g(" 保存 ")]),_:1})]),_:1})]),tags:d(()=>[c(e,{color:"#87d068"},{default:d(()=>[g("启用")]),_:1}),c(e,{color:"#f50"},{default:d(()=>[g("停用")]),_:1})]),_:1},8,["title","subTitle"]),b("div",G,[c(H),c(L),c(q),c(U)])],64)}}});export{gt as default};
