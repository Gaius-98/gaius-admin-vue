import{b as y,_ as oe}from"./index-CyIlIWQL.js";import le from"./ImagePicker-CdhipQNY.js";import{g as ne,m as se,r as _,n as B,L as ue,U as de,o as u,q as w,l as t,w as a,e as z,V as re,W as _e,J as r,P as ie,X as C,i,F as U,Y as m,R as pe,$ as me,a0 as ce,a1 as ve,a2 as fe,a3 as ye,a4 as ge,a6 as ke,ac as be,a5 as we,a7 as xe,ad as Ie,T as Ce,a8 as Ue,a9 as Fe}from"./.pnpm-DmAI0IVr.js";import"./resource-cgC51BgF.js";/* empty css                                                                    */const he={class:"user"},De={class:"tools"},Ne=ne({__name:"UserView",setup($e){const p=se({keyword:"",pageNumber:1,pageSize:10}),F=_([]),L=_([{title:"用户名",key:"username",dataIndex:"username"},{title:"头像",key:"avatar",dataIndex:"avatar"},{title:"昵称",key:"name",dataIndex:"name"},{title:"邮箱",key:"email",dataIndex:"email"},{title:"电话",key:"phone",dataIndex:"phone"},{title:"状态",key:"status",dataIndex:"status"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),x=_(!1),h=_(),P=()=>{var l;(l=h.value)==null||l.resetFields(),v()},D=_(0),j=()=>{p.pageNumber=1,p.pageSize=10,v()},E=l=>{const{current:e,pageSize:s}=l;p.pageNumber=e,p.pageSize=s,v()},v=()=>{x.value=!0,y.getList(p).then(l=>{const{code:e,data:s}=l;e==200&&(F.value=s.data,D.value=s.total),x.value=!1})};B(()=>{v()});const g=_(!1),n=_({username:"",name:"",password:"",email:"",avatar:"",roleIds:[],phone:"",status:"1"}),f=_("add"),M=ue(()=>({add:"新增用户",edit:"编辑用户"})[f.value]),N=_(),q=()=>{f.value="add",g.value=!0,n.value={username:"",name:"",password:"",email:"",avatar:"",roleIds:[],phone:"",status:"1"}},A=async l=>{const{code:e,data:s}=await y.getDetail(l.userId);e==200&&(n.value=s,f.value="edit",g.value=!0)},J=async l=>{const{code:e,msg:s,data:d}=await y.remove(l.userId);e==200&&(z.success(d),v())},$=()=>{var l;(l=N.value)==null||l.resetFields()},W=()=>{let l;f.value=="add"?l=y.add:l=y.update,l(n.value).then(e=>{const{code:s}=e;s==200&&(z.success(f.value=="add"?"新增成功":"编辑成功"),v()),$(),g.value=!1})},R=_([]),X=()=>{y.getRoleDict().then(l=>{const{code:e,data:s,msg:d}=l;e==200&&(R.value=s)})};return B(()=>{X()}),(l,e)=>{const s=me,d=ce,T=ve,k=fe,Y=ye,V=ge,O=re,b=ke,G=be,H=we,K=xe,Q=Ie,Z=Ce,S=Ue,ee=Fe,ae=_e,I=de("has-perm");return u(),w("div",he,[t(O,{class:"search-area"},{default:a(()=>[t(V,{ref_key:"searchFormRef",ref:h,model:p,onFinish:j},{default:a(()=>[t(Y,{gutter:24},{default:a(()=>[t(T,{span:4},{default:a(()=>[t(d,{label:"用户名",name:"keyword"},{default:a(()=>[t(s,{value:p.keyword,"onUpdate:value":e[0]||(e[0]=o=>p.keyword=o)},null,8,["value"])]),_:1})]),_:1}),t(T,{span:4,style:{"text-align":"right"}},{default:a(()=>[t(k,{type:"primary","html-type":"submit"},{default:a(()=>[r("搜索")]),_:1}),t(k,{style:{margin:"0 8px"},onClick:P},{default:a(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(O,null,{default:a(()=>[ie("div",De,[C((u(),i(k,{type:"primary",onClick:q},{default:a(()=>[r("新增")]),_:1})),[[I,"system:user:add"]])]),t(K,{loading:x.value,columns:L.value,"data-source":F.value,scroll:{y:440},onChange:E,pagination:{current:p.pageNumber,total:D.value}},{bodyCell:a(({column:o,record:c})=>[o.key=="status"?(u(),w(U,{key:0},[c.status?(u(),i(b,{key:0,color:"#87d068"},{default:a(()=>[r("启用")]),_:1})):(u(),i(b,{key:1,color:"#f50"},{default:a(()=>[r("停用")]),_:1}))],64)):m("",!0),o.key=="avatar"?(u(),i(G,{key:1,src:`${c.avatar}`,height:"30px",width:"30px",preview:!1},null,8,["src"])):m("",!0),o.key=="role"?(u(),i(b,{key:2},{default:a(()=>[r(pe(c.role),1)]),_:2},1024)):m("",!0),o.key=="action"?(u(),w(U,{key:3},[C((u(),i(k,{type:"link",onClick:te=>A(c)},{default:a(()=>[r("编辑")]),_:2},1032,["onClick"])),[[I,"system:user:update"]]),t(H,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:te=>J(c)},{default:a(()=>[C((u(),i(k,{type:"link",danger:""},{default:a(()=>[r("删除")]),_:1})),[[I,"system:user:remove"]])]),_:2},1032,["onConfirm"])],64)):m("",!0),o.key=="userType"?(u(),w(U,{key:4},[c.userType=="app"?(u(),i(b,{key:0,color:"#2db7f5"},{default:a(()=>[r("菜单")]),_:1})):m("",!0),c.userType=="directory"?(u(),i(b,{key:1,color:"#87d068"},{default:a(()=>[r("目录")]),_:1})):m("",!0)],64)):m("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),t(ae,{open:g.value,"onUpdate:open":e[9]||(e[9]=o=>g.value=o),onOk:W,title:M.value,onCancel:$},{default:a(()=>[t(V,{model:n.value,"label-col":{span:8},ref_key:"modalFormRef",ref:N},{default:a(()=>[t(d,{label:"用户名"},{default:a(()=>[t(s,{value:n.value.username,"onUpdate:value":e[1]||(e[1]=o=>n.value.username=o)},null,8,["value"])]),_:1}),f.value=="add"?(u(),i(d,{key:0,label:"密码"},{default:a(()=>[t(Q,{value:n.value.password,"onUpdate:value":e[2]||(e[2]=o=>n.value.password=o)},null,8,["value"])]),_:1})):m("",!0),t(d,{label:"角色"},{default:a(()=>[t(Z,{value:n.value.roleIds,"onUpdate:value":e[3]||(e[3]=o=>n.value.roleIds=o),fieldNames:{label:"roleName",value:"roleId"},mode:"multiple",options:R.value},null,8,["value","options"])]),_:1}),t(d,{label:"头像"},{default:a(()=>[t(le,{value:n.value.avatar,"onUpdate:value":e[4]||(e[4]=o=>n.value.avatar=o)},null,8,["value"])]),_:1}),t(d,{label:"状态"},{default:a(()=>[t(ee,{value:n.value.status,"onUpdate:value":e[5]||(e[5]=o=>n.value.status=o),"button-style":"solid"},{default:a(()=>[t(S,{value:"1"},{default:a(()=>[r("启用 ")]),_:1}),t(S,{value:"0"},{default:a(()=>[r("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),t(d,{label:"名称"},{default:a(()=>[t(s,{value:n.value.name,"onUpdate:value":e[6]||(e[6]=o=>n.value.name=o)},null,8,["value"])]),_:1}),t(d,{label:"邮箱"},{default:a(()=>[t(s,{value:n.value.email,"onUpdate:value":e[7]||(e[7]=o=>n.value.email=o)},null,8,["value"])]),_:1}),t(d,{label:"电话"},{default:a(()=>[t(s,{value:n.value.phone,"onUpdate:value":e[8]||(e[8]=o=>n.value.phone=o)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Be=oe(Ne,[["__scopeId","data-v-517c4065"]]);export{Be as default};
