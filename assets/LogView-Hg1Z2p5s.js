import{r as b,c as I,_ as G}from"./index-bp98ELWv.js";import{g as H,m as J,r as l,n as z,a8 as Q,o as B,q as D,l as e,w as n,ab as W,ao as Z,a6 as m,O as g,ad as ee,X as ae,V as te,aI as oe,ai as ne,R as le,aj as se,al as ue,aq as de,aA as ie,aB as re,N as ce}from"./.pnpm-CWzuy1aI.js";const me={getList:d=>b({method:"get",url:"business/log/list",params:d}),getDetail:d=>b({method:"get",url:"business/log/detail",params:{id:d}}),remove:d=>b({method:"get",url:"business/log/remove",params:{id:d}})},pe=d=>(ie("data-v-7df9faf7"),d=d(),re(),d),_e={class:"log"},ge={key:0},fe=pe(()=>ce("template",null,null,-1)),ve=H({__name:"LogView",setup(d){const o=J({keyword:"",pageNumber:1,pageSize:10,startTime:"",endTime:""}),i=l(""),F=()=>{i.value?(o.startTime=i.value[0],o.endTime=i.value[1]):(o.startTime="",o.endTime="")},T=l([]),N=l([{title:"采集设备编号",key:"deviceId",dataIndex:"deviceId"},{title:"操作人",key:"createBy",dataIndex:"createBy"},{title:"操作时间",key:"createTime",dataIndex:"createTime"}]),L=l([{title:"变更项",key:"fieldDesc",dataIndex:"fieldDesc"},{title:"变更前的值",key:"oldValue",dataIndex:"oldValue"},{title:"变更后的值",key:"newValue",dataIndex:"newValue"}]),f=l(!1),h=l(),R=()=>{var t;(t=h.value)==null||t.resetFields(),o.startTime="",o.endTime="",i.value="",p()},k=l(0),M=()=>{o.pageNumber=1,o.pageSize=10,p()},O=t=>{const{current:a,pageSize:u}=t;o.pageNumber=a,o.pageSize=u,p()},p=()=>{f.value=!0,me.getList(o).then(t=>{const{code:a,data:u}=t;a==200&&(T.value=u.data,k.value=u.total),f.value=!1})},w=l([]),U=l({}),Y=l([]),j=l([]);z(()=>{p(),I.getOrgTree().then(t=>{const{code:a,data:u,msg:r}=t;a==200&&(Y.value=u)}),I.getAllUser().then(t=>{const{code:a,data:u,msg:r}=t;a==200&&(j.value=u)}),I.getDict(["logBelongType"]).then(t=>{const{code:a,data:u,msg:r}=t;a==200&&(w.value=u.logBelongType,U.value=w.value.reduce((_,c)=>(_[c.value]=c.label,_),{}))})});const x=l(!1),q=l("add"),P=Q(()=>({add:"新增记录",edit:"编辑记录"})[q.value]),A=l(),E=()=>{var t;(t=A.value)==null||t.resetFields()};return z(()=>{}),(t,a)=>{const u=ae,r=te,_=oe,c=ne,K=le,v=W,y=se,C=ue,S=de,X=Z;return B(),D("div",_e,[e(v,{class:"search-area"},{default:n(()=>[e(K,{ref_key:"searchFormRef",ref:h,model:o,layout:"inline",onFinish:M},{default:n(()=>[e(r,{label:"采集记录设备编号"},{default:n(()=>[e(u,{value:o.keyword,"onUpdate:value":a[0]||(a[0]=s=>o.keyword=s)},null,8,["value"])]),_:1}),e(r,{label:"操作时间"},{default:n(()=>[e(_,{value:i.value,"onUpdate:value":a[1]||(a[1]=s=>i.value=s),valueFormat:"YYYY-MM-DD",onChange:a[2]||(a[2]=s=>F())},null,8,["value"])]),_:1}),e(r,null,{default:n(()=>[e(c,{type:"primary","html-type":"submit"},{default:n(()=>[m("搜索")]),_:1}),e(c,{style:{margin:"0 8px"},onClick:R},{default:n(()=>[m(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(v,null,{default:n(()=>[e(S,{loading:f.value,columns:N.value,"data-source":T.value,scroll:{y:560},rowKey:"id",onChange:O,pagination:{current:o.pageNumber,total:k.value,showSizeChanger:!0,pageSize:o.pageSize}},{bodyCell:n(({column:s,record:V})=>[s.key=="deviceId"?(B(),D("div",ge,g(V.reportInfo.deviceId),1)):ee("",!0)]),expandedRowRender:n(({record:s})=>[e(v,null,{default:n(()=>[e(C,{title:"操作人信息",size:"small",column:1},{default:n(()=>[e(y,{label:"操作账号"},{default:n(()=>[m(g(s.userInfo.username),1)]),_:2},1024),e(y,{label:"用户姓名"},{default:n(()=>[m(g(s.userInfo.name),1)]),_:2},1024),e(y,{label:"操作时间"},{default:n(()=>[m(g(s.createTime),1)]),_:2},1024)]),_:2},1024),e(C,{title:"操作数据信息",size:"small",column:1}),e(S,{class:"ant-table-striped",columns:L.value,pagination:!1,"data-source":s.changeInfo,"row-class-name":(V,$)=>$%2===1?"table-striped":null,style:{margin:"5px"}},{default:n(()=>[fe]),_:2},1032,["columns","data-source","row-class-name"])]),_:2},1024)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(X,{open:x.value,"onUpdate:open":a[3]||(a[3]=s=>x.value=s),title:P.value,onCancel:E},null,8,["open","title"])])}}}),Ie=G(ve,[["__scopeId","data-v-7df9faf7"]]);export{Ie as default};
