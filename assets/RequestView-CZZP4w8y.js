import{h as f}from"./http-BzHmnwpD.js";import{E as T}from"./EditTable-SbpQo4Zj.js";import{e as ve,m as fe,r as s,n as ye,L as ke,o as i,q as N,j as e,w as a,c as J,U as ge,V as be,J as u,P as W,F as A,g as m,W as y,R as C,X as xe,Y as Ie,Z as Ce,$ as Ve,a0 as he,a1 as Ne,a3 as we,K as Ue,a2 as Fe,a4 as Pe,a5 as Se,a6 as Te,T as Ae,al as Oe,am as Re,an as qe,ao as Ke,ap as $e}from"./.pnpm-0Jz4sC39.js";import{_ as Be}from"./index-hQiK7_g8.js";const De={class:"request"},Ee={class:"tools"},ze=ve({__name:"RequestView",setup(Le){const p=fe({keyword:"",pageNumber:1,pageSize:10,url:""}),O=s("params"),X=s([{value:"get",label:"GET"},{value:"post",label:"POST"}]),R=s([]),Y=s([{title:"API名称",key:"apiName",dataIndex:"apiName"},{title:"请求地址",key:"url",dataIndex:"url"},{title:"请求方式",key:"method",dataIndex:"method",width:100},{title:"状态",key:"status",dataIndex:"status",width:100},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"备注",key:"desc",dataIndex:"desc"},{title:"操作",key:"action",dataIndex:"action"}]),w=s(!1),q=s([{title:"Key",dataIndex:"key",type:"input"},{title:"Value",dataIndex:"value",type:"input"},{title:"引用变量",dataIndex:"var",type:"input"}]),Z=s([{title:"Key",dataIndex:"key",type:"input"},{title:"Value",dataIndex:"value",type:"input"}]),K=s(),H=()=>{var o;(o=K.value)==null||o.resetFields(),c()},$=s(0),Q=()=>{p.pageNumber=1,p.pageSize=10,c()},ee=o=>{const{current:t,pageSize:d}=o;p.pageNumber=t,p.pageSize=d,c()},c=()=>{w.value=!0,f.getList(p).then(o=>{const{code:t,data:d}=o;t==200&&(R.value=d.data,$.value=d.total),w.value=!1})};ye(()=>{c()});const k=s(!1),n=s({url:"",method:"get",apiName:"",params:[{key:"",value:"",var:""}],body:[{key:"",value:"",var:""}],headers:[{key:"",value:""}],status:1,desc:""}),g=s("add"),ae=ke(()=>({add:"新增API",edit:"编辑API"})[g.value]),B=s(),te=()=>{g.value="add",k.value=!0,n.value={url:"",method:"get",apiName:"",params:[{key:"",value:"",var:""}],body:[{key:"",value:"",var:""}],headers:[{key:"",value:""}],status:1,desc:""}},le=async o=>{const{code:t,data:d}=await f.getDetail(o.id);t==200&&(n.value=d,g.value="edit",k.value=!0)},oe=async o=>{const{code:t,msg:d,data:_}=await f.remove(o.id);t==200&&(J.success(_),c())},D=()=>{var o;(o=B.value)==null||o.resetFields()},ne=()=>{let o;g.value=="add"?o=f.add:o=f.update,o(n.value).then(t=>{const{code:d}=t;d==200&&(J.success(g.value=="add"?"新增成功":"编辑成功"),c()),D(),k.value=!1})},U=s(!1),V=s({apiName:"",url:"",method:"get",status:1}),E=s(),F=s(!1),b=s(!1),ue=o=>{U.value=!0,V.value=o,F.value=!0,f.run(o.id).then(t=>{const{code:d}=t.data;F.value=!1,E.value=t.data,d==200?b.value=!0:b.value=!1})};return(o,t)=>{const d=xe,_=Ie,P=Ce,v=Ve,se=he,z=Ne,L=ge,x=we,h=Ue,de=Fe,pe=Pe,j=Se,ie=Te,_e=Ae,S=Oe,re=Re,G=be,me=qe,I=Ke,ce=$e;return i(),N("div",De,[e(L,{class:"search-area"},{default:a(()=>[e(z,{ref_key:"searchFormRef",ref:K,model:p,onFinish:Q},{default:a(()=>[e(se,{gutter:24},{default:a(()=>[e(P,{span:4},{default:a(()=>[e(_,{label:"API名称",name:"keyword"},{default:a(()=>[e(d,{value:p.keyword,"onUpdate:value":t[0]||(t[0]=l=>p.keyword=l)},null,8,["value"])]),_:1})]),_:1}),e(P,{span:4},{default:a(()=>[e(_,{label:"地址",name:"url"},{default:a(()=>[e(d,{value:p.url,"onUpdate:value":t[1]||(t[1]=l=>p.url=l)},null,8,["value"])]),_:1})]),_:1}),e(P,{span:4,style:{"text-align":"right"}},{default:a(()=>[e(v,{type:"primary","html-type":"submit"},{default:a(()=>[u("搜索")]),_:1}),e(v,{style:{margin:"0 8px"},onClick:H},{default:a(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(L,null,{default:a(()=>[W("div",Ee,[e(v,{type:"primary",onClick:te},{default:a(()=>[u("新增")]),_:1})]),e(pe,{loading:w.value,columns:Y.value,"data-source":R.value,scroll:{y:440},onChange:ee,pagination:{current:p.pageNumber,total:$.value}},{bodyCell:a(({column:l,record:r})=>[l.key=="status"?(i(),N(A,{key:0},[r.status?(i(),m(x,{key:0,color:"#87d068"},{default:a(()=>[u("启用")]),_:1})):(i(),m(x,{key:1,color:"#f50"},{default:a(()=>[u("停用")]),_:1}))],64)):y("",!0),l.key=="action"?(i(),N(A,{key:1},[r.status?(i(),m(v,{key:0,type:"link",onClick:M=>ue(r)},{default:a(()=>[u("执行")]),_:2},1032,["onClick"])):y("",!0),e(h,{type:"vertical"}),e(v,{type:"link",onClick:M=>le(r)},{default:a(()=>[u("编辑")]),_:2},1032,["onClick"]),e(h,{type:"vertical"}),e(de,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:M=>oe(r)},{default:a(()=>[e(v,{type:"link",danger:""},{default:a(()=>[u("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):y("",!0),l.key=="method"?(i(),N(A,{key:2},[r.method=="get"?(i(),m(x,{key:0,color:"#2db7f5"},{default:a(()=>[u("GET")]),_:1})):y("",!0),r.method=="post"?(i(),m(x,{key:1,color:"#87d068"},{default:a(()=>[u("POST")]),_:1})):y("",!0)],64)):y("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(G,{open:k.value,"onUpdate:open":t[11]||(t[11]=l=>k.value=l),onOk:ne,title:ae.value,onCancel:D},{default:a(()=>[e(h,null,{default:a(()=>[u("API信息")]),_:1}),e(z,{model:n.value,"label-col":{span:4},ref_key:"modalFormRef",ref:B},{default:a(()=>[e(_,{label:"API名"},{default:a(()=>[e(d,{value:n.value.apiName,"onUpdate:value":t[2]||(t[2]=l=>n.value.apiName=l)},null,8,["value"])]),_:1}),e(_,{label:"状态"},{default:a(()=>[e(ie,{value:n.value.status,"onUpdate:value":t[3]||(t[3]=l=>n.value.status=l),"button-style":"solid"},{default:a(()=>[e(j,{value:1},{default:a(()=>[u("启用 ")]),_:1}),e(j,{value:0},{default:a(()=>[u("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),e(_,{label:"备注"},{default:a(()=>[e(d,{value:n.value.desc,"onUpdate:value":t[4]||(t[4]=l=>n.value.desc=l)},null,8,["value"])]),_:1}),e(h,null,{default:a(()=>[u("接口定义")]),_:1}),e(d,{value:n.value.url,"onUpdate:value":t[6]||(t[6]=l=>n.value.url=l)},{addonBefore:a(()=>[e(_e,{value:n.value.method,"onUpdate:value":t[5]||(t[5]=l=>n.value.method=l),options:X.value},null,8,["value","options"])]),_:1},8,["value"]),W("div",null,[e(re,{activeKey:O.value,"onUpdate:activeKey":t[10]||(t[10]=l=>O.value=l)},{default:a(()=>[e(S,{key:"params",tab:"params"},{default:a(()=>[e(T,{columns:q.value,modelValue:n.value.params,"onUpdate:modelValue":t[7]||(t[7]=l=>n.value.params=l)},null,8,["columns","modelValue"])]),_:1}),e(S,{key:"headers",tab:"headers"},{default:a(()=>[e(T,{columns:Z.value,modelValue:n.value.headers,"onUpdate:modelValue":t[8]||(t[8]=l=>n.value.headers=l)},null,8,["columns","modelValue"])]),_:1}),e(S,{key:"body",tab:"body"},{default:a(()=>[e(T,{columns:q.value,modelValue:n.value.body,"onUpdate:modelValue":t[9]||(t[9]=l=>n.value.body=l)},null,8,["columns","modelValue"])]),_:1})]),_:1},8,["activeKey"])])]),_:1},8,["model"])]),_:1},8,["open","title"]),e(G,{open:U.value,"onUpdate:open":t[12]||(t[12]=l=>U.value=l),title:"执行结果",footer:null},{default:a(()=>[F.value?(i(),m(me,{key:0})):(i(),m(ce,{key:1,layout:"horizontal"},{default:a(()=>[e(I,{label:"API名称",span:3},{default:a(()=>[u(C(V.value.apiName),1)]),_:1}),e(I,{label:"请求地址",span:3},{default:a(()=>[u(C(V.value.url),1)]),_:1}),e(I,{label:"请求方式",span:3},{default:a(()=>[u(C(V.value.method),1)]),_:1}),e(I,{label:"调用结果",span:3,contentStyle:{color:b.value?"#52c41a":"#f5222d"}},{default:a(()=>[e(x,{color:b.value?"success":"error"},{default:a(()=>[u(C(b.value?"成功":"失败"),1)]),_:1},8,["color"])]),_:1},8,["contentStyle"]),e(I,{label:"返回信息",contentStyle:{"max-height":"300px","overflow-y":"auto"},span:4},{default:a(()=>[u(C(E.value),1)]),_:1})]),_:1}))]),_:1},8,["open"])])}}}),We=Be(ze,[["__scopeId","data-v-7eb99f40"]]);export{We as default};
