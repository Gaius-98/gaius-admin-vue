import{d as Y,B as de,r as u,b as j,D as p,E as k,g as e,K as I,C as ie,J as o,Q as g,V as z,Y as W,N as q,X as re,Z as ce,U as A,$ as pe,a0 as me,F as Z,S as _e,p as ve,a1 as S,I as E,R as fe,W as R}from"./index-Vac1NcXf.js";import{a as X,_ as ge}from"./resource-9xkawR8F.js";import{P as ye}from"./PlusOutlined-Bp6PumwL.js";import{L as ke}from"./FolderOutlined-DZPTx9hY.js";import{R as be,S as Ce}from"./index-ZGlXNdes.js";import{I as Ie}from"./index-C2kI7NQ9.js";import{B as G,I as he,_ as xe,F as we,a as $e}from"./index-C-QMBczu.js";import{M as H}from"./index-DrhgDIEF.js";import{C as Ne,_ as Se,a as Ue}from"./index-BPVDB9kJ.js";import{T as Fe}from"./index-BJ9iYP9Z.js";import{_ as Ve}from"./index-D9q3ibEu.js";import{_ as Oe,a as Re}from"./index-N9B2KCTz.js";import"./FileTwoTone-C6RPgOVf.js";import"./DownloadOutlined-BshRWSgF.js";import"./index-CVizMkN9.js";const ze=h=>(pe("data-v-25e15d5d"),h=h(),me(),h),De={class:"image-picker"},Le=ze(()=>z("div",{class:"select-image-text"},"选择图片",-1)),Te={key:1,class:"preview-image"},Pe={class:"image-container"},Be={class:"image-list"},Me=["src","onClick"],Ee=Y({__name:"ImagePicker",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(h){const d=de(h,"modelValue"),x=u([]),w=u([]),i=u({pageSize:3,pageNumber:1,keyword:""}),U=u(0),$="/prod",b=u(""),T=f=>{b.value=f},P=()=>{i.value.pageNumber++,v()},v=()=>{X.getList(i.value).then(f=>{const{code:c,data:m,msg:y}=f;c==200&&(x.value=x.value.concat(m.data),w.value=m.data,U.value=m.total)})},C=()=>{i.value.pageNumber--,w.value=x.value.slice((i.value.pageNumber-1)*i.value.pageSize,i.value.pageSize)},n=f=>{const c=new FormData;c.append("file",f.file,encodeURIComponent(f.file.name)),X.add(c).then(m=>{const{code:y,data:N,msg:F}=m;y==200&&(d.value=`${$}/${N.path}`,A.success(F),r.value=!1)})},r=u(!1),B=()=>{r.value=!0},D=()=>{d.value=b.value,L()},L=()=>{b.value="",r.value=!1};return j(()=>{v()}),(f,c)=>{const m=Ie,y=G,N=ge,F=H;return p(),k("div",De,[d.value?(p(),k("div",Te,[e(I(ie),{onClick:c[0]||(c[0]=a=>d.value=""),style:{position:"absolute",top:"5px",right:"5px",color:"#999","z-index":"99"}}),e(m,{src:d.value,width:"100px",height:"100px"},null,8,["src"])])):(p(),k("div",{key:0,class:"select-image",onClick:B},[e(I(ye)),Le])),e(F,{open:r.value,"onUpdate:open":c[1]||(c[1]=a=>r.value=a),title:"选择图片",onOk:D,onCancel:L},{default:o(()=>[e(N,{name:"file",accept:"image/*",customRequest:n,maxCount:"1",showUploadList:!1},{default:o(()=>[e(y,{type:"primary"},{default:o(()=>[g("自定义")]),_:1})]),_:1}),z("div",Pe,[e(y,{type:"ghost",icon:W(I(ke)),onClick:C,disabled:i.value.pageNumber==1},null,8,["icon","disabled"]),z("div",Be,[(p(!0),k(q,null,re(w.value,a=>(p(),k("div",{key:a.id,class:ce(["image-item",{selected:b.value==`${I($)}/${a.path}`}])},[z("img",{src:`${I($)}/${a.path}`,onClick:t=>T(`${I($)}/${a.path}`),height:"100px",width:"100px"},null,8,Me)],2))),128))]),e(y,{type:"ghost",icon:W(I(be)),onClick:P,disabled:i.value.pageSize*(i.value.pageNumber-1)+w.value.length==U.value},null,8,["icon","disabled"])])]),_:1},8,["open"])])}}}),je=Z(Ee,[["__scopeId","data-v-25e15d5d"]]),qe={class:"user"},Ae={class:"tools"},Je=Y({__name:"UserView",setup(h){const d=_e({keyword:"",pageNumber:1,pageSize:10}),x=u([]),w=u([{title:"用户名",key:"username",dataIndex:"username"},{title:"名称",key:"name",dataIndex:"name"},{title:"邮箱",key:"email",dataIndex:"email"},{title:"角色",key:"roleId",dataIndex:"roleId"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),i=u(!1),U=u(),$=()=>{var a;(a=U.value)==null||a.resetFields(),v()},b=u(0),T=()=>{d.pageNumber=1,d.pageSize=10,v()},P=a=>{const{current:t,pageSize:s}=a;d.pageNumber=t,d.pageSize=s,v()},v=()=>{i.value=!0,S.getList(d).then(a=>{const{code:t,data:s}=a;t==200&&(x.value=s.data,b.value=s.total),i.value=!1})};j(()=>{v()});const C=u(!1),n=u({username:"",name:"",password:"",email:"",avatar:"",roleId:""}),r=u("add"),B=ve(()=>({add:"新增用户",edit:"编辑用户"})[r.value]),D=u(),L=()=>{r.value="add",C.value=!0,n.value={username:"",name:"",password:"",email:"",avatar:"",roleId:""}},f=async a=>{const{code:t,data:s}=await S.getDetail(a.username);t==200&&(n.value=s,r.value="edit",C.value=!0)},c=async a=>{const{code:t,msg:s,data:_}=await S.remove(a.username);t==200&&(A.success(_),v())},m=()=>{var a;(a=D.value)==null||a.resetFields()},y=()=>{let a;r.value=="add"?a=S.add:a=S.update,a(n.value).then(t=>{const{code:s}=t;s==200&&(A.success(r.value=="add"?"新增成功":"编辑成功"),v()),m(),C.value=!1})},N=u([]),F=()=>{S.getRoleDict().then(a=>{const{code:t,data:s,msg:_}=a;t==200&&(N.value=s)})};return j(()=>{F()}),(a,t)=>{const s=he,_=xe,J=Se,V=G,ee=Ue,K=we,Q=Ne,M=Fe,ae=Ve,te=Oe,oe=Re,le=$e,ne=Ce,se=H;return p(),k("div",qe,[e(Q,{class:"search-area"},{default:o(()=>[e(K,{ref_key:"searchFormRef",ref:U,model:d,onFinish:T},{default:o(()=>[e(ee,{gutter:24},{default:o(()=>[e(J,{span:4},{default:o(()=>[e(_,{label:"用户名",name:"keyword"},{default:o(()=>[e(s,{value:d.keyword,"onUpdate:value":t[0]||(t[0]=l=>d.keyword=l)},null,8,["value"])]),_:1})]),_:1}),e(J,{span:4,style:{"text-align":"right"}},{default:o(()=>[e(V,{type:"primary","html-type":"submit"},{default:o(()=>[g("搜索")]),_:1}),e(V,{style:{margin:"0 8px"},onClick:$},{default:o(()=>[g(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Q,null,{default:o(()=>[z("div",Ae,[e(V,{type:"primary",onClick:L},{default:o(()=>[g("新增")]),_:1})]),e(oe,{loading:i.value,columns:w.value,"data-source":x.value,scroll:{y:440},onChange:P,pagination:{current:d.pageNumber,total:b.value}},{bodyCell:o(({column:l,record:O})=>[l.key=="role"?(p(),E(M,{key:0},{default:o(()=>[g(fe(O.role),1)]),_:2},1024)):R("",!0),l.key=="action"?(p(),k(q,{key:1},[e(V,{type:"link",onClick:ue=>f(O)},{default:o(()=>[g("编辑")]),_:2},1032,["onClick"]),e(ae,{type:"vertical"}),e(te,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:ue=>c(O)},{default:o(()=>[e(V,{type:"link",danger:""},{default:o(()=>[g("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):R("",!0),l.key=="userType"?(p(),k(q,{key:2},[O.userType=="app"?(p(),E(M,{key:0,color:"#2db7f5"},{default:o(()=>[g("菜单")]),_:1})):R("",!0),O.userType=="directory"?(p(),E(M,{key:1,color:"#87d068"},{default:o(()=>[g("目录")]),_:1})):R("",!0)],64)):R("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(se,{open:C.value,"onUpdate:open":t[7]||(t[7]=l=>C.value=l),onOk:y,title:B.value,onCancel:m},{default:o(()=>[e(K,{model:n.value,"label-col":{span:8},ref_key:"modalFormRef",ref:D},{default:o(()=>[e(_,{label:"用户名"},{default:o(()=>[e(s,{value:n.value.username,"onUpdate:value":t[1]||(t[1]=l=>n.value.username=l)},null,8,["value"])]),_:1}),e(_,{label:"密码"},{default:o(()=>[e(le,{value:n.value.password,"onUpdate:value":t[2]||(t[2]=l=>n.value.password=l)},null,8,["value"])]),_:1}),e(_,{label:"角色"},{default:o(()=>[e(ne,{value:n.value.roleId,"onUpdate:value":t[3]||(t[3]=l=>n.value.roleId=l),fieldNames:{label:"roleName",value:"roleId"},options:N.value},null,8,["value","options"])]),_:1}),e(_,{label:"头像"},{default:o(()=>[e(je,{modelValue:n.value.avatar,"onUpdate:modelValue":t[4]||(t[4]=l=>n.value.avatar=l)},null,8,["modelValue"])]),_:1}),e(_,{label:"名称"},{default:o(()=>[e(s,{value:n.value.name,"onUpdate:value":t[5]||(t[5]=l=>n.value.name=l)},null,8,["value"])]),_:1}),e(_,{label:"邮箱"},{default:o(()=>[e(s,{value:n.value.email,"onUpdate:value":t[6]||(t[6]=l=>n.value.email=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),ua=Z(Je,[["__scopeId","data-v-96ec8309"]]);export{ua as default};
