import{a as S}from"./notice-BRxblvXA.js";import{c as W,_ as X}from"./index-DiwTyEDS.js";import{g as j,m as A,r as c,n as G,U as H,o as u,q as b,l as t,w as e,V as K,W as Q,J as s,F as Z,i as g,Y as h,R as p,X as ee,$ as te,a0 as ae,a1 as ne,av as oe,a2 as le,a3 as se,a4 as ie,a5 as ce,a7 as ue,as as _e,at as de}from"./.pnpm-DZa05fHr.js";const re={class:"notice"},pe=["title"],me={key:2},fe=j({__name:"NotifyMessage",setup(ve){const o=A({keyword:"",pageNumber:1,pageSize:10,startTime:"",endTime:""}),m=c(""),V=()=>{m.value?(o.startTime=m.value[0],o.endTime=m.value[1]):(o.startTime="",o.endTime="")},I=c([]),Y=c([{title:"标题",key:"title",dataIndex:"title",width:"150px"},{title:"内容",key:"content",dataIndex:"content",width:"500px",ellipsis:!0},{title:"状态",key:"status",dataIndex:"status",width:"100px"},{title:"消息发送时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),w=c(!1),N=c(),$=()=>{var l;(l=N.value)==null||l.resetFields(),f()},D=c(0),z=()=>{o.pageNumber=1,o.pageSize=10,f()},B=l=>{const{current:a,pageSize:i}=l;o.pageNumber=a,o.pageSize=i,f()},f=()=>{w.value=!0,S.getNoticeList(o).then(l=>{const{code:a,data:i}=l;a==200&&(I.value=i.data,D.value=i.total),w.value=!1})},F=c([]),R=c({});G(()=>{f(),W.getDict(["configType"]).then(l=>{const{code:a,data:i,msg:T}=l;a==200&&(F.value=i.configType,R.value=F.value.reduce((r,y)=>(r[y.value]=y.label,r),{}))})});const x=c(!1),d=c({id:0,noticeId:0,recevieId:"",status:"",notice:{title:"",content:""}}),U=async l=>{const{code:a,data:i}=await S.getNoticeDetail(l.id);a==200&&(d.value=i,x.value=!0)};return(l,a)=>{const i=te,T=ae,r=ne,y=oe,C=le,L=se,P=ie,M=K,k=ce,O=ue,v=_e,q=de,E=Q,J=H("has-perm");return u(),b("div",re,[t(M,{class:"search-area"},{default:e(()=>[t(P,{ref_key:"searchFormRef",ref:N,model:o,onFinish:z},{default:e(()=>[t(L,{gutter:24},{default:e(()=>[t(r,{span:4},{default:e(()=>[t(T,{label:"关键字",name:"keyword"},{default:e(()=>[t(i,{value:o.keyword,"onUpdate:value":a[0]||(a[0]=n=>o.keyword=n)},null,8,["value"])]),_:1})]),_:1}),t(r,{span:8},{default:e(()=>[t(T,{label:"时间范围"},{default:e(()=>[t(y,{value:m.value,"onUpdate:value":a[1]||(a[1]=n=>m.value=n),valueFormat:"YYYY-MM-DD",onChange:a[2]||(a[2]=n=>V())},null,8,["value"])]),_:1})]),_:1}),t(r,{span:4,style:{"text-align":"right"}},{default:e(()=>[t(C,{type:"primary","html-type":"submit"},{default:e(()=>[s("搜索")]),_:1}),t(C,{style:{margin:"0 8px"},onClick:$},{default:e(()=>[s(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(M,null,{default:e(()=>[t(O,{loading:w.value,columns:Y.value,"data-source":I.value,scroll:{y:510},onChange:B,pagination:{current:o.pageNumber,total:D.value}},{bodyCell:e(({column:n,record:_})=>[n.key=="status"?(u(),b(Z,{key:0},[_.status=="1"?(u(),g(k,{key:0,color:"#87d068"},{default:e(()=>[s("已读")]),_:1})):(u(),g(k,{key:1,color:"#f50"},{default:e(()=>[s("未读")]),_:1}))],64)):h("",!0),n.key=="title"?(u(),b("div",{key:1,title:_.notice.title},p(_.notice.title),9,pe)):h("",!0),n.key=="content"?(u(),b("div",me,p(_.notice.content),1)):h("",!0),n.key=="action"?ee((u(),g(C,{key:3,type:"link",onClick:ge=>U(_)},{default:e(()=>[s("查看")]),_:2},1032,["onClick"])),[[J,"private:notice:detail"]]):h("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),t(E,{open:x.value,"onUpdate:open":a[3]||(a[3]=n=>x.value=n),title:"查看通知",footer:null,width:700,onCancel:a[4]||(a[4]=n=>f())},{default:e(()=>[t(q,{column:2},{default:e(()=>[t(v,{label:"标题",style:{"font-weight":"bold"}},{default:e(()=>[s(p(d.value.notice.title),1)]),_:1}),t(v,{label:"状态"},{default:e(()=>[d.value.status=="1"?(u(),g(k,{key:0,color:"#87d068"},{default:e(()=>[s("已读")]),_:1})):(u(),g(k,{key:1,color:"#f50"},{default:e(()=>[s("未读")]),_:1}))]),_:1}),t(v,{label:"发送人"},{default:e(()=>{var n,_;return[s(p((_=(n=d.value)==null?void 0:n.userInfo)==null?void 0:_.username),1)]}),_:1}),t(v,{label:"查看时间"},{default:e(()=>[s(p(d.value.readTime),1)]),_:1}),t(v,{label:"内容",span:2},{default:e(()=>[s(p(d.value.notice.content),1)]),_:1})]),_:1})]),_:1},8,["open"])])}}}),he=X(fe,[["__scopeId","data-v-ea9a3ec7"]]);export{he as default};
