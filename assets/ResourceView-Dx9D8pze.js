import{a as d}from"./resource-B6FbdUhM.js";import{g as L,m as T,r,n as q,o as f,q as j,l as e,w as a,V as E,J as u,P as J,i as x,j as M,Y as w,e as C,Z as Y,$ as Z,a0 as A,a1 as G,a2 as H,a3 as K,ai as O,ah as Q,a4 as W,a6 as X}from"./.pnpm-eZ9qvLl_.js";import{_ as ee}from"./index-DNkYIuua.js";const ae={class:"resource"},te={class:"tools"},oe=L({__name:"ResourceView",setup(ne){const n=T({keyword:"",pageNumber:1,pageSize:10}),g=r([]),b=r([{title:"文件名称",key:"originalname",dataIndex:"originalname"},{title:"文件大小",key:"size",dataIndex:"size"},{title:"文件",key:"path",dataIndex:"path",width:"250px"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),p=r(!1),y=r(),I="/prod",N=()=>{var t;(t=y.value)==null||t.resetFields(),c()},h=r(0),F=()=>{n.pageNumber=1,n.pageSize=10,c()},V=t=>{const{current:o,pageSize:s}=t;n.pageNumber=o,n.pageSize=s,c()},z=t=>{const o=new FormData;o.append("file",t.file,encodeURIComponent(t.file.name)),d.add(o).then(s=>{const{code:_,data:m,msg:l}=s;_==200&&C.success(l),c()})},c=()=>{p.value=!0,d.getList(n).then(t=>{const{code:o,data:s}=t;o==200&&(g.value=s.data,h.value=s.total),p.value=!1})};q(()=>{c()});const R=async t=>{const{code:o,msg:s,data:_}=await d.remove(t.id);o==200&&(C.success(_),c())};return(t,o)=>{const s=Y,_=Z,m=A,l=G,$=H,B=K,k=E,S=O,P=Q,U=W,D=X;return f(),j("div",ae,[e(k,{class:"search-area"},{default:a(()=>[e(B,{ref_key:"searchFormRef",ref:y,model:n,onFinish:F},{default:a(()=>[e($,{gutter:24},{default:a(()=>[e(m,{span:4},{default:a(()=>[e(_,{label:"资源名称",name:"keyword"},{default:a(()=>[e(s,{value:n.keyword,"onUpdate:value":o[0]||(o[0]=i=>n.keyword=i)},null,8,["value"])]),_:1})]),_:1}),e(m,{span:4,style:{"text-align":"right"}},{default:a(()=>[e(l,{type:"primary","html-type":"submit"},{default:a(()=>[u("搜索")]),_:1}),e(l,{style:{margin:"0 8px"},onClick:N},{default:a(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(k,null,{default:a(()=>[J("div",te,[e(S,{name:"file",accept:"image/*",customRequest:z,maxCount:"1",showUploadList:!1},{default:a(()=>[e(l,{type:"primary"},{default:a(()=>[u(" 上传")]),_:1})]),_:1})]),e(D,{loading:p.value,columns:b.value,"data-source":g.value,scroll:{y:440},onChange:V,pagination:{current:n.pageNumber,total:h.value}},{bodyCell:a(({column:i,record:v})=>[i.key=="path"?(f(),x(P,{key:0,src:`${M(I)}/${v.path}`,height:"130px"},null,8,["src"])):w("",!0),i.key=="action"?(f(),x(U,{key:1,title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:se=>R(v)},{default:a(()=>[e(l,{type:"link",danger:""},{default:a(()=>[u("删除")]),_:1})]),_:2},1032,["onConfirm"])):w("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1})])}}}),re=ee(oe,[["__scopeId","data-v-e77f44ab"]]);export{re as default};
