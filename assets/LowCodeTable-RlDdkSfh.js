import{_ as L}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-CCpeV5QJ.js";import{t as P}from"./table-Cr5Oe34j.js";import{h as A}from"./http-DlIDHlKe.js";import{d as E,av as G,r as i,l as H,w as I,F as y,M as N,G as B,H as r,W as x,g as e,U as M,a1 as R,N as S,a0 as V,I as k,V as z,O as F,X as W}from"./index-DBvavrl4.js";import{C as X,_ as q,a as J}from"./index-D3tz_IuI.js";import{U as K}from"./index-Cc25PI9G.js";import{D as Q}from"./index-DgqE6CCS.js";import{B as Y}from"./index-DAGcGbMr.js";import{I as Z}from"./index-BxU6gPb3.js";import{S as tt}from"./SyncOutlined--RepSyxa.js";import{_ as at,a as et}from"./index-BacOjwHg.js";import"./LowCodeForm.vue_vue_type_script_setup_true_lang-BA-GZqds.js";import"./index-BX8_qfW5.js";import"./initDefaultProps-B16bGYVp.js";import"./common-B5-K1HTv.js";import"./index-DkNoPK5x.js";import"./index-Gnlru6qg.js";import"./SwapRightOutlined-DKzuAbtf.js";import"./index-DUQh8Act.js";import"./form-5nZ0ggrj.js";import"./index-WcLF7Acp.js";import"./PlusOutlined-DLOqF6K1.js";import"./index-CJPtdA_V.js";import"./SwapOutlined-BENC58zi.js";import"./FolderOutlined-BWfFzhXv.js";import"./index-GBZWbRmY.js";import"./index-OgT7q4Df.js";import"./useBreakpoint-CMuEWdAM.js";const ot=c=>{const u={};return c.reduce((l,t)=>(l[t.key]=t.defaultValue,l),u),u},nt=async(c,u,l)=>{try{const t=await A.run(c.interfaceUrl,{...u,...l});return new Function("res",c.handlerFunc)(t.data)}catch(t){return t}},O={refreshData:nt,transformParamsData:ot},st={class:"low-code-table"},rt={style:{"font-size":"12px"}},lt={class:"tools"},it=["href"],ct=E({__name:"LowCodeTable",props:{id:{}},setup(c){const u=c,{id:l}=G(u),t=i({}),h=i([]),v=i({}),b=i(!1),U=()=>{v.value={},_()},m=i(!1),w=H(()=>{var o,a,n,d,g,f;return((n=(a=(o=t.value)==null?void 0:o.global)==null?void 0:a.filterCfg)==null?void 0:n.show)&&((f=(g=(d=t.value)==null?void 0:d.global)==null?void 0:g.filterCfg)==null?void 0:f.formId)}),p=i({});I(()=>l.value,()=>{P.getDetail(l.value).then(o=>{const{code:a,data:n,msg:d}=o;a==200&&(t.value=n,p.value=O.transformParamsData(t.value.variablePool),_())})},{immediate:!0}),I(()=>p.value,()=>{_()},{deep:!0});const D=i(0),_=async()=>{b.value=!0;try{const{data:o,total:a}=await O.refreshData(t.value.dataSource,p.value,v.value);h.value=o,a&&(D.value=a)}catch(o){M.error("获取数据失败:"+o)}b.value=!1};return(o,a)=>{const n=Y,d=q,g=J,f=X,$=Z,T=at,j=et;return y(),N("div",st,[w.value?(y(),B(f,{key:0,class:"filter-panel"},{default:r(()=>[e(L,{formData:v.value,id:t.value.global.filterCfg.formId,class:R(["filter-form",m.value?"expand":""])},null,8,["formData","id","class"]),e(g,null,{default:r(()=>[e(d,{span:24,style:{"text-align":"right"}},{default:r(()=>[e(n,{type:"primary","html-type":"submit",onClick:_},{default:r(()=>[S("搜索")]),_:1}),e(n,{style:{margin:"0 8px"},onClick:U},{default:r(()=>[S("重置")]),_:1}),e(n,{type:"link",icon:V(m.value?k(K):k(Q)),onClick:a[0]||(a[0]=s=>m.value=!m.value)},{default:r(()=>[z("span",rt,F(m.value?"收起":"展开"),1)]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})):x("",!0),e(f,{class:"table-container"},{default:r(()=>[z("div",lt,[e(n,{icon:V(k(tt)),type:"link",title:"刷新数据",style:{float:"right"},onClick:_},null,8,["icon"])]),e(T,{columns:t.value.columns,"data-source":h.value,scroll:{y:w.value?470:670},loading:b.value,pagination:!1},{bodyCell:r(({column:s,record:C})=>[s.type=="image"?(y(),B($,{key:0,src:`${C[s.dataIndex]}`,height:"130px",width:"100%"},null,8,["src"])):x("",!0),s.type=="link"?(y(),N("a",{key:1,href:`${C[s.dataIndex]}`,target:"_blank"},F(C[s.dataIndex]),9,it)):x("",!0)]),_:1},8,["columns","data-source","scroll","loading"]),e(j,{style:{display:"flex","justify-content":"flex-end","margin-top":"20px"},current:p.value.pageNumber,"onUpdate:current":a[1]||(a[1]=s=>p.value.pageNumber=s),pageSize:p.value.pageSize||10,total:D.value,"show-less-items":""},null,8,["current","pageSize","total"])]),_:1})])}}}),Lt=W(ct,[["__scopeId","data-v-aa8aa963"]]);export{Lt as default};
