var O=Object.defineProperty;var J=(a,e,o)=>e in a?O(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o;var h=(a,e,o)=>J(a,typeof e!="symbol"?e+"":e,o);import{u as K}from"./vue-router-AHw_0--4.js";import{_ as M}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-B5xG2v4c.js";import{d as P,s as A}from"./pinia-D8eArRbh.js";import{c as V}from"./lodash-es-PU94eZQX.js";import{r as x,a as E,d as I,R as l,S as D,c as u,u as y,F as k,W as z,a2 as S,a3 as m,af as U,ac as R,a7 as F,U as r,X as $,J as b,a6 as B,ad as Q,m as T}from"./@vue-DSvEQE6c.js";import{b as w}from"./index-BEziBUm4.js";import{Q as X}from"./gaius-utils-D5gpExPE.js";import{v as W}from"./uuid-CQkTLCs1.js";import{O as Y,y as j,z as q,J as G,B as H,t as Z,T as tt}from"./ant-design-vue-CPw5FL5U.js";import"./LowCodeForm.vue_vue_type_script_setup_true_lang-CXCD7zFQ.js";import"./common-BEB8D9cm.js";import"./form-CTnwaQTC.js";/* empty css                      */import"./axios-B4uVmeYG.js";import"./js-cookie-Cz0CWeBA.js";import"./@vueuse-DIvJCaS9.js";import"./vue-codemirror-BztKek48.js";import"./codemirror-D0DHGrOV.js";import"./@codemirror-DKOYo8Op.js";import"./@lezer-CciglqRQ.js";import"./crelt-C8TCjufn.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./@ant-design-B99nr-O7.js";import"./@ctrl-DOFZgDuz.js";import"./@babel-BiFW4_mA.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./dayjs-X-x4l2Bb.js";import"./throttle-debounce-CUWDS_la.js";import"./async-validator-DKvM95Vc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";const N=P("visual",()=>{const a=x({componentData:[],name:"",id:"",img:"",height:1080,width:1920}),e=x({name:"",type:"",id:"",props:{},tag:"",position:{top:0,left:0},size:{width:0,height:0},formId:""}),o=E([]),t=x(0),n=()=>{o[t.value++]=V(a.value.componentData)};return{undo:()=>{t.value>0&&(t.value--,a.value.componentData=V(o[t.value]))},redo:()=>{t.value<o.length-1&&(t.value++,a.value.componentData=V(o[t.value]))},setSnapshot:n,onClickComp:c=>{const s=a.value.componentData.findIndex(p=>p.id===c.id);s!=-1&&(e.value=a.value.componentData[s])},visualData:a,curCompData:e,addComp:c=>{a.value.componentData.push(c),n()},removeComp:c=>{const s=a.value.componentData.findIndex(p=>p.id===c.id);s!=-1&&(a.value.componentData.splice(s,1),n())},updateCompPosition:c=>{const s=a.value.componentData.findIndex(p=>p.id===c.id);s!=-1&&(a.value.componentData[s]={...a.value.componentData[s],position:{...a.value.componentData[s].position,top:c.top,left:c.left},size:{...a.value.componentData[s].size,width:c.width,height:c.height}},n())}}}),ot={class:"cfg"},et=I({__name:"CfgArea",setup(a){const e=N(),{visualData:o,curCompData:t}=A(e);return(n,_)=>(l(),D("div",ot,[u(M,{"form-data":y(t),id:y(t).formId},null,8,["form-data","id"])]))}}),at=w(et,[["__scopeId","data-v-e2943ee0"]]),nt=[{name:"图片",type:"img",tag:"img",icon:"icon-image1",props:{src:"https://avatars.githubusercontent.com/u/59641156?v=4",draggable:!1},style:{width:"100%",height:"100%"},formId:"c0c67e96-858b-4303-999c-92d0d39cb792"},{name:"文本",type:"text",tag:"span",icon:"icon-text",props:{value:"text"}}];class st{constructor(e,o){h(this,"name","组件");h(this,"id");h(this,"type");h(this,"tag");h(this,"icon");h(this,"props");h(this,"style");h(this,"formId","");h(this,"position",{top:0,left:0});h(this,"size",{width:0,height:0});this.id=o||W(),this.type=e;const t=nt.find(n=>n.type===e);t?(this.tag=t.tag,this.props=t.props,this.name=t.name,this.style=t.style,this.icon=t.icon,this.formId=t.formId):(this.tag="div",this.icon="icon")}}const it=I({__name:"DesignArea",setup(a){const e=N(),{visualData:o,curCompData:t}=A(e),{onClickComp:n,setSnapshot:_,updateCompPosition:g,addComp:f}=e,d=x(),i=s=>{s.preventDefault()},C=s=>{s.preventDefault();let p=JSON.parse(s.dataTransfer.getData("componentData"));p&&(p=new st(p.name),p.position={top:s.offsetY,left:s.offsetX},p.size={width:100,height:100},f(p))},c=()=>{};return(s,p)=>(l(),D("div",{ref_key:"container",ref:d,class:"container",onDragover:i,onDrop:C},[(l(!0),D(k,null,z(y(o).componentData,(v,L)=>(l(),S(y(X),{key:v.id,minh:20,minw:20,width:v.size.width,height:v.size.height,top:v.position.top,left:v.position.left,"node-key":v.id,active:v.id==y(t).id,class:"drag",style:U({zIndex:`${L+100}`}),onUpdate:c,onClick:It=>y(n)(v)},{default:m(()=>[(l(),S(R(v.tag),F({ref_for:!0},v.props,{style:v.style||{}}),null,16,["style"]))]),_:2},1032,["width","height","top","left","node-key","active","style","onClick"]))),128))],544))}}),ct=w(it,[["__scopeId","data-v-09d0266d"]]),lt=I({__name:"NodeRelationship",setup(a){const e=N(),{visualData:o}=A(e),{onClickComp:t}=e,n=(g,f)=>{t(f.node.dataRef)},_=g=>{};return(g,f)=>{const d=Y;return l(),S(d,{class:"draggable-tree",draggable:"","block-node":"","tree-data":y(o).componentData,showIcon:!1,onSelect:n,onDrop:_},{title:m(({title:i,data:C})=>[r("div",null,[r("i",{class:$(["iconfont",C.icon])},null,2),b(" "+B(C.name)+"("+B(i)+") ",1)])]),_:1},8,["tree-data"])}}}),rt=w(lt,[["__scopeId","data-v-cda592df"]]),pt={class:"component-layout"},dt=["data-component"],ut={class:"component-item-text"},mt=I({__name:"MaterialArea",setup(a){const e=x(),o=[{title:"基础组件",value:"base",list:[{label:"图片",icon:"icon-image1",name:"img"},{label:"文本",icon:"icon-text",name:"text"}]}],t=n=>{n&&n.target&&n.dataTransfer&&n.dataTransfer.setData("componentData",n.target.getAttribute("data-component"))};return(n,_)=>{const g=j,f=q;return l(),S(f,{activeKey:e.value,"onUpdate:activeKey":_[0]||(_[0]=d=>e.value=d),class:"material-area",ghost:!0},{default:m(()=>[(l(),D(k,null,z(o,d=>u(g,{header:d.title,key:d.value},{default:m(()=>[r("div",pt,[(l(!0),D(k,null,z(d.list,i=>(l(),D("div",{class:"component-item",key:i.name,draggable:"true",onDragstart:t,"data-component":JSON.stringify(i)},[r("span",{class:$(["iconfont component-item-icon",i.icon])},null,2),r("span",ut,B(i.label),1)],40,dt))),128))])]),_:2},1032,["header"])),64))]),_:1},8,["activeKey"])}}}),_t=w(mt,[["__scopeId","data-v-581fd258"]]),ft={class:"left-side-bar"},vt={class:"bar-top"},ht=["title","onClick"],gt={class:"header"},Dt={class:"title"},Ct={class:"container"},yt=I({__name:"LeftSideBar",setup(a){const e=[{label:"素材库",value:"componentLib",icon:"appstoreadd",component:_t},{label:"节点关系",value:"nodeRelationship",icon:"link",component:rt}],o=x(),t=x(!1),n=()=>{t.value=!t.value},_=f=>{o.value=f},g=()=>{o.value=void 0};return(f,d)=>(l(),D(k,null,[r("div",ft,[r("ul",vt,[(l(),D(k,null,z(e,i=>r("li",{key:i.value,title:i.label,class:$([`iconfont icon-${i.icon}`,o.value&&o.value.value===i.value?"active":""]),onClick:C=>_(i)},null,10,ht)),64))])]),o.value?(l(),D("div",{class:$(["left-part",t.value?"affix":""]),key:o.value.value},[r("div",gt,[r("div",Dt,B(o.value.label),1),r("div",{class:$(["affix iconfont",t.value?"icon-pushpin-fill":"icon-pushpin"]),onClick:n},null,2),r("div",{class:"close iconfont icon-close",onClick:g})]),r("div",Ct,[(l(),S(R(o.value.component)))])],2)):Q("",!0)],64))}}),xt=w(yt,[["__scopeId","data-v-49c5d324"]]),bt={class:"design-container"},kt=I({__name:"VisualEditor",setup(a){const e=K(),o=T(()=>"title"),t=T(()=>"desc"),n=()=>{},_=()=>{},g=()=>{e.go(-1)};return(f,d)=>{const i=H,C=Z,c=tt,s=G;return l(),D(k,null,[u(s,{title:o.value,subTitle:t.value,onBack:g,ghost:!1,style:{padding:"10px 24px"}},{extra:m(()=>[u(C,null,{default:m(()=>[u(i,null,{default:m(()=>[b("加载外部组件")]),_:1}),u(i,{onClick:n,class:"variable-btn"},{default:m(()=>[b(" 变量池配置 ")]),_:1}),u(i,{onClick:_,type:"primary",class:"save-btn"},{default:m(()=>[b(" 保存 ")]),_:1})]),_:1})]),tags:m(()=>[u(c,{color:"#87d068"},{default:m(()=>[b("启用")]),_:1}),u(c,{color:"#f50"},{default:m(()=>[b("停用")]),_:1})]),_:1},8,["title","subTitle"]),r("div",bt,[u(xt,{class:"left-sider"}),u(ct),u(at)])],64)}}}),ro=w(kt,[["__scopeId","data-v-e015f8e4"]]);export{ro as default};
