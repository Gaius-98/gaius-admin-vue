import{a2 as i,aK as j,d as K,A,B as N,r as O,w as F,av as B,at as S,p as v,D as p,I as f,J as x,W as g,E as $,g as h,K as C,Q as z,Y as J,F as L}from"./index-D85MyExI.js";import{_ as m}from"./lodash-CmFMvF3r.js";import{P as q,M as Q}from"./PlusCircleOutlined-BTw99b_2.js";import{I as W,B as Y}from"./index-_GMueuJ1.js";import{S as G}from"./index-BQlVeXUd.js";import{_ as H}from"./index-bDJ4DXBd.js";const le={getList:t=>i({method:"get",url:"request/list",params:t}),getDetail:t=>i({method:"get",url:"request/detail",params:{id:t}}),remove:t=>i({method:"get",url:"request/remove",params:{id:t}}),add:t=>i({method:"post",url:"request/add",data:t}),update:t=>i({method:"post",url:"request/update",data:t}),run:(t,u)=>j({method:"get",url:"/prod/request/proxy",params:{id:t,paramsData:u}})},U={key:2,style:{display:"flex"}},X=K({__name:"EditTable",props:A({columns:{},action:{type:Boolean,default:!0},height:{default:150}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const u=N(t,"modelValue"),n=O([]);F(()=>u,()=>{n.value=u.value.map(a=>({_id_:B(),...a}))},{deep:!0,immediate:!0});let D=t;const{columns:r,action:R}=S(D),V=v(()=>y("input")),w=v(()=>y("select")),E=v(()=>R.value?[...r.value,{title:"操作",dataIndex:"_action_"}]:r.value),M=a=>{var e;return((e=r.value.find(o=>o.dataIndex==a))==null?void 0:e.options)||[]},y=a=>r.value.filter(e=>e.type==a).map(e=>e.dataIndex),I=(a,e,o)=>{n.value.find(l=>l._id_==a)[e]=o,u.value=n.value.map(l=>{let c=m.cloneDeep(l);return Reflect.deleteProperty(c,"_id_"),c})},b=()=>{let a=B(),e=m.cloneDeep({_id_:a});r.value.map(o=>{Reflect.set(e,o.dataIndex,"")}),n.value.push(e)},P=a=>{let e=n.value.findIndex(o=>o._id_==a);n.value.splice(e,1),console.log(n.value.map(o=>{let l=m.cloneDeep(o);return Reflect.deleteProperty(l,"_id_"),l})),u.value=n.value.map(o=>{let l=m.cloneDeep(o);return Reflect.deleteProperty(l,"_id_"),l})};return(a,e)=>{const o=W,l=G,c=Y,T=H;return p(),f(T,{columns:E.value,"data-source":n.value,pagination:!1,rowKey:s=>s._id_,size:"small",scroll:{y:a.height}},{bodyCell:x(({column:s,index:k,record:_})=>[V.value.includes(s.dataIndex)?(p(),f(o,{key:0,value:n.value[k][s.dataIndex],onChange:d=>I(_._id_,s.dataIndex,d.target.value)},null,8,["value","onChange"])):g("",!0),w.value.includes(s.dataIndex)?(p(),f(l,{key:1,value:n.value[k][s.dataIndex],options:M(s.dataIndex),onChange:d=>{I(_._id_,s.dataIndex,d)}},null,8,["value","options","onChange"])):g("",!0),s.dataIndex=="_action_"?(p(),$("div",U,[h(C(q),{class:"icon",onClick:e[0]||(e[0]=d=>b())}),h(C(Q),{class:"icon",onClick:d=>P(_._id_)},null,8,["onClick"])])):g("",!0)]),emptyText:x(()=>[h(c,{type:"text",onClick:b,icon:J(C(q))},{default:x(()=>[z(" 新增数据")]),_:1},8,["icon"])]),_:1},8,["columns","data-source","rowKey","scroll"])}}}),se=L(X,[["__scopeId","data-v-ea715308"]]);export{se as E,le as h};
