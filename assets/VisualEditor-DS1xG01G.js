var O=Object.defineProperty;var J=(e,o,t)=>o in e?O(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t;var g=(e,o,t)=>J(e,typeof o!="symbol"?o+"":o,t);import{u as K}from"./vue-router-AHw_0--4.js";import{d as b,R as l,S as C,r as y,a as M,F as k,W as z,a2 as I,a3 as u,u as S,af as P,ac as N,a7 as E,U as r,X as $,J as x,a6 as B,c as f,ad as U,m as A}from"./@vue-DSvEQE6c.js";import{b as w}from"./index-RsXN23Tr.js";import{d as F,s as T}from"./pinia-D8eArRbh.js";import{c as V}from"./lodash-es-PU94eZQX.js";import{Q}from"./gaius-utils-D5gpExPE.js";import{v as X}from"./uuid-CQkTLCs1.js";import{O as W,y as Y,z as j,J as q,B as G,t as H,T as Z}from"./ant-design-vue-CPw5FL5U.js";/* empty css                      */import"./axios-B4uVmeYG.js";import"./js-cookie-Cz0CWeBA.js";import"./@vueuse-DIvJCaS9.js";import"./vue-codemirror-BztKek48.js";import"./codemirror-D0DHGrOV.js";import"./@codemirror-DKOYo8Op.js";import"./@lezer-CciglqRQ.js";import"./crelt-C8TCjufn.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./@ant-design-B99nr-O7.js";import"./@ctrl-DOFZgDuz.js";import"./@babel-BiFW4_mA.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./dayjs-X-x4l2Bb.js";import"./throttle-debounce-CUWDS_la.js";import"./async-validator-DKvM95Vc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";const tt={class:"cfg"},et=b({__name:"CfgArea",setup(e){return(o,t)=>(l(),C("div",tt))}}),ot=w(et,[["__scopeId","data-v-2b478d9f"]]),R=F("visual",()=>{const e=y({componentData:[],name:"",id:"",img:"",height:1080,width:1920}),o=y({name:"",type:"",id:"",props:{},tag:"",position:{top:0,left:0},size:{width:0,height:0}}),t=M([]),a=y(0),n=()=>{t[a.value++]=V(e.value.componentData)};return{undo:()=>{a.value>0&&(a.value--,e.value.componentData=V(t[a.value]))},redo:()=>{a.value<t.length-1&&(a.value++,e.value.componentData=V(t[a.value]))},setSnapshot:n,onClickComp:c=>{const s=e.value.componentData.findIndex(p=>p.id===c.id);s!=-1&&(o.value=e.value.componentData[s])},visualData:e,curCompData:o,addComp:c=>{e.value.componentData.push(c),n()},removeComp:c=>{const s=e.value.componentData.findIndex(p=>p.id===c.id);s!=-1&&(e.value.componentData.splice(s,1),n())},updateCompPosition:c=>{const s=e.value.componentData.findIndex(p=>p.id===c.id);s!=-1&&(e.value.componentData[s]={...e.value.componentData[s],position:{...e.value.componentData[s].position,top:c.top,left:c.left},size:{...e.value.componentData[s].size,width:c.width,height:c.height}},n())}}}),at=[{name:"图片",type:"img",tag:"img",icon:"icon-image1",props:{src:"https://avatars.githubusercontent.com/u/59641156?v=4",draggable:!1},style:{width:"100%",height:"100%"}},{name:"文本",type:"text",tag:"span",icon:"icon-text",props:{value:"text"}}];class nt{constructor(o,t){g(this,"name","组件");g(this,"id");g(this,"type");g(this,"tag");g(this,"icon");g(this,"props");g(this,"style");g(this,"position",{top:0,left:0});g(this,"size",{width:0,height:0});this.id=t||X(),this.type=o;const a=at.find(n=>n.type===o);a?(this.tag=a.tag,this.props=a.props,this.name=a.name,this.style=a.style,this.icon=a.icon):(this.tag="div",this.icon="icon")}}const st=b({__name:"DesignArea",setup(e){const o=R(),{visualData:t,curCompData:a}=T(o),{onClickComp:n,setSnapshot:v,updateCompPosition:h,addComp:_}=o,d=y(),i=s=>{s.preventDefault()},D=s=>{s.preventDefault();let p=JSON.parse(s.dataTransfer.getData("componentData"));p&&(p=new nt(p.name),p.position={top:s.offsetY,left:s.offsetX},p.size={width:100,height:100},_(p))},c=()=>{};return(s,p)=>(l(),C("div",{ref_key:"container",ref:d,class:"container",onDragover:i,onDrop:D},[(l(!0),C(k,null,z(S(t).componentData,(m,L)=>(l(),I(S(Q),{key:m.id,minh:20,minw:20,width:m.size.width,height:m.size.height,top:m.position.top,left:m.position.left,"node-key":m.id,active:m.id==S(a).id,class:"drag",style:P({zIndex:`${L+100}`}),onUpdate:c,onClick:bt=>S(n)(m)},{default:u(()=>[(l(),I(N(m.tag),E({ref_for:!0},m.props,{style:m.style||{}}),null,16,["style"]))]),_:2},1032,["width","height","top","left","node-key","active","style","onClick"]))),128))],544))}}),it=w(st,[["__scopeId","data-v-597d15ef"]]),ct=b({__name:"NodeRelationship",setup(e){const o=R(),{visualData:t}=T(o),{onClickComp:a}=o,n=(h,_)=>{a(_.node.dataRef)},v=h=>{};return(h,_)=>{const d=W;return l(),I(d,{class:"draggable-tree",draggable:"","block-node":"","tree-data":S(t).componentData,showIcon:!1,onSelect:n,onDrop:v},{title:u(({title:i,data:D})=>[r("div",null,[r("i",{class:$(["iconfont",D.icon])},null,2),x(" "+B(D.name)+"("+B(i)+") ",1)])]),_:1},8,["tree-data"])}}}),lt=w(ct,[["__scopeId","data-v-cda592df"]]),rt={class:"component-layout"},pt=["data-component"],dt={class:"component-item-text"},ut=b({__name:"MaterialArea",setup(e){const o=y(),t=[{title:"基础组件",value:"base",list:[{label:"图片",icon:"icon-image1",name:"img"},{label:"文本",icon:"icon-text",name:"text"}]}],a=n=>{n&&n.target&&n.dataTransfer&&n.dataTransfer.setData("componentData",n.target.getAttribute("data-component"))};return(n,v)=>{const h=Y,_=j;return l(),I(_,{activeKey:o.value,"onUpdate:activeKey":v[0]||(v[0]=d=>o.value=d),class:"material-area",ghost:!0},{default:u(()=>[(l(),C(k,null,z(t,d=>f(h,{header:d.title,key:d.value},{default:u(()=>[r("div",rt,[(l(!0),C(k,null,z(d.list,i=>(l(),C("div",{class:"component-item",key:i.name,draggable:"true",onDragstart:a,"data-component":JSON.stringify(i)},[r("span",{class:$(["iconfont component-item-icon",i.icon])},null,2),r("span",dt,B(i.label),1)],40,pt))),128))])]),_:2},1032,["header"])),64))]),_:1},8,["activeKey"])}}}),_t=w(ut,[["__scopeId","data-v-581fd258"]]),mt={class:"left-side-bar"},ft={class:"bar-top"},vt=["title","onClick"],ht={class:"header"},gt={class:"title"},Ct={class:"container"},Dt=b({__name:"LeftSideBar",setup(e){const o=[{label:"素材库",value:"componentLib",icon:"appstoreadd",component:_t},{label:"节点关系",value:"nodeRelationship",icon:"link",component:lt}],t=y(),a=y(!1),n=()=>{a.value=!a.value},v=_=>{t.value=_},h=()=>{t.value=void 0};return(_,d)=>(l(),C(k,null,[r("div",mt,[r("ul",ft,[(l(),C(k,null,z(o,i=>r("li",{key:i.value,title:i.label,class:$([`iconfont icon-${i.icon}`,t.value&&t.value.value===i.value?"active":""]),onClick:D=>v(i)},null,10,vt)),64))])]),t.value?(l(),C("div",{class:$(["left-part",a.value?"affix":""]),key:t.value.value},[r("div",ht,[r("div",gt,B(t.value.label),1),r("div",{class:$(["affix iconfont",a.value?"icon-pushpin-fill":"icon-pushpin"]),onClick:n},null,2),r("div",{class:"close iconfont icon-close",onClick:h})]),r("div",Ct,[(l(),I(N(t.value.component)))])],2)):U("",!0)],64))}}),yt=w(Dt,[["__scopeId","data-v-49c5d324"]]),xt={class:"design-container"},kt=b({__name:"VisualEditor",setup(e){const o=K(),t=A(()=>"title"),a=A(()=>"desc"),n=()=>{},v=()=>{},h=()=>{o.go(-1)};return(_,d)=>{const i=G,D=H,c=Z,s=q;return l(),C(k,null,[f(s,{title:t.value,subTitle:a.value,onBack:h,ghost:!1,style:{padding:"10px 24px"}},{extra:u(()=>[f(D,null,{default:u(()=>[f(i,null,{default:u(()=>[x("加载外部组件")]),_:1}),f(i,{onClick:n,class:"variable-btn"},{default:u(()=>[x(" 变量池配置 ")]),_:1}),f(i,{onClick:v,type:"primary",class:"save-btn"},{default:u(()=>[x(" 保存 ")]),_:1})]),_:1})]),tags:u(()=>[f(c,{color:"#87d068"},{default:u(()=>[x("启用")]),_:1}),f(c,{color:"#f50"},{default:u(()=>[x("停用")]),_:1})]),_:1},8,["title","subTitle"]),r("div",xt,[f(yt,{class:"left-sider"}),f(it),f(ot)])],64)}}}),ne=w(kt,[["__scopeId","data-v-e015f8e4"]]);export{ne as default};
