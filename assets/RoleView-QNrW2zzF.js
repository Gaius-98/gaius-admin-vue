import{r as y,_ as oe}from"./index-L8l6AuQJ.js";import{a as le}from"./menu-CzRwOyXc.js";import{e as ne,a7 as se,m as ue,r,n as B,L as de,o as i,q as x,j as e,w as t,c as M,U as re,V as _e,J as u,P as $,F as N,g as C,W as k,X as ce,Y as ie,Z as pe,$ as me,a0 as ve,a1 as fe,a3 as ge,K as ye,a2 as ke,a4 as be,a5 as he,a6 as xe,ak as Ce}from"./.pnpm-0Jz4sC39.js";const b={getList:d=>y({method:"get",url:"role/list",params:d}),getDetail:d=>y({method:"get",url:"role/detail",params:{id:d}}),remove:d=>y({method:"get",url:"role/remove",params:{id:d}}),add:d=>y({method:"post",url:"role/add",data:d}),update:d=>y({method:"post",url:"role/update",data:d})},Ie={class:"role"},Ne={class:"tools"},we={style:{height:"200px","overflow-y":"auto"}},Fe=ne({__name:"RoleView",setup(d){se.SHOW_ALL;const _=ue({keyword:"",pageNumber:1,pageSize:10}),w=r([]),z=r([{title:"角色名",key:"roleName",dataIndex:"roleName"},{title:"角色ID",key:"roleId",dataIndex:"roleId"},{title:"备注",key:"desc",dataIndex:"desc"},{title:"状态",key:"status",dataIndex:"status"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),I=r(!1),F=r(),K=()=>{var o;(o=F.value)==null||o.resetFields(),p()},T=r(0),j=()=>{_.pageNumber=1,_.pageSize=10,p()},A=o=>{const{current:a,pageSize:n}=o;_.pageNumber=a,_.pageSize=n,p()},p=()=>{I.value=!0,b.getList(_).then(o=>{const{code:a,data:n}=o;a==200&&(w.value=n.data,T.value=n.total),I.value=!1})};B(()=>{p()});const m=r(!1),s=r({roleName:"",roleId:"",status:1,desc:"",roleValue:[]}),v=r("add"),P=de(()=>({add:"新增角色",edit:"编辑角色"})[v.value]),V=r(),q=()=>{v.value="add",m.value=!0,s.value={roleName:"",roleId:"",status:1,desc:"",roleValue:[]}},E=async o=>{const{code:a,data:n}=await b.getDetail(o.id);a==200&&(s.value=n,v.value="edit",m.value=!0)},W=async o=>{const{code:a,msg:n,data:c}=await b.remove(o.id);a==200&&(M.success(c),p())},U=()=>{var o;(o=V.value)==null||o.resetFields()},H=()=>{let o;v.value=="add"?o=b.add:o=b.update,o(s.value).then(a=>{const{code:n}=a;n==200&&(M.success(v.value=="add"?"新增成功":"编辑成功"),p()),U(),m.value=!1})},D=r([]),J=()=>{le.getAllMenu().then(o=>{const{code:a,data:n,msg:c}=o;a==200&&(D.value=n)})};return B(()=>{J()}),(o,a)=>{const n=ce,c=ie,O=pe,f=me,X=ve,S=fe,L=re,h=ge,Y=ye,Z=ke,G=be,R=he,Q=xe,ee=Ce,te=_e;return i(),x("div",Ie,[e(L,{class:"search-area"},{default:t(()=>[e(S,{ref_key:"searchFormRef",ref:F,model:_,onFinish:j},{default:t(()=>[e(X,{gutter:24},{default:t(()=>[e(O,{span:4},{default:t(()=>[e(c,{label:"角色名称",name:"keyword"},{default:t(()=>[e(n,{value:_.keyword,"onUpdate:value":a[0]||(a[0]=l=>_.keyword=l)},null,8,["value"])]),_:1})]),_:1}),e(O,{span:4,style:{"text-align":"right"}},{default:t(()=>[e(f,{type:"primary","html-type":"submit"},{default:t(()=>[u("搜索")]),_:1}),e(f,{style:{margin:"0 8px"},onClick:K},{default:t(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(L,null,{default:t(()=>[$("div",Ne,[e(f,{type:"primary",onClick:q},{default:t(()=>[u("新增")]),_:1})]),e(G,{loading:I.value,columns:z.value,"data-source":w.value,scroll:{y:440},onChange:A,pagination:{current:_.pageNumber,total:T.value}},{bodyCell:t(({column:l,record:g})=>[l.key=="status"?(i(),x(N,{key:0},[g.status?(i(),C(h,{key:0,color:"#87d068"},{default:t(()=>[u("启用")]),_:1})):(i(),C(h,{key:1,color:"#f50"},{default:t(()=>[u("停用")]),_:1}))],64)):k("",!0),l.key=="action"?(i(),x(N,{key:1},[e(f,{type:"link",onClick:ae=>E(g)},{default:t(()=>[u("编辑")]),_:2},1032,["onClick"]),e(Y,{type:"vertical"}),e(Z,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:ae=>W(g)},{default:t(()=>[e(f,{type:"link",danger:""},{default:t(()=>[u("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):k("",!0),l.key=="roleType"?(i(),x(N,{key:2},[g.roleType=="app"?(i(),C(h,{key:0,color:"#2db7f5"},{default:t(()=>[u("菜单")]),_:1})):k("",!0),g.roleType=="directory"?(i(),C(h,{key:1,color:"#87d068"},{default:t(()=>[u("目录")]),_:1})):k("",!0)],64)):k("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(te,{open:m.value,"onUpdate:open":a[6]||(a[6]=l=>m.value=l),onOk:H,title:P.value,onCancel:U},{default:t(()=>[e(S,{model:s.value,"label-col":{span:8},ref_key:"modalFormRef",ref:V},{default:t(()=>[e(c,{label:"角色名"},{default:t(()=>[e(n,{value:s.value.roleName,"onUpdate:value":a[1]||(a[1]=l=>s.value.roleName=l)},null,8,["value"])]),_:1}),e(c,{label:"角色ID"},{default:t(()=>[e(n,{value:s.value.roleId,"onUpdate:value":a[2]||(a[2]=l=>s.value.roleId=l)},null,8,["value"])]),_:1}),e(c,{label:"状态"},{default:t(()=>[e(Q,{value:s.value.status,"onUpdate:value":a[3]||(a[3]=l=>s.value.status=l),"button-style":"solid"},{default:t(()=>[e(R,{value:1},{default:t(()=>[u("启用 ")]),_:1}),e(R,{value:0},{default:t(()=>[u("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),e(c,{label:"权限"},{default:t(()=>[$("div",we,[e(ee,{checkedKeys:s.value.roleValue,"onUpdate:checkedKeys":a[4]||(a[4]=l=>s.value.roleValue=l),"tree-data":D.value,checkable:"","field-names":{children:"children",title:"label",key:"id"}},null,8,["checkedKeys","tree-data"])])]),_:1}),e(c,{label:"备注"},{default:t(()=>[e(n,{value:s.value.desc,"onUpdate:value":a[5]||(a[5]=l=>s.value.desc=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),De=oe(Fe,[["__scopeId","data-v-467be61e"]]);export{De as default};
