import{b as v,_ as ae}from"./index-D5ChfI_M.js";import te from"./ImagePicker-DdC9-IJ5.js";import{g as oe,m as le,r,n as O,L as ne,U as se,o as d,q as C,l as a,w as t,e as S,V as ue,W as re,J as p,P as de,X as x,i as m,R as ie,Y as f,F as B,Z as pe,$ as me,a0 as _e,a1 as ce,a2 as ve,a3 as fe,a5 as ye,K as ge,a4 as ke,a6 as be,ab as Ie,T as we}from"./.pnpm-DReGQEe3.js";import"./resource-DgjujX-L.js";/* empty css                                                                    */const Ce={class:"user"},xe={class:"tools"},Fe=oe({__name:"UserView",setup(Ue){const i=le({keyword:"",pageNumber:1,pageSize:10}),F=r([]),z=r([{title:"用户名",key:"username",dataIndex:"username"},{title:"名称",key:"name",dataIndex:"name"},{title:"邮箱",key:"email",dataIndex:"email"},{title:"角色",key:"roleId",dataIndex:"roleId"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),b=r(!1),U=r(),L=()=>{var o;(o=U.value)==null||o.resetFields(),_()},D=r(0),P=()=>{i.pageNumber=1,i.pageSize=10,_()},j=o=>{const{current:e,pageSize:s}=o;i.pageNumber=e,i.pageSize=s,_()},_=()=>{b.value=!0,v.getList(i).then(o=>{const{code:e,data:s}=o;e==200&&(F.value=s.data,D.value=s.total),b.value=!1})};O(()=>{_()});const y=r(!1),n=r({username:"",name:"",password:"",email:"",avatar:"",roleIds:[],phone:""}),c=r("add"),E=ne(()=>({add:"新增用户",edit:"编辑用户"})[c.value]),N=r(),M=()=>{c.value="add",y.value=!0,n.value={username:"",name:"",password:"",email:"",avatar:"",roleIds:[],phone:""}},q=async o=>{const{code:e,data:s}=await v.getDetail(o.userId);e==200&&(n.value=s,c.value="edit",y.value=!0)},A=async o=>{const{code:e,msg:s,data:u}=await v.remove(o.userId);e==200&&(S.success(u),_())},T=()=>{var o;(o=N.value)==null||o.resetFields()},J=()=>{let o;c.value=="add"?o=v.add:o=v.update,o(n.value).then(e=>{const{code:s}=e;s==200&&(S.success(c.value=="add"?"新增成功":"编辑成功"),_()),T(),y.value=!1})},R=r([]),K=()=>{v.getRoleDict().then(o=>{const{code:e,data:s,msg:u}=o;e==200&&(R.value=s)})};return O(()=>{K()}),(o,e)=>{const s=pe,u=me,V=_e,g=ce,W=ve,$=fe,h=ue,I=ye,X=ge,Y=ke,Z=be,G=Ie,H=we,Q=re,w=se("has-perm");return d(),C("div",Ce,[a(h,{class:"search-area"},{default:t(()=>[a($,{ref_key:"searchFormRef",ref:U,model:i,onFinish:P},{default:t(()=>[a(W,{gutter:24},{default:t(()=>[a(V,{span:4},{default:t(()=>[a(u,{label:"用户名",name:"keyword"},{default:t(()=>[a(s,{value:i.keyword,"onUpdate:value":e[0]||(e[0]=l=>i.keyword=l)},null,8,["value"])]),_:1})]),_:1}),a(V,{span:4,style:{"text-align":"right"}},{default:t(()=>[a(g,{type:"primary","html-type":"submit"},{default:t(()=>[p("搜索")]),_:1}),a(g,{style:{margin:"0 8px"},onClick:L},{default:t(()=>[p(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(h,null,{default:t(()=>[de("div",xe,[x((d(),m(g,{type:"primary",onClick:M},{default:t(()=>[p("新增")]),_:1})),[[w,"system:user:add"]])]),a(Z,{loading:b.value,columns:z.value,"data-source":F.value,scroll:{y:440},onChange:j,pagination:{current:i.pageNumber,total:D.value}},{bodyCell:t(({column:l,record:k})=>[l.key=="role"?(d(),m(I,{key:0},{default:t(()=>[p(ie(k.role),1)]),_:2},1024)):f("",!0),l.key=="action"?(d(),C(B,{key:1},[x((d(),m(g,{type:"link",onClick:ee=>q(k)},{default:t(()=>[p("编辑")]),_:2},1032,["onClick"])),[[w,"system:user:update"]]),a(X,{type:"vertical"}),a(Y,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:ee=>A(k)},{default:t(()=>[x((d(),m(g,{type:"link",danger:""},{default:t(()=>[p("删除")]),_:1})),[[w,"system:user:remove"]])]),_:2},1032,["onConfirm"])],64)):f("",!0),l.key=="userType"?(d(),C(B,{key:2},[k.userType=="app"?(d(),m(I,{key:0,color:"#2db7f5"},{default:t(()=>[p("菜单")]),_:1})):f("",!0),k.userType=="directory"?(d(),m(I,{key:1,color:"#87d068"},{default:t(()=>[p("目录")]),_:1})):f("",!0)],64)):f("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),a(Q,{open:y.value,"onUpdate:open":e[8]||(e[8]=l=>y.value=l),onOk:J,title:E.value,onCancel:T},{default:t(()=>[a($,{model:n.value,"label-col":{span:8},ref_key:"modalFormRef",ref:N},{default:t(()=>[a(u,{label:"用户名"},{default:t(()=>[a(s,{value:n.value.username,"onUpdate:value":e[1]||(e[1]=l=>n.value.username=l)},null,8,["value"])]),_:1}),c.value=="add"?(d(),m(u,{key:0,label:"密码"},{default:t(()=>[a(G,{value:n.value.password,"onUpdate:value":e[2]||(e[2]=l=>n.value.password=l)},null,8,["value"])]),_:1})):f("",!0),a(u,{label:"角色"},{default:t(()=>[a(H,{value:n.value.roleIds,"onUpdate:value":e[3]||(e[3]=l=>n.value.roleIds=l),fieldNames:{label:"roleName",value:"roleId"},mode:"multiple",options:R.value},null,8,["value","options"])]),_:1}),a(u,{label:"头像"},{default:t(()=>[a(te,{value:n.value.avatar,"onUpdate:value":e[4]||(e[4]=l=>n.value.avatar=l)},null,8,["value"])]),_:1}),a(u,{label:"名称"},{default:t(()=>[a(s,{value:n.value.name,"onUpdate:value":e[5]||(e[5]=l=>n.value.name=l)},null,8,["value"])]),_:1}),a(u,{label:"邮箱"},{default:t(()=>[a(s,{value:n.value.email,"onUpdate:value":e[6]||(e[6]=l=>n.value.email=l)},null,8,["value"])]),_:1}),a(u,{label:"电话"},{default:t(()=>[a(s,{value:n.value.phone,"onUpdate:value":e[7]||(e[7]=l=>n.value.phone=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),$e=ae(Fe,[["__scopeId","data-v-33142c5a"]]);export{$e as default};
