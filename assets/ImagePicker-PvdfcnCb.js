import{a as w}from"./resource-B55LV9Us.js";import{e as V,H as q,I as F,r as i,n as R,o as p,q as r,j as s,h as l,aa as j,ab as D,w as b,J as E,P as _,ac as N,ad as H,F as J,y as Q,Q as T,ae as A,c as G,af as K,$ as W,ag as X,V as Y,ah as Z,ai as ee}from"./.pnpm-0Jz4sC39.js";import{_ as ae}from"./index-L8l6AuQJ.js";const te=u=>(Z("data-v-f79f7f6a"),u=u(),ee(),u),se={class:"image-picker"},oe=te(()=>_("div",{class:"select-image-text"},"选择图片",-1)),ne={key:1,class:"preview-image"},le={class:"image-container"},ce={class:"image-list"},ie=["src","onClick"],ue=V({__name:"ImagePicker",props:{value:{type:String,required:!0},valueModifiers:{}},emits:q(["change"],["update:value"]),setup(u,{emit:S}){const h=F(u,"value"),f=i([]),m=i([]),a=i({pageSize:3,pageNumber:1,keyword:""}),$=i(0),g="/prod",v=i(""),P=e=>{v.value=e},z=()=>{a.value.pageNumber++,y()},y=()=>{w.getList(a.value).then(e=>{const{code:t,data:o,msg:c}=e;t==200&&(f.value=f.value.concat(o.data),m.value=o.data,$.value=o.total)})},L=()=>{a.value.pageNumber--,m.value=f.value.slice((a.value.pageNumber-1)*a.value.pageSize,a.value.pageSize)},M=e=>{const t=new FormData;t.append("file",e.file,encodeURIComponent(e.file.name)),w.add(t).then(o=>{const{code:c,data:x,msg:C}=o;c==200&&(k(`${g}/${x.path}`),G.success(C),d.value=!1)})},d=i(!1),O=()=>{d.value=!0},B=S,k=e=>{h.value=e,B("change",e)},U=()=>{k(v.value),I()},I=()=>{v.value="",d.value=!1};return R(()=>{y()}),(e,t)=>{const o=K,c=W,x=X,C=Y;return p(),r("div",se,[h.value?(p(),r("div",ne,[s(l(D),{onClick:t[0]||(t[0]=n=>k("")),style:{position:"absolute",top:"5px",right:"5px",color:"#999","z-index":"99"}}),s(o,{src:h.value,width:"100px",height:"100px"},null,8,["src"])])):(p(),r("div",{key:0,class:"select-image",onClick:O},[s(l(j)),oe])),s(C,{open:d.value,"onUpdate:open":t[1]||(t[1]=n=>d.value=n),title:"选择图片",onOk:U,onCancel:I},{default:b(()=>[s(x,{name:"file",accept:"image/*",customRequest:M,maxCount:"1",showUploadList:!1},{default:b(()=>[s(c,{type:"primary"},{default:b(()=>[E("自定义")]),_:1})]),_:1}),_("div",le,[s(c,{type:"ghost",icon:N(l(H)),onClick:L,disabled:a.value.pageNumber==1},null,8,["icon","disabled"]),_("div",ce,[(p(!0),r(J,null,Q(m.value,n=>(p(),r("div",{key:n.id,class:T(["image-item",{selected:v.value==`${l(g)}/${n.path}`}])},[_("img",{src:`${l(g)}/${n.path}`,onClick:de=>P(`${l(g)}/${n.path}`),height:"100px",width:"100px"},null,8,ie)],2))),128))]),s(c,{type:"ghost",icon:N(l(A)),onClick:z,disabled:a.value.pageSize*(a.value.pageNumber-1)+m.value.length==$.value},null,8,["icon","disabled"])])]),_:1},8,["open"])])}}}),ge=ae(ue,[["__scopeId","data-v-f79f7f6a"]]);export{ge as default};
