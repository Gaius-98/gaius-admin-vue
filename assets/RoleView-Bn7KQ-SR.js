import{a5 as y,d as le,S as ne,r as d,b as B,l as se,F as m,M as h,g as e,H as t,U as M,N as r,V as re,R as N,G as C,W as k,I as ue,X as de}from"./index-CdY1EXP5.js";import{a as ie}from"./menu-HFv0mCq9.js";import{C as _e,_ as me,a as pe}from"./index-w_0kEH4L.js";import{M as ce}from"./index-B6j64-oL.js";import{I as fe,_ as ve,B as ge,F as ye}from"./index-BtP1Z3dV.js";import{T as ke}from"./index-BwphdiON.js";import{_ as $}from"./index-DZ22K-9T.js";import{_ as be}from"./index-BZoZ2G77.js";import{_ as Ie}from"./index-Bb6E_klx.js";import{_ as he}from"./index-Cj-paFIg.js";import{_ as Ce}from"./index-D9P-CgTX.js";import{_ as xe}from"./index-DviIdvon.js";import"./index-DWa260Xh.js";import"./PlusOutlined-DcPAlO0g.js";import"./index-JXOmXykK.js";import"./ActionButton-CkdRAMIy.js";import"./useDestroyed-9W-TfxxA.js";import"./index-BTufbVqR.js";import"./FolderOutlined-CiLZEO2w.js";import"./useBreakpoint-DfI7Vr26.js";const b={getList:u=>y({method:"get",url:"role/list",params:u}),getDetail:u=>y({method:"get",url:"role/detail",params:{id:u}}),remove:u=>y({method:"get",url:"role/remove",params:{id:u}}),add:u=>y({method:"post",url:"role/add",data:u}),update:u=>y({method:"post",url:"role/update",data:u})},Ne={class:"role"},we={class:"tools"},Fe=le({__name:"RoleView",setup(u){const z=$.SHOW_ALL,i=ne({keyword:"",pageNumber:1,pageSize:10}),w=d([]),A=d([{title:"角色名",key:"roleName",dataIndex:"roleName"},{title:"角色ID",key:"roleId",dataIndex:"roleId"},{title:"备注",key:"desc",dataIndex:"desc"},{title:"状态",key:"status",dataIndex:"status"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),x=d(!1),F=d(),H=()=>{var o;(o=F.value)==null||o.resetFields(),p()},T=d(0),W=()=>{i.pageNumber=1,i.pageSize=10,p()},j=o=>{const{current:a,pageSize:n}=o;i.pageNumber=a,i.pageSize=n,p()},p=()=>{x.value=!0,b.getList(i).then(o=>{const{code:a,data:n}=o;a==200&&(w.value=n.data,T.value=n.total),x.value=!1})};B(()=>{p()});const c=d(!1),s=d({roleName:"",roleId:"",status:1,desc:"",roleValue:[]}),f=d("add"),E=se(()=>({add:"新增角色",edit:"编辑角色"})[f.value]),V=d(),P=()=>{f.value="add",c.value=!0,s.value={roleName:"",roleId:"",status:1,desc:"",roleValue:[]}},q=async o=>{const{code:a,data:n}=await b.getDetail(o.id);a==200&&(s.value=n,f.value="edit",c.value=!0)},G=async o=>{const{code:a,msg:n,data:_}=await b.remove(o.id);a==200&&(M.success(_),p())},L=()=>{var o;(o=V.value)==null||o.resetFields()},X=()=>{let o;f.value=="add"?o=b.add:o=b.update,o(s.value).then(a=>{const{code:n}=a;n==200&&(M.success(f.value=="add"?"新增成功":"编辑成功"),p()),L(),c.value=!1})},O=d([]),J=()=>{ie.getList("").then(o=>{const{code:a,data:n,msg:_}=o;a==200&&(O.value=n)})};return B(()=>{J()}),(o,a)=>{const n=fe,_=ve,S=me,v=ge,K=pe,U=ye,D=_e,I=ke,Q=be,Y=Ie,Z=he,R=Ce,ee=xe,te=$,ae=ce;return m(),h("div",Ne,[e(D,{class:"search-area"},{default:t(()=>[e(U,{ref_key:"searchFormRef",ref:F,model:i,onFinish:W},{default:t(()=>[e(K,{gutter:24},{default:t(()=>[e(S,{span:4},{default:t(()=>[e(_,{label:"角色名称",name:"keyword"},{default:t(()=>[e(n,{value:i.keyword,"onUpdate:value":a[0]||(a[0]=l=>i.keyword=l)},null,8,["value"])]),_:1})]),_:1}),e(S,{span:4,style:{"text-align":"right"}},{default:t(()=>[e(v,{type:"primary","html-type":"submit"},{default:t(()=>[r("搜索")]),_:1}),e(v,{style:{margin:"0 8px"},onClick:H},{default:t(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(D,null,{default:t(()=>[re("div",we,[e(v,{type:"primary",onClick:P},{default:t(()=>[r("新增")]),_:1})]),e(Z,{loading:x.value,columns:A.value,"data-source":w.value,scroll:{y:440},onChange:j,pagination:{current:i.pageNumber,total:T.value}},{bodyCell:t(({column:l,record:g})=>[l.key=="status"?(m(),h(N,{key:0},[g.status?(m(),C(I,{key:0,color:"#87d068"},{default:t(()=>[r("启用")]),_:1})):(m(),C(I,{key:1,color:"#f50"},{default:t(()=>[r("停用")]),_:1}))],64)):k("",!0),l.key=="action"?(m(),h(N,{key:1},[e(v,{type:"link",onClick:oe=>q(g)},{default:t(()=>[r("编辑")]),_:2},1032,["onClick"]),e(Q,{type:"vertical"}),e(Y,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:oe=>G(g)},{default:t(()=>[e(v,{type:"link",danger:""},{default:t(()=>[r("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):k("",!0),l.key=="roleType"?(m(),h(N,{key:2},[g.roleType=="app"?(m(),C(I,{key:0,color:"#2db7f5"},{default:t(()=>[r("菜单")]),_:1})):k("",!0),g.roleType=="directory"?(m(),C(I,{key:1,color:"#87d068"},{default:t(()=>[r("目录")]),_:1})):k("",!0)],64)):k("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(ae,{open:c.value,"onUpdate:open":a[6]||(a[6]=l=>c.value=l),onOk:X,title:E.value,onCancel:L},{default:t(()=>[e(U,{model:s.value,"label-col":{span:8},ref_key:"modalFormRef",ref:V},{default:t(()=>[e(_,{label:"角色名"},{default:t(()=>[e(n,{value:s.value.roleName,"onUpdate:value":a[1]||(a[1]=l=>s.value.roleName=l)},null,8,["value"])]),_:1}),e(_,{label:"角色ID"},{default:t(()=>[e(n,{value:s.value.roleId,"onUpdate:value":a[2]||(a[2]=l=>s.value.roleId=l)},null,8,["value"])]),_:1}),e(_,{label:"状态"},{default:t(()=>[e(ee,{value:s.value.status,"onUpdate:value":a[3]||(a[3]=l=>s.value.status=l),"button-style":"solid"},{default:t(()=>[e(R,{value:1},{default:t(()=>[r("启用 ")]),_:1}),e(R,{value:0},{default:t(()=>[r("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),e(_,{label:"权限"},{default:t(()=>[e(te,{value:s.value.roleValue,"onUpdate:value":a[4]||(a[4]=l=>s.value.roleValue=l),style:{width:"100%"},"tree-data":O.value,"tree-checkable":"","allow-clear":"","show-checked-strategy":ue(z),placeholder:"请选择权限","tree-node-filter-prop":"label","field-names":{children:"children",label:"label",value:"id"}},null,8,["value","tree-data","show-checked-strategy"])]),_:1}),e(_,{label:"备注"},{default:t(()=>[e(n,{value:s.value.desc,"onUpdate:value":a[5]||(a[5]=l=>s.value.desc=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Xe=de(Fe,[["__scopeId","data-v-78d46b5b"]]);export{Xe as default};
