import{a5 as g,d as ae,a1 as oe,e as d,B as M,h as le,N as c,O as h,k as e,V as t,a2 as $,a0 as u,a3 as ne,Z as w,U as x,a4 as k,W as se,Q as ue}from"./index-BJNaeSOg.js";import{a as re}from"./menu-Ctd6B9IB.js";import{C as de,M as _e,_ as ce,a as ie}from"./index-DvjRX04k.js";import{I as pe,_ as me,B as fe,F as ve}from"./index-ByldkgZ2.js";import{T as ye,_ as ge,R as ke}from"./index-C56zg6bC.js";import{_ as A}from"./index-BphANYNQ.js";import{_ as be,a as Ie,b as he}from"./index-qeluSGKx.js";import"./PlusOutlined-FMZKPnog.js";import"./FolderOutlined-C1yJFZsL.js";import"./RightOutlined-Dxp7cLrz.js";const b={getList:r=>g({method:"get",url:"role/list",params:r}),getDetail:r=>g({method:"get",url:"role/detail",params:{id:r}}),remove:r=>g({method:"get",url:"role/remove",params:{id:r}}),add:r=>g({method:"post",url:"role/add",data:r}),update:r=>g({method:"post",url:"role/update",data:r})},xe={class:"role"},Ce={class:"tools"},we=ae({__name:"RoleView",setup(r){const S=A.SHOW_ALL,i=oe({keyword:"",pageNumber:1,pageSize:10}),N=d([]),W=d([{title:"角色名",key:"roleName",dataIndex:"roleName"},{title:"角色ID",key:"roleId",dataIndex:"roleId"},{title:"备注",key:"desc",dataIndex:"desc"},{title:"状态",key:"status",dataIndex:"status"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),C=d(!1),F=d(),j=()=>{var o;(o=F.value)==null||o.resetFields(),p()},T=d(0),p=()=>{C.value=!0,b.getList(i).then(o=>{const{code:a,data:s}=o;a==200&&(N.value=s.data,T.value=s.total),C.value=!1})};M(()=>{p()});const m=d(!1),n=d({roleName:"",roleId:"",status:1,desc:"",roleValue:[]}),f=d("add"),E=le(()=>({add:"新增角色",edit:"编辑角色"})[f.value]),V=d(),H=()=>{f.value="add",m.value=!0,n.value={roleName:"",roleId:"",status:1,desc:"",roleValue:[]}},q=async o=>{const{code:a,data:s}=await b.getDetail(o.id);a==200&&(n.value=s,f.value="edit",m.value=!0)},z=async o=>{const{code:a,msg:s,data:_}=await b.remove(o.id);a==200&&($.success(_),p())},O=()=>{var o;(o=V.value)==null||o.resetFields()},G=()=>{let o;f.value=="add"?o=b.add:o=b.update,o(n.value).then(a=>{const{code:s}=a;s==200&&($.success(f.value=="add"?"新增成功":"编辑成功"),p()),O(),m.value=!1})},L=d([]),P=()=>{re.getList("").then(o=>{const{code:a,data:s,msg:_}=o;a==200&&(L.value=s)})};return M(()=>{P()}),(o,a)=>{const s=pe,_=me,R=ce,v=fe,Q=ie,U=ve,B=de,I=ye,Z=be,J=Ie,K=he,D=ge,X=ke,Y=A,ee=_e;return c(),h("div",xe,[e(B,{class:"search-area"},{default:t(()=>[e(U,{ref_key:"searchFormRef",ref:F,model:i,onFinish:p},{default:t(()=>[e(Q,{gutter:24},{default:t(()=>[e(R,{span:4},{default:t(()=>[e(_,{label:"角色名称",name:"keyword"},{default:t(()=>[e(s,{value:i.keyword,"onUpdate:value":a[0]||(a[0]=l=>i.keyword=l)},null,8,["value"])]),_:1})]),_:1}),e(R,{span:4,style:{"text-align":"right"}},{default:t(()=>[e(v,{type:"primary","html-type":"submit"},{default:t(()=>[u("搜索")]),_:1}),e(v,{style:{margin:"0 8px"},onClick:j},{default:t(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(B,null,{default:t(()=>[ne("div",Ce,[e(v,{type:"primary",onClick:H},{default:t(()=>[u("新增")]),_:1})]),e(K,{loading:C.value,columns:W.value,"data-source":N.value,pagination:{current:i.pageNumber,total:T.value}},{bodyCell:t(({column:l,record:y})=>[l.key=="status"?(c(),h(w,{key:0},[y.status?(c(),x(I,{key:0,color:"#87d068"},{default:t(()=>[u("启用")]),_:1})):(c(),x(I,{key:1,color:"#f50"},{default:t(()=>[u("停用")]),_:1}))],64)):k("",!0),l.key=="action"?(c(),h(w,{key:1},[e(v,{type:"link",onClick:te=>q(y)},{default:t(()=>[u("编辑")]),_:2},1032,["onClick"]),e(Z,{type:"vertical"}),e(J,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:te=>z(y)},{default:t(()=>[e(v,{type:"link",danger:""},{default:t(()=>[u("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):k("",!0),l.key=="roleType"?(c(),h(w,{key:2},[y.roleType=="app"?(c(),x(I,{key:0,color:"#2db7f5"},{default:t(()=>[u("菜单")]),_:1})):k("",!0),y.roleType=="directory"?(c(),x(I,{key:1,color:"#87d068"},{default:t(()=>[u("目录")]),_:1})):k("",!0)],64)):k("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(ee,{open:m.value,"onUpdate:open":a[6]||(a[6]=l=>m.value=l),onOk:G,title:E.value,onCancel:O},{default:t(()=>[e(U,{model:n.value,"label-col":{span:8},ref_key:"modalFormRef",ref:V},{default:t(()=>[e(_,{label:"角色名"},{default:t(()=>[e(s,{value:n.value.roleName,"onUpdate:value":a[1]||(a[1]=l=>n.value.roleName=l)},null,8,["value"])]),_:1}),e(_,{label:"角色ID"},{default:t(()=>[e(s,{value:n.value.roleId,"onUpdate:value":a[2]||(a[2]=l=>n.value.roleId=l)},null,8,["value"])]),_:1}),e(_,{label:"状态"},{default:t(()=>[e(X,{value:n.value.status,"onUpdate:value":a[3]||(a[3]=l=>n.value.status=l),"button-style":"solid"},{default:t(()=>[e(D,{value:1},{default:t(()=>[u("启用 ")]),_:1}),e(D,{value:0},{default:t(()=>[u("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),e(_,{label:"权限"},{default:t(()=>[e(Y,{value:n.value.roleValue,"onUpdate:value":a[4]||(a[4]=l=>n.value.roleValue=l),style:{width:"100%"},"tree-data":L.value,"tree-checkable":"","allow-clear":"","show-checked-strategy":se(S),placeholder:"请选择权限","tree-node-filter-prop":"label","field-names":{children:"children",label:"label",value:"id"}},null,8,["value","tree-data","show-checked-strategy"])]),_:1}),e(_,{label:"备注"},{default:t(()=>[e(s,{value:n.value.desc,"onUpdate:value":a[5]||(a[5]=l=>n.value.desc=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Me=ue(we,[["__scopeId","data-v-520e10f9"]]);export{Me as default};
