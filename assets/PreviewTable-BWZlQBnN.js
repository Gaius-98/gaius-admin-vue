import{_ as P}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-DSJphvNf.js";import{t as S}from"./table-2Yq-6hmN.js";import{h as L}from"./http-lIHxdq_J.js";import{d as I,au as B,r as v,p as R,w as U,D as d,I as C,E as x,F as i,U as w,g as a,R as A,M as D,S as E,Z as j,G as F,N as G,V,aD as K,K as M}from"./index-BSdDcxy1.js";import{C as O,_ as Z,a as q}from"./index-8hKc2vZH.js";import{B as z}from"./index-oSfz28Wk.js";import{I as H}from"./index-8WB2pHwJ.js";import{S as J}from"./SyncOutlined-DtXg2mvK.js";import{_ as Q}from"./index-B0ql1PC7.js";import{a as W}from"./LowCodeForm.vue_vue_type_script_setup_true_lang-C6dADsNr.js";import"./form-BtrBBQPD.js";import"./index-CrlCD_R0.js";import"./index-CMg9c0Jg.js";import"./PlusOutlined-QSB-UYI-.js";import"./SwapOutlined-C2I26g_u.js";import"./FolderOutlined-xL4zft_w.js";import"./ArrowRightOutlined-hJYgmJJ9.js";import"./index-tjHfoMNm.js";import"./index-CEZ3c-oU.js";import"./index-C4_jCVHg.js";import"./common-CMFQHmzD.js";import"./index-0Qqqm7Re.js";import"./index-DQQMAY1B.js";import"./SwapRightOutlined-CZJQlYfE.js";import"./index-DeAm9cFV.js";import"./index-fZjIwXzh.js";const N=r=>{const n={};return r.reduce((e,t)=>(e[t.key]=t.defaultValue,e),n),n},X=async(r,n,e)=>{try{const t=await L.run(r.interfaceUrl,{...N(n),...e});return new Function("res",r.handlerFunc)(t.data)}catch(t){return t}},Y={refreshData:X,transformParamsData:N},tt={class:"low-code-table"},at={class:"tools"},et=["href"],ot=I({__name:"LowCodeTable",props:{id:{}},setup(r){const n=r,{id:e}=B(n),t=v({}),m=v([]),p=v({}),f=v(!1),y=()=>{p.value={},g()},k=R(()=>{var o,l,s,u,h,_;return((s=(l=(o=t.value)==null?void 0:o.global)==null?void 0:l.filterCfg)==null?void 0:s.show)&&((_=(h=(u=t.value)==null?void 0:u.global)==null?void 0:h.filterCfg)==null?void 0:_.formId)});U(()=>e.value,()=>{S.getDetail(e.value).then(o=>{const{code:l,data:s,msg:u}=o;l==200&&(t.value=s,g())})},{immediate:!0});const g=async()=>{f.value=!0;try{const o=await Y.refreshData(t.value.dataSource,t.value.variablePool,p.value);m.value=o}catch(o){A.error("获取数据失败:"+o)}f.value=!1};return(o,l)=>{const s=z,u=Z,h=q,_=O,T=H,$=Q;return d(),C("div",tt,[k.value?(d(),x(_,{key:0,class:"filter-panel"},{default:i(()=>[a(P,{formData:p.value,"onUpdate:formData":l[0]||(l[0]=c=>p.value=c),id:t.value.global.filterCfg.formId,style:{"overflow-y":"auto","max-height":"120px","margin-bottom":"10px"}},null,8,["formData","id"]),a(h,null,{default:i(()=>[a(u,{span:24,style:{"text-align":"right"}},{default:i(()=>[a(s,{type:"primary","html-type":"submit",onClick:g},{default:i(()=>[D("搜索")]),_:1}),a(s,{style:{margin:"0 8px"},onClick:y},{default:i(()=>[D("清空")]),_:1})]),_:1})]),_:1})]),_:1})):w("",!0),a(_,{class:"table-container"},{default:i(()=>[E("div",at,[a(s,{icon:j(F(J)),type:"link",title:"刷新数据",style:{float:"right"},onClick:g},null,8,["icon"])]),a($,{columns:t.value.columns,"data-source":m.value,scroll:{y:k.value?300:500},loading:f.value},{bodyCell:i(({column:c,record:b})=>[c.type=="image"?(d(),x(T,{key:0,src:`${b[c.dataIndex]}`,height:"130px",width:"100%"},null,8,["src"])):w("",!0),c.type=="link"?(d(),C("a",{key:1,href:`${b[c.dataIndex]}`,target:"_blank"},G(b[c.dataIndex]),9,et)):w("",!0)]),_:1},8,["columns","data-source","scroll","loading"])]),_:1})])}}}),rt=V(ot,[["__scopeId","data-v-ec1fcc93"]]),nt=I({__name:"PreviewTable",props:{id:{}},setup(r){const n=r,{id:e}=B(n),t=K(),m=()=>{t.go(-1)};return(p,f)=>{const y=W;return d(),C(M,null,[a(y,{title:"预览表格",onBack:m,class:"page-header"}),a(rt,{id:F(e)},null,8,["id"])],64)}}}),$t=V(nt,[["__scopeId","data-v-50c7d057"]]);export{$t as default};
