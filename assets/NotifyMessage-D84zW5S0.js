import{a as S}from"./notice-CaMGwR5H.js";import{c as W,_ as X}from"./index-0f-9Y9PV.js";import{g as j,m as A,r as c,n as G,U as H,o as u,q as h,l as t,w as e,V as K,W as Q,J as l,F as Z,i as v,Y as b,R as p,X as ee,$ as te,a0 as ae,a1 as ne,av as oe,a2 as se,a3 as le,a4 as ie,a5 as ce,a7 as ue,as as _e,at as de}from"./.pnpm-BJAmQtRs.js";const re={class:"notice"},pe={key:1},me={key:2},fe=j({__name:"NotifyMessage",setup(ve){const o=A({keyword:"",pageNumber:1,pageSize:10,startTime:"",endTime:""}),m=c(""),V=()=>{m.value?(o.startTime=m.value[0],o.endTime=m.value[1]):(o.startTime="",o.endTime="")},N=c([]),Y=c([{title:"标题",key:"title",dataIndex:"title",width:"150px"},{title:"内容",key:"content",dataIndex:"content",width:"500px"},{title:"状态",key:"status",dataIndex:"status",width:"100px"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),w=c(!1),D=c(),$=()=>{var s;(s=D.value)==null||s.resetFields(),g()},I=c(0),z=()=>{o.pageNumber=1,o.pageSize=10,g()},B=s=>{const{current:a,pageSize:i}=s;o.pageNumber=a,o.pageSize=i,g()},g=()=>{w.value=!0,S.getNoticeList(o).then(s=>{const{code:a,data:i}=s;a==200&&(N.value=i.data,I.value=i.total),w.value=!1})},F=c([]),R=c({});G(()=>{g(),W.getDict(["configType"]).then(s=>{const{code:a,data:i,msg:T}=s;a==200&&(F.value=i.configType,R.value=F.value.reduce((r,y)=>(r[y.value]=y.label,r),{}))})});const x=c(!1),d=c({id:0,noticeId:0,recevieId:"",status:"",notice:{title:"",content:""}}),U=async s=>{const{code:a,data:i}=await S.getNoticeDetail(s.id);a==200&&(d.value=i,x.value=!0)};return(s,a)=>{const i=te,T=ae,r=ne,y=oe,C=se,L=le,P=ie,M=K,k=ce,O=ue,f=_e,q=de,E=Q,J=H("has-perm");return u(),h("div",re,[t(M,{class:"search-area"},{default:e(()=>[t(P,{ref_key:"searchFormRef",ref:D,model:o,onFinish:z},{default:e(()=>[t(L,{gutter:24},{default:e(()=>[t(r,{span:4},{default:e(()=>[t(T,{label:"关键字",name:"keyword"},{default:e(()=>[t(i,{value:o.keyword,"onUpdate:value":a[0]||(a[0]=n=>o.keyword=n)},null,8,["value"])]),_:1})]),_:1}),t(r,{span:8},{default:e(()=>[t(T,{label:"时间范围"},{default:e(()=>[t(y,{value:m.value,"onUpdate:value":a[1]||(a[1]=n=>m.value=n),valueFormat:"YYYY-MM-DD",onChange:a[2]||(a[2]=n=>V())},null,8,["value"])]),_:1})]),_:1}),t(r,{span:4,style:{"text-align":"right"}},{default:e(()=>[t(C,{type:"primary","html-type":"submit"},{default:e(()=>[l("搜索")]),_:1}),t(C,{style:{margin:"0 8px"},onClick:$},{default:e(()=>[l(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(M,null,{default:e(()=>[t(O,{loading:w.value,columns:Y.value,"data-source":N.value,scroll:{y:510},onChange:B,pagination:{current:o.pageNumber,total:I.value}},{bodyCell:e(({column:n,record:_})=>[n.key=="status"?(u(),h(Z,{key:0},[_.status=="1"?(u(),v(k,{key:0,color:"#87d068"},{default:e(()=>[l("已读")]),_:1})):(u(),v(k,{key:1,color:"#f50"},{default:e(()=>[l("未读")]),_:1}))],64)):b("",!0),n.key=="title"?(u(),h("div",pe,p(_.notice.title),1)):b("",!0),n.key=="content"?(u(),h("div",me,p(_.notice.content),1)):b("",!0),n.key=="action"?ee((u(),v(C,{key:3,type:"link",onClick:ge=>U(_)},{default:e(()=>[l("查看")]),_:2},1032,["onClick"])),[[J,"system:notice:update"]]):b("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),t(E,{open:x.value,"onUpdate:open":a[3]||(a[3]=n=>x.value=n),title:"查看通知",footer:null,width:700},{default:e(()=>[t(q,{column:2},{default:e(()=>[t(f,{label:"标题"},{default:e(()=>[l(p(d.value.notice.title),1)]),_:1}),t(f,{label:"状态"},{default:e(()=>[d.value.status=="1"?(u(),v(k,{key:0,color:"#87d068"},{default:e(()=>[l("已读")]),_:1})):(u(),v(k,{key:1,color:"#f50"},{default:e(()=>[l("未读")]),_:1}))]),_:1}),t(f,{label:"发送人"},{default:e(()=>{var n,_;return[l(p((_=(n=d.value)==null?void 0:n.user)==null?void 0:_.username),1)]}),_:1}),t(f,{label:"查看时间"},{default:e(()=>[l(p(d.value.readTime),1)]),_:1}),t(f,{label:"内容",span:2},{default:e(()=>[l(p(d.value.notice.content),1)]),_:1})]),_:1})]),_:1},8,["open"])])}}}),be=X(fe,[["__scopeId","data-v-182e95c4"]]);export{be as default};
