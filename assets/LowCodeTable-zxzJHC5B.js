import{_ as L}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-3RYYN6Vm.js";import{t as P}from"./table-zxCYBI67.js";import{h as A}from"./http-CaUdUJTf.js";import{d as E,av as G,r as i,l as H,w as I,F as y,M as N,G as B,H as l,W as x,g as e,U as M,a1 as R,N as S,a0 as V,I as k,V as z,O as F,X as W}from"./index-CdY1EXP5.js";import{C as X,_ as q,a as J}from"./index-w_0kEH4L.js";import{U as K}from"./index-oEQFuRaj.js";import{D as Q}from"./index-DviIdvon.js";import{B as Y}from"./index-BtP1Z3dV.js";import{I as Z}from"./index-B87pkiep.js";import{S as aa}from"./SyncOutlined-CKCe1wuB.js";import{_ as ta,a as ea}from"./index-Cj-paFIg.js";import"./LowCodeForm.vue_vue_type_script_setup_true_lang-DyLSdZ1i.js";import"./index-CpfVKF0c.js";import"./common-CFfi0zK7.js";import"./index-CoPhjAKN.js";import"./index-BwphdiON.js";import"./SwapRightOutlined-CtSGxuKl.js";import"./index-BZoZ2G77.js";import"./form-VFgDHCWp.js";import"./index-DWa260Xh.js";import"./PlusOutlined-DcPAlO0g.js";import"./index-JXOmXykK.js";import"./SwapOutlined-B6ex4mCH.js";import"./FolderOutlined-CiLZEO2w.js";import"./index-D9P-CgTX.js";import"./useBreakpoint-DfI7Vr26.js";const oa=c=>{const u={};return c.reduce((r,a)=>(r[a.key]=a.defaultValue,r),u),u},na=async(c,u,r)=>{try{const a=await A.run(c.interfaceUrl,{...u,...r});return new Function("res",c.handlerFunc)(a.data)}catch(a){return a}},O={refreshData:na,transformParamsData:oa},sa={class:"low-code-table"},la={style:{"font-size":"12px"}},ra={class:"tools"},ia=["href"],ca=E({__name:"LowCodeTable",props:{id:{}},setup(c){const u=c,{id:r}=G(u),a=i({}),h=i([]),v=i({}),b=i(!1),U=()=>{v.value={},_()},m=i(!1),w=H(()=>{var o,t,n,d,g,f;return((n=(t=(o=a.value)==null?void 0:o.global)==null?void 0:t.filterCfg)==null?void 0:n.show)&&((f=(g=(d=a.value)==null?void 0:d.global)==null?void 0:g.filterCfg)==null?void 0:f.formId)}),p=i({});I(()=>r.value,()=>{P.getDetail(r.value).then(o=>{const{code:t,data:n,msg:d}=o;t==200&&(a.value=n,p.value=O.transformParamsData(a.value.variablePool),_())})},{immediate:!0}),I(()=>p.value,()=>{_()},{deep:!0});const D=i(0),_=async()=>{b.value=!0;try{const{data:o,total:t}=await O.refreshData(a.value.dataSource,p.value,v.value);h.value=o,t&&(D.value=t)}catch(o){M.error("获取数据失败:"+o)}b.value=!1};return(o,t)=>{const n=Y,d=q,g=J,f=X,$=Z,T=ta,j=ea;return y(),N("div",sa,[w.value?(y(),B(f,{key:0,class:"filter-panel"},{default:l(()=>[e(L,{formData:v.value,id:a.value.global.filterCfg.formId,class:R(["filter-form",m.value?"expand":""])},null,8,["formData","id","class"]),e(g,null,{default:l(()=>[e(d,{span:24,style:{"text-align":"right"}},{default:l(()=>[e(n,{type:"primary","html-type":"submit",onClick:_},{default:l(()=>[S("搜索")]),_:1}),e(n,{style:{margin:"0 8px"},onClick:U},{default:l(()=>[S("重置")]),_:1}),e(n,{type:"link",icon:V(m.value?k(K):k(Q)),onClick:t[0]||(t[0]=s=>m.value=!m.value)},{default:l(()=>[z("span",la,F(m.value?"收起":"展开"),1)]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})):x("",!0),e(f,{class:"table-container"},{default:l(()=>[z("div",ra,[e(n,{icon:V(k(aa)),type:"link",title:"刷新数据",style:{float:"right"},onClick:_},null,8,["icon"])]),e(T,{columns:a.value.columns,"data-source":h.value,scroll:{y:w.value?470:670},loading:b.value,pagination:!1},{bodyCell:l(({column:s,record:C})=>[s.type=="image"?(y(),B($,{key:0,src:`${C[s.dataIndex]}`,height:"130px",width:"100%"},null,8,["src"])):x("",!0),s.type=="link"?(y(),N("a",{key:1,href:`${C[s.dataIndex]}`,target:"_blank"},F(C[s.dataIndex]),9,ia)):x("",!0)]),_:1},8,["columns","data-source","scroll","loading"]),e(j,{style:{display:"flex","justify-content":"flex-end","margin-top":"20px"},current:p.value.pageNumber,"onUpdate:current":t[1]||(t[1]=s=>p.value.pageNumber=s),pageSize:p.value.pageSize||10,total:D.value,"show-less-items":""},null,8,["current","pageSize","total"])]),_:1})])}}}),Ta=W(ca,[["__scopeId","data-v-aa8aa963"]]);export{Ta as default};
