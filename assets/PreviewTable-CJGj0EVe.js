import{_ as $}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-Cth56nBy.js";import{t as P}from"./table-SJEw5qfa.js";import{h as S}from"./http-Cc7rTHVW.js";import{d as D,au as I,r as y,p as L,w as R,D as d,I as w,E as k,F as i,U as b,g as a,R as U,M as x,S as A,Z as E,G as B,N as j,V as F,aD as G,K}from"./index-Dr_xJf3r.js";import{C as M,_ as O,a as Z}from"./index-P7Rk9JyE.js";import{B as q}from"./index-DJUJLJKr.js";import{I as z}from"./index-DiyaNr1_.js";import{S as H}from"./SyncOutlined-BZb_KoAc.js";import{_ as J}from"./index-CXXXuKYx.js";import{a as Q}from"./LowCodeForm.vue_vue_type_script_setup_true_lang-BqLXt6F8.js";import"./form-BoIeWXBR.js";import"./index-Bt-QeFPZ.js";import"./index-CRD48DaG.js";import"./PlusOutlined-CeoWGJA8.js";import"./SwapOutlined-BT5bNgxg.js";import"./FolderOutlined-BQRPZZT_.js";import"./ArrowRightOutlined-BNffmD9x.js";import"./index-dsSe4OY_.js";import"./index-BWFRzzVS.js";import"./index-BJC5ysTb.js";import"./common-DuTWOYsb.js";import"./index-BS3Tfwcs.js";import"./index-BnqKMOzu.js";import"./SwapRightOutlined-C9LWpnKE.js";import"./index-C9PWjmrG.js";import"./index-WQF47P35.js";const V=r=>{const n={};return r.reduce((e,t)=>(e[t.key]=t.defaultValue,e),n),n},W=async(r,n,e)=>{try{const t=await S.run(r.interfaceUrl,{...V(n),...e});return new Function("res",r.handlerFunc)(t.data)}catch(t){return t}},X={refreshData:W,transformParamsData:V},Y={class:"low-code-table"},tt={class:"tools"},at=["href"],et=D({__name:"LowCodeTable",props:{id:{}},setup(r){const n=r,{id:e}=I(n),t=y({}),m=y([]),p=y({}),C=()=>{p.value={},g()},f=L(()=>{var o,l,s,u,h,_;return((s=(l=(o=t.value)==null?void 0:o.global)==null?void 0:l.filterCfg)==null?void 0:s.show)&&((_=(h=(u=t.value)==null?void 0:u.global)==null?void 0:h.filterCfg)==null?void 0:_.formId)});R(()=>e.value,()=>{P.getDetail(e.value).then(o=>{const{code:l,data:s,msg:u}=o;l==200&&(t.value=s,g())})},{immediate:!0});const g=async()=>{try{const o=await X.refreshData(t.value.dataSource,t.value.variablePool,p.value);m.value=o}catch(o){U.error("获取数据失败:"+o)}};return(o,l)=>{const s=q,u=O,h=Z,_=M,N=z,T=J;return d(),w("div",Y,[f.value?(d(),k(_,{key:0,class:"filter-panel"},{default:i(()=>[a($,{formData:p.value,"onUpdate:formData":l[0]||(l[0]=c=>p.value=c),id:t.value.global.filterCfg.formId,style:{"overflow-y":"auto","max-height":"120px","margin-bottom":"10px"}},null,8,["formData","id"]),a(h,null,{default:i(()=>[a(u,{span:24,style:{"text-align":"right"}},{default:i(()=>[a(s,{type:"primary","html-type":"submit",onClick:g},{default:i(()=>[x("搜索")]),_:1}),a(s,{style:{margin:"0 8px"},onClick:C},{default:i(()=>[x("清空")]),_:1})]),_:1})]),_:1})]),_:1})):b("",!0),a(_,{class:"table-container"},{default:i(()=>[A("div",tt,[a(s,{icon:E(B(H)),type:"link",title:"刷新数据",style:{float:"right"},onClick:g},null,8,["icon"])]),a(T,{columns:t.value.columns,"data-source":m.value,scroll:{y:f.value?300:500}},{bodyCell:i(({column:c,record:v})=>[c.type=="image"?(d(),k(N,{key:0,src:`${v[c.dataIndex]}`,height:"130px",width:"100%"},null,8,["src"])):b("",!0),c.type=="link"?(d(),w("a",{key:1,href:`${v[c.dataIndex]}`,target:"_blank"},j(v[c.dataIndex]),9,at)):b("",!0)]),_:1},8,["columns","data-source","scroll"])]),_:1})])}}}),ot=F(et,[["__scopeId","data-v-3159cea8"]]),rt=D({__name:"PreviewTable",props:{id:{}},setup(r){const n=r,{id:e}=I(n),t=G(),m=()=>{t.go(-1)};return(p,C)=>{const f=Q;return d(),w(K,null,[a(f,{title:"预览表格",onBack:m,class:"page-header"}),a(ot,{id:B(e)},null,8,["id"])],64)}}}),Tt=F(rt,[["__scopeId","data-v-50c7d057"]]);export{Tt as default};
