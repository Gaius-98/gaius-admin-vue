var R=Object.defineProperty;var L=(e,o,t)=>o in e?R(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t;var g=(e,o,t)=>L(e,typeof o!="symbol"?o+"":o,t);import{u as J}from"./vue-router-AHw_0--4.js";import{d as b,R as c,S as v,r as D,a as K,F as y,W as $,a2 as z,a3 as m,u as S,af as M,ac as V,a7 as O,c as u,U as _,X as T,a6 as A,ad as P,m as B,J as x}from"./@vue-DSvEQE6c.js";import{b as k}from"./index-JBZPYCR-.js";import{d as E,s as U}from"./pinia-D8eArRbh.js";import{c as I}from"./lodash-es-PU94eZQX.js";import{Q as F}from"./gaius-utils-D5gpExPE.js";import{v as Q}from"./uuid-CQkTLCs1.js";import{y as X,z as W,J as Y,B as j,t as q,T as G}from"./ant-design-vue-B0DkA0I7.js";/* empty css                      */import"./axios-B4uVmeYG.js";import"./js-cookie-Cz0CWeBA.js";import"./@vueuse-DIvJCaS9.js";import"./vue-codemirror-BztKek48.js";import"./codemirror-D0DHGrOV.js";import"./@codemirror-DKOYo8Op.js";import"./@lezer-CciglqRQ.js";import"./crelt-C8TCjufn.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./@ant-design-B99nr-O7.js";import"./@ctrl-DOFZgDuz.js";import"./@babel-BiFW4_mA.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./dayjs-X-x4l2Bb.js";import"./throttle-debounce-CUWDS_la.js";import"./async-validator-DKvM95Vc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";const H={class:"cfg"},Z=b({__name:"CfgArea",setup(e){return(o,t)=>(c(),v("div",H))}}),tt=k(Z,[["__scopeId","data-v-2b478d9f"]]),et=E("visual",()=>{const e=D({componentData:[],name:"",id:"",img:"",height:1080,width:1920}),o=D({name:"",type:"",id:"",props:{},tag:"",position:{top:0,left:0},size:{width:0,height:0}}),t=K([]),a=D(0),s=()=>{t[a.value++]=I(e.value.componentData)};return{undo:()=>{a.value>0&&(a.value--,e.value.componentData=I(t[a.value]))},redo:()=>{a.value<t.length-1&&(a.value++,e.value.componentData=I(t[a.value]))},setSnapshot:s,onClickComp:i=>{const n=e.value.componentData.findIndex(l=>l.id===i.id);n!=-1&&(o.value=e.value.componentData[n])},visualData:e,curCompData:o,addComp:i=>{e.value.componentData.push(i),s()},removeComp:i=>{const n=e.value.componentData.findIndex(l=>l.id===i.id);n!=-1&&(e.value.componentData.splice(n,1),s())},updateCompPosition:i=>{const n=e.value.componentData.findIndex(l=>l.id===i.id);n!=-1&&(e.value.componentData[n]={...e.value.componentData[n],position:{...e.value.componentData[n].position,top:i.top,left:i.left},size:{...e.value.componentData[n].size,width:i.width,height:i.height}},s())}}}),ot=[{name:"图片",type:"img",tag:"img",props:{src:"https://avatars.githubusercontent.com/u/59641156?v=4",draggable:!1},style:{width:"100%",height:"100%"}},{name:"文本",type:"text",tag:"span",props:{value:"text"}}];class at{constructor(o,t){g(this,"name","组件");g(this,"id");g(this,"type");g(this,"tag");g(this,"props");g(this,"style");g(this,"position",{top:0,left:0});g(this,"size",{width:0,height:0});this.id=t||Q(),this.type=o;const a=ot.find(s=>s.type===o);a?(this.tag=a.tag,this.props=a.props,this.name=a.name,this.style=a.style):this.tag="div"}}const nt=b({__name:"DesignArea",setup(e){const o=et(),{visualData:t,curCompData:a}=U(o),{onClickComp:s,setSnapshot:h,updateCompPosition:C,addComp:r}=o,f=D(),p=n=>{n.preventDefault()},w=n=>{n.preventDefault();let l=JSON.parse(n.dataTransfer.getData("componentData"));l&&(l=new at(l.name),l.position={top:n.offsetY,left:n.offsetX},l.size={width:100,height:100},r(l))},i=()=>{};return(n,l)=>(c(),v("div",{ref_key:"container",ref:f,class:"container",onDragover:p,onDrop:w},[(c(!0),v(y,null,$(S(t).componentData,(d,N)=>(c(),z(S(F),{key:d.id,minh:20,minw:20,width:d.size.width,height:d.size.height,top:d.position.top,left:d.position.left,"node-key":d.id,active:d.id==S(a).id,class:"drag",style:M({zIndex:`${N+100}`}),onUpdate:i,onClick:bt=>S(s)(d)},{default:m(()=>[(c(),z(V(d.tag),O({ref_for:!0},d.props,{style:d.style||{}}),null,16,["style"]))]),_:2},1032,["width","height","top","left","node-key","active","style","onClick"]))),128))],544))}}),st=k(nt,[["__scopeId","data-v-597d15ef"]]),it=b({__name:"NodeRelationship",setup(e){return(o,t)=>"node"}}),ct={class:"component-layout"},lt=["data-component"],rt={class:"component-item-text"},pt=b({__name:"MaterialArea",setup(e){const o=D(),t=[{title:"基础组件",value:"base",list:[{label:"图片",icon:"icon-image1",name:"img"},{label:"文本",icon:"icon-text",name:"text"}]}],a=s=>{s&&s.target&&s.dataTransfer&&s.dataTransfer.setData("componentData",s.target.getAttribute("data-component"))};return(s,h)=>{const C=X,r=W;return c(),z(r,{activeKey:o.value,"onUpdate:activeKey":h[0]||(h[0]=f=>o.value=f),class:"material-area",ghost:!0},{default:m(()=>[(c(),v(y,null,$(t,f=>u(C,{header:f.title,key:f.value},{default:m(()=>[_("div",ct,[(c(!0),v(y,null,$(f.list,p=>(c(),v("div",{class:"component-item",key:p.name,draggable:"true",onDragstart:a,"data-component":JSON.stringify(p)},[_("span",{class:T(["iconfont component-item-icon",p.icon])},null,2),_("span",rt,A(p.label),1)],40,lt))),128))])]),_:2},1032,["header"])),64))]),_:1},8,["activeKey"])}}}),dt=k(pt,[["__scopeId","data-v-581fd258"]]),ut={class:"left-side-bar"},mt={class:"bar-top"},_t=["title","onClick"],ft={class:"header"},vt={class:"title"},ht={class:"container"},gt=b({__name:"LeftSideBar",setup(e){const o=[{label:"素材库",value:"componentLib",icon:"appstoreadd",component:dt},{label:"节点关系",value:"nodeRelationship",icon:"link",component:it}],t=D(),a=h=>{t.value=h},s=()=>{t.value=void 0};return(h,C)=>(c(),v(y,null,[_("div",ut,[_("ul",mt,[(c(),v(y,null,$(o,r=>_("li",{key:r.value,title:r.label,class:T([`iconfont icon-${r.icon}`,t.value&&t.value.value===r.value?"active":""]),onClick:f=>a(r)},null,10,_t)),64))])]),t.value?(c(),v("div",{class:"left-part",key:t.value.value},[_("div",ft,[_("div",vt,A(t.value.label),1),_("div",{class:"close iconfont icon-close",onClick:s})]),_("div",ht,[(c(),z(V(t.value.component)))])])):P("",!0)],64))}}),Ct=k(gt,[["__scopeId","data-v-281a6219"]]),Dt={class:"design-container"},yt=b({__name:"VisualEditor",setup(e){const o=J(),t=B(()=>"title"),a=B(()=>"desc"),s=()=>{},h=()=>{},C=()=>{o.go(-1)};return(r,f)=>{const p=j,w=q,i=G,n=Y;return c(),v(y,null,[u(n,{title:t.value,subTitle:a.value,onBack:C,ghost:!1,style:{padding:"10px 24px"}},{extra:m(()=>[u(w,null,{default:m(()=>[u(p,null,{default:m(()=>[x("加载外部组件")]),_:1}),u(p,{onClick:s,class:"variable-btn"},{default:m(()=>[x(" 变量池配置 ")]),_:1}),u(p,{onClick:h,type:"primary",class:"save-btn"},{default:m(()=>[x(" 保存 ")]),_:1})]),_:1})]),tags:m(()=>[u(i,{color:"#87d068"},{default:m(()=>[x("启用")]),_:1}),u(i,{color:"#f50"},{default:m(()=>[x("停用")]),_:1})]),_:1},8,["title","subTitle"]),_("div",Dt,[u(Ct),u(st),u(tt)])],64)}}}),oe=k(yt,[["__scopeId","data-v-7db97abc"]]);export{oe as default};
