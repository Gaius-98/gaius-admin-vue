import{_ as A}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-CnZ-1Il3.js";import{t as E}from"./table-Ce98BZqw.js";import{h as R}from"./http-DhmzCzHk.js";import{d as G,au as M,r as i,p as Z,w as S,D as y,I as B,E as V,F as l,U as k,g as e,R as q,$ as H,M as $,Z as z,G as w,S as F,N as P,V as J}from"./index-bmd1BFpa.js";import{C as K,_ as Q,a as W}from"./index-CHgE4CQh.js";import{U as X}from"./index-BtZ359FT.js";import{D as Y}from"./index-CwNMyvuk.js";import{B as tt}from"./index-ccK5NkPn.js";import{I as at}from"./index-BK2y0-Qq.js";import{S as et}from"./SyncOutlined-Dm7Rv4YH.js";import{_ as ot,a as nt}from"./index-DtiKgdxz.js";import"./LowCodeForm.vue_vue_type_script_setup_true_lang-CEhB9v52.js";import"./index-D8JELHeK.js";import"./common-BPfWHcpG.js";import"./index-B6bQoHWO.js";import"./index--nVjuQ_Y.js";import"./SwapRightOutlined-DUaVRxMa.js";import"./index-Cq9WKtO8.js";import"./form-CMdEH94D.js";import"./index-Dt-PmioO.js";import"./PlusOutlined-N7c1luKh.js";import"./index-CKZFhYXA.js";import"./SwapOutlined-TcDKE0fZ.js";import"./FolderOutlined-Ngg1a1-D.js";import"./index-Cg1wufYO.js";import"./useBreakpoint-HC6Nlkir.js";const lt=u=>{const c={};return u.reduce((s,t)=>(s[t.key]=t.defaultValue,s),c),c},st=async(u,c,s)=>{try{const t=await R.run(u.interfaceUrl,{...c,...s});return new Function("res",u.handlerFunc)(t.data)}catch(t){return t}},U={refreshData:st,transformParamsData:lt},rt={class:"low-code-table"},it={style:{"font-size":"12px"}},ut={class:"tools"},ct=["href"],pt=G({__name:"LowCodeTable",props:{id:{}},setup(u){const c=u,{id:s}=M(c),t=i({}),h=i([]),v=i({}),b=i(!1),O=()=>{v.value={},d()},p=i(!1),D=Z(()=>{var o,a,n,f,g,_;return((n=(a=(o=t.value)==null?void 0:o.global)==null?void 0:a.filterCfg)==null?void 0:n.show)&&((_=(g=(f=t.value)==null?void 0:f.global)==null?void 0:g.filterCfg)==null?void 0:_.formId)}),m=i({});S(()=>s.value,()=>{E.getDetail(s.value).then(o=>{const{code:a,data:n,msg:f}=o;a==200&&(t.value=n,m.value=U.transformParamsData(t.value.variablePool),d())})},{immediate:!0}),S(()=>m.value,()=>{d()},{deep:!0});const I=i(0),d=async()=>{b.value=!0;try{const{data:o,total:a}=await U.refreshData(t.value.dataSource,m.value,v.value);h.value=o,a&&(I.value=a)}catch(o){q.error("获取数据失败:"+o)}b.value=!1};return(o,a)=>{const n=tt,f=Q,g=W,_=K,T=at,j=ot,L=nt;return y(),B("div",rt,[D.value?(y(),V(_,{key:0,class:"filter-panel"},{default:l(()=>[e(A,{formData:v.value,id:t.value.global.filterCfg.formId,class:H(["filter-form",p.value?"expand":""])},null,8,["formData","id","class"]),e(g,null,{default:l(()=>[e(f,{span:24,style:{"text-align":"right"}},{default:l(()=>[e(n,{type:"primary","html-type":"submit",onClick:d},{default:l(()=>[$("搜索")]),_:1}),e(n,{style:{margin:"0 8px"},onClick:O},{default:l(()=>[$("重置")]),_:1}),e(n,{type:"link",icon:z(p.value?w(X):w(Y)),onClick:a[0]||(a[0]=C=>p.value=!p.value)},{default:l(()=>[F("span",it,P(p.value?"收起":"展开"),1)]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})):k("",!0),e(_,{class:"table-container"},{default:l(()=>{var C,N;return[F("div",ut,[e(n,{icon:z(w(et)),type:"link",title:"刷新数据",style:{float:"right"},onClick:d},null,8,["icon"])]),e(j,{columns:t.value.columns,"data-source":h.value,scroll:{y:D.value?470:670},loading:b.value,pagination:!1},{bodyCell:l(({column:r,record:x})=>[r.type=="image"?(y(),V(T,{key:0,src:`${x[r.dataIndex]}`,height:"130px",width:"100%"},null,8,["src"])):k("",!0),r.type=="link"?(y(),B("a",{key:1,href:`${x[r.dataIndex]}`,target:"_blank"},P(x[r.dataIndex]),9,ct)):k("",!0)]),_:1},8,["columns","data-source","scroll","loading"]),e(L,{style:{display:"flex","justify-content":"flex-end"},current:m.value.pageNumber,"onUpdate:current":a[1]||(a[1]=r=>m.value.pageNumber=r),defaultPageSize:(N=(C=t.value.global)==null?void 0:C.pagination)==null?void 0:N.pageSize,total:I.value,"show-less-items":""},null,8,["current","defaultPageSize","total"])]}),_:1})])}}}),jt=J(pt,[["__scopeId","data-v-696fd378"]]);export{jt as default};
