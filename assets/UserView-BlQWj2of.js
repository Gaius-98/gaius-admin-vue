import{b as m,_ as Q}from"./index-C9RMpzOL.js";import ee from"./ImagePicker-C_y7yS0g.js";import{e as ae,m as te,r,n as $,L as oe,o as p,q as w,j as e,w as t,c as O,U as ne,V as le,J as i,P as se,g as C,R as ue,W as y,F as S,X as re,Y as de,Z as ie,$ as _e,a0 as me,a1 as pe,a3 as ce,K as ve,a2 as fe,a4 as ge,a9 as ye,T as ke}from"./.pnpm-0Jz4sC39.js";import"./resource-llaC2XW-.js";const be={class:"user"},we={class:"tools"},Ce=ae({__name:"UserView",setup(Ie){const d=te({keyword:"",pageNumber:1,pageSize:10}),I=r([]),B=r([{title:"用户名",key:"username",dataIndex:"username"},{title:"名称",key:"name",dataIndex:"name"},{title:"邮箱",key:"email",dataIndex:"email"},{title:"角色",key:"roleId",dataIndex:"roleId"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),k=r(!1),x=r(),z=()=>{var o;(o=x.value)==null||o.resetFields(),_()},F=r(0),L=()=>{d.pageNumber=1,d.pageSize=10,_()},P=o=>{const{current:a,pageSize:s}=o;d.pageNumber=a,d.pageSize=s,_()},_=()=>{k.value=!0,m.getList(d).then(o=>{const{code:a,data:s}=o;a==200&&(I.value=s.data,F.value=s.total),k.value=!1})};$(()=>{_()});const c=r(!1),l=r({username:"",name:"",password:"",email:"",avatar:"",roleId:""}),v=r("add"),j=oe(()=>({add:"新增用户",edit:"编辑用户"})[v.value]),U=r(),E=()=>{v.value="add",c.value=!0,l.value={username:"",name:"",password:"",email:"",avatar:"",roleId:""}},M=async o=>{const{code:a,data:s}=await m.getDetail(o.username);a==200&&(l.value=s,v.value="edit",c.value=!0)},h=async o=>{const{code:a,msg:s,data:u}=await m.remove(o.username);a==200&&(O.success(u),_())},N=()=>{var o;(o=U.value)==null||o.resetFields()},q=()=>{let o;v.value=="add"?o=m.add:o=m.update,o(l.value).then(a=>{const{code:s}=a;s==200&&(O.success(v.value=="add"?"新增成功":"编辑成功"),_()),N(),c.value=!1})},T=r([]),A=()=>{m.getRoleDict().then(o=>{const{code:a,data:s,msg:u}=o;a==200&&(T.value=s)})};return $(()=>{A()}),(o,a)=>{const s=re,u=de,D=ie,f=_e,J=me,R=pe,V=ne,b=ce,K=ve,W=fe,X=ge,Y=ye,Z=ke,G=le;return p(),w("div",be,[e(V,{class:"search-area"},{default:t(()=>[e(R,{ref_key:"searchFormRef",ref:x,model:d,onFinish:L},{default:t(()=>[e(J,{gutter:24},{default:t(()=>[e(D,{span:4},{default:t(()=>[e(u,{label:"用户名",name:"keyword"},{default:t(()=>[e(s,{value:d.keyword,"onUpdate:value":a[0]||(a[0]=n=>d.keyword=n)},null,8,["value"])]),_:1})]),_:1}),e(D,{span:4,style:{"text-align":"right"}},{default:t(()=>[e(f,{type:"primary","html-type":"submit"},{default:t(()=>[i("搜索")]),_:1}),e(f,{style:{margin:"0 8px"},onClick:z},{default:t(()=>[i(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(V,null,{default:t(()=>[se("div",we,[e(f,{type:"primary",onClick:E},{default:t(()=>[i("新增")]),_:1})]),e(X,{loading:k.value,columns:B.value,"data-source":I.value,scroll:{y:440},onChange:P,pagination:{current:d.pageNumber,total:F.value}},{bodyCell:t(({column:n,record:g})=>[n.key=="role"?(p(),C(b,{key:0},{default:t(()=>[i(ue(g.role),1)]),_:2},1024)):y("",!0),n.key=="action"?(p(),w(S,{key:1},[e(f,{type:"link",onClick:H=>M(g)},{default:t(()=>[i("编辑")]),_:2},1032,["onClick"]),e(K,{type:"vertical"}),e(W,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:H=>h(g)},{default:t(()=>[e(f,{type:"link",danger:""},{default:t(()=>[i("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):y("",!0),n.key=="userType"?(p(),w(S,{key:2},[g.userType=="app"?(p(),C(b,{key:0,color:"#2db7f5"},{default:t(()=>[i("菜单")]),_:1})):y("",!0),g.userType=="directory"?(p(),C(b,{key:1,color:"#87d068"},{default:t(()=>[i("目录")]),_:1})):y("",!0)],64)):y("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(G,{open:c.value,"onUpdate:open":a[7]||(a[7]=n=>c.value=n),onOk:q,title:j.value,onCancel:N},{default:t(()=>[e(R,{model:l.value,"label-col":{span:8},ref_key:"modalFormRef",ref:U},{default:t(()=>[e(u,{label:"用户名"},{default:t(()=>[e(s,{value:l.value.username,"onUpdate:value":a[1]||(a[1]=n=>l.value.username=n)},null,8,["value"])]),_:1}),e(u,{label:"密码"},{default:t(()=>[e(Y,{value:l.value.password,"onUpdate:value":a[2]||(a[2]=n=>l.value.password=n)},null,8,["value"])]),_:1}),e(u,{label:"角色"},{default:t(()=>[e(Z,{value:l.value.roleId,"onUpdate:value":a[3]||(a[3]=n=>l.value.roleId=n),fieldNames:{label:"roleName",value:"roleId"},options:T.value},null,8,["value","options"])]),_:1}),e(u,{label:"头像"},{default:t(()=>[e(ee,{value:l.value.avatar,"onUpdate:value":a[4]||(a[4]=n=>l.value.avatar=n)},null,8,["value"])]),_:1}),e(u,{label:"名称"},{default:t(()=>[e(s,{value:l.value.name,"onUpdate:value":a[5]||(a[5]=n=>l.value.name=n)},null,8,["value"])]),_:1}),e(u,{label:"邮箱"},{default:t(()=>[e(s,{value:l.value.email,"onUpdate:value":a[6]||(a[6]=n=>l.value.email=n)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Te=Q(Ce,[["__scopeId","data-v-b63115a4"]]);export{Te as default};
