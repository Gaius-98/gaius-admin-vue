import{r as g,_ as oe}from"./index-SwBkXF0w.js";import{a as le}from"./menu-CEuwfG05.js";import{e as ne,a7 as se,m as ue,r as d,n as B,L as re,o as i,q as x,j as e,w as t,c as M,U as de,V as ce,J as u,P as $,F as N,g as C,W as k,X as _e,Y as ie,Z as pe,$ as me,a0 as ve,a1 as fe,a3 as ye,K as ge,a2 as ke,a4 as be,a5 as he,a6 as xe,ak as Ce}from"./.pnpm-0Jz4sC39.js";const b={getList:r=>g({method:"get",url:"role/list",params:r}),getDetail:r=>g({method:"get",url:"role/detail",params:{id:r}}),remove:r=>g({method:"get",url:"role/remove",params:{id:r}}),add:r=>g({method:"post",url:"role/add",data:r}),update:r=>g({method:"post",url:"role/update",data:r})},Ie={class:"role"},Ne={class:"tools"},Ve={style:{height:"200px","overflow-y":"auto"}},we=ne({__name:"RoleView",setup(r){se.SHOW_ALL;const c=ue({keyword:"",pageNumber:1,pageSize:10}),V=d([]),z=d([{title:"角色名",key:"roleName",dataIndex:"roleName"},{title:"角色ID",key:"roleId",dataIndex:"roleId"},{title:"备注",key:"desc",dataIndex:"desc"},{title:"状态",key:"status",dataIndex:"status"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),I=d(!1),w=d(),A=()=>{var o;(o=w.value)==null||o.resetFields(),p()},F=d(0),K=()=>{c.pageNumber=1,c.pageSize=10,p()},j=o=>{const{current:a,pageSize:s}=o;c.pageNumber=a,c.pageSize=s,p()},p=()=>{I.value=!0,b.getList(c).then(o=>{const{code:a,data:s}=o;a==200&&(V.value=s.data,F.value=s.total),I.value=!1})};B(()=>{p()});const m=d(!1),l=d({roleName:"",roleId:"",status:1,desc:"",roleValue:[]}),v=d("add"),P=re(()=>({add:"新增角色",edit:"编辑角色"})[v.value]),T=d(),q=()=>{v.value="add",m.value=!0,l.value={roleName:"",roleId:"",status:1,desc:"",roleValue:[]}},E=async o=>{const{code:a,data:s}=await b.getDetail(o.id);a==200&&(l.value=s,v.value="edit",m.value=!0)},W=async o=>{const{code:a,msg:s,data:_}=await b.remove(o.id);a==200&&(M.success(_),p())},S=()=>{var o;(o=T.value)==null||o.resetFields()},H=()=>{let o;v.value=="add"?o=b.add:o=b.update,l.value.roleValue instanceof Array||(l.value.roleValue=l.value.roleValue.checked),o(l.value).then(a=>{const{code:s}=a;s==200&&(M.success(v.value=="add"?"新增成功":"编辑成功"),p()),S(),m.value=!1})},U=d([]),J=()=>{le.getAllMenu().then(o=>{const{code:a,data:s,msg:_}=o;a==200&&(U.value=s)})};return B(()=>{J()}),(o,a)=>{const s=_e,_=ie,D=pe,f=me,X=ve,O=fe,L=de,h=ye,Y=ge,Z=ke,G=be,R=he,Q=xe,ee=Ce,te=ce;return i(),x("div",Ie,[e(L,{class:"search-area"},{default:t(()=>[e(O,{ref_key:"searchFormRef",ref:w,model:c,onFinish:K},{default:t(()=>[e(X,{gutter:24},{default:t(()=>[e(D,{span:4},{default:t(()=>[e(_,{label:"角色名称",name:"keyword"},{default:t(()=>[e(s,{value:c.keyword,"onUpdate:value":a[0]||(a[0]=n=>c.keyword=n)},null,8,["value"])]),_:1})]),_:1}),e(D,{span:4,style:{"text-align":"right"}},{default:t(()=>[e(f,{type:"primary","html-type":"submit"},{default:t(()=>[u("搜索")]),_:1}),e(f,{style:{margin:"0 8px"},onClick:A},{default:t(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(L,null,{default:t(()=>[$("div",Ne,[e(f,{type:"primary",onClick:q},{default:t(()=>[u("新增")]),_:1})]),e(G,{loading:I.value,columns:z.value,"data-source":V.value,scroll:{y:440},onChange:j,pagination:{current:c.pageNumber,total:F.value}},{bodyCell:t(({column:n,record:y})=>[n.key=="status"?(i(),x(N,{key:0},[y.status?(i(),C(h,{key:0,color:"#87d068"},{default:t(()=>[u("启用")]),_:1})):(i(),C(h,{key:1,color:"#f50"},{default:t(()=>[u("停用")]),_:1}))],64)):k("",!0),n.key=="action"?(i(),x(N,{key:1},[e(f,{type:"link",onClick:ae=>E(y)},{default:t(()=>[u("编辑")]),_:2},1032,["onClick"]),e(Y,{type:"vertical"}),e(Z,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:ae=>W(y)},{default:t(()=>[e(f,{type:"link",danger:""},{default:t(()=>[u("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):k("",!0),n.key=="roleType"?(i(),x(N,{key:2},[y.roleType=="app"?(i(),C(h,{key:0,color:"#2db7f5"},{default:t(()=>[u("菜单")]),_:1})):k("",!0),y.roleType=="directory"?(i(),C(h,{key:1,color:"#87d068"},{default:t(()=>[u("目录")]),_:1})):k("",!0)],64)):k("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(te,{open:m.value,"onUpdate:open":a[6]||(a[6]=n=>m.value=n),onOk:H,title:P.value,onCancel:S},{default:t(()=>[e(O,{model:l.value,"label-col":{span:8},ref_key:"modalFormRef",ref:T},{default:t(()=>[e(_,{label:"角色名"},{default:t(()=>[e(s,{value:l.value.roleName,"onUpdate:value":a[1]||(a[1]=n=>l.value.roleName=n)},null,8,["value"])]),_:1}),e(_,{label:"角色ID"},{default:t(()=>[e(s,{value:l.value.roleId,"onUpdate:value":a[2]||(a[2]=n=>l.value.roleId=n)},null,8,["value"])]),_:1}),e(_,{label:"状态"},{default:t(()=>[e(Q,{value:l.value.status,"onUpdate:value":a[3]||(a[3]=n=>l.value.status=n),"button-style":"solid"},{default:t(()=>[e(R,{value:1},{default:t(()=>[u("启用 ")]),_:1}),e(R,{value:0},{default:t(()=>[u("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),e(_,{label:"权限"},{default:t(()=>[$("div",Ve,[e(ee,{checkedKeys:l.value.roleValue,"onUpdate:checkedKeys":a[4]||(a[4]=n=>l.value.roleValue=n),"tree-data":U.value,checkStrictly:!0,checkable:"","field-names":{children:"children",title:"label",key:"id"}},null,8,["checkedKeys","tree-data"])])]),_:1}),e(_,{label:"备注"},{default:t(()=>[e(s,{value:l.value.desc,"onUpdate:value":a[5]||(a[5]=n=>l.value.desc=n)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Ue=oe(we,[["__scopeId","data-v-720cdee6"]]);export{Ue as default};
