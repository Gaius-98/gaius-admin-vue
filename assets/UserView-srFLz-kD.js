import{a5 as m,d as Y,a1 as ee,e as r,B as V,h as ae,N as p,O as x,k as e,V as t,a2 as L,a0 as i,a3 as te,U as C,a6 as oe,a4 as b,Z as S,Q as le}from"./index-BJNaeSOg.js";import{C as ne,M as se,_ as ue,a as re}from"./index-DvjRX04k.js";import{I as de,_ as ie,B as me,F as pe,b as _e}from"./index-ByldkgZ2.js";import{T as ce,S as ve}from"./index-C56zg6bC.js";import{_ as fe,a as ge,b as ye}from"./index-qeluSGKx.js";import"./PlusOutlined-FMZKPnog.js";import"./FolderOutlined-C1yJFZsL.js";import"./RightOutlined-Dxp7cLrz.js";const _={getList:u=>m({method:"get",url:"user/list",params:u}),getDetail:u=>m({method:"get",url:"user/detail",params:{username:u}}),remove:u=>m({method:"get",url:"user/remove",params:{username:u}}),add:u=>m({method:"post",url:"user/register",data:u}),update:u=>m({method:"post",url:"user/update",data:u}),getRoleDict:()=>m({method:"get",url:"role/dict"})},ke={class:"user"},be={class:"tools"},Ie=Y({__name:"UserView",setup(u){const c=ee({keyword:"",pageNumber:1,pageSize:10}),F=r([]),$=r([{title:"用户名",key:"username",dataIndex:"username"},{title:"名称",key:"name",dataIndex:"name"},{title:"邮箱",key:"email",dataIndex:"email"},{title:"角色",key:"roleId",dataIndex:"roleId"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),I=r(!1),D=r(),M=()=>{var o;(o=D.value)==null||o.resetFields(),v()},T=r(0),v=()=>{I.value=!0,_.getList(c).then(o=>{const{code:a,data:s}=o;a==200&&(F.value=s.data,T.value=s.total),I.value=!1})};V(()=>{v()});const f=r(!1),n=r({username:"",name:"",password:"",email:"",avatar:"",roleId:""}),g=r("add"),j=ae(()=>({add:"新增用户",edit:"编辑用户"})[g.value]),U=r(),E=()=>{g.value="add",f.value=!0,n.value={username:"",name:"",password:"",email:"",avatar:"",roleId:""}},q=async o=>{const{code:a,data:s}=await _.getDetail(o.username);a==200&&(n.value=s,g.value="edit",f.value=!0)},z=async o=>{const{code:a,msg:s,data:d}=await _.remove(o.username);a==200&&(L.success(d),v())},N=()=>{var o;(o=U.value)==null||o.resetFields()},A=()=>{let o;g.value=="add"?o=_.add:o=_.update,o(n.value).then(a=>{const{code:s}=a;s==200&&(L.success(g.value=="add"?"新增成功":"编辑成功"),v()),N(),f.value=!1})},h=r([]),P=()=>{_.getRoleDict().then(o=>{const{code:a,data:s,msg:d}=o;a==200&&(h.value=s)})};return V(()=>{P()}),(o,a)=>{const s=de,d=ie,B=ue,y=me,Q=re,O=pe,R=ne,w=ce,Z=fe,G=ge,H=ye,J=_e,K=ve,W=se;return p(),x("div",ke,[e(R,{class:"search-area"},{default:t(()=>[e(O,{ref_key:"searchFormRef",ref:D,model:c,onFinish:v},{default:t(()=>[e(Q,{gutter:24},{default:t(()=>[e(B,{span:4},{default:t(()=>[e(d,{label:"用户名",name:"keyword"},{default:t(()=>[e(s,{value:c.keyword,"onUpdate:value":a[0]||(a[0]=l=>c.keyword=l)},null,8,["value"])]),_:1})]),_:1}),e(B,{span:4,style:{"text-align":"right"}},{default:t(()=>[e(y,{type:"primary","html-type":"submit"},{default:t(()=>[i("搜索")]),_:1}),e(y,{style:{margin:"0 8px"},onClick:M},{default:t(()=>[i(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(R,null,{default:t(()=>[te("div",be,[e(y,{type:"primary",onClick:E},{default:t(()=>[i("新增")]),_:1})]),e(H,{loading:I.value,columns:$.value,"data-source":F.value,pagination:{current:c.pageNumber,total:T.value}},{bodyCell:t(({column:l,record:k})=>[l.key=="role"?(p(),C(w,{key:0},{default:t(()=>[i(oe(k.role),1)]),_:2},1024)):b("",!0),l.key=="action"?(p(),x(S,{key:1},[e(y,{type:"link",onClick:X=>q(k)},{default:t(()=>[i("编辑")]),_:2},1032,["onClick"]),e(Z,{type:"vertical"}),e(G,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:X=>z(k)},{default:t(()=>[e(y,{type:"link",danger:""},{default:t(()=>[i("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):b("",!0),l.key=="userType"?(p(),x(S,{key:2},[k.userType=="app"?(p(),C(w,{key:0,color:"#2db7f5"},{default:t(()=>[i("菜单")]),_:1})):b("",!0),k.userType=="directory"?(p(),C(w,{key:1,color:"#87d068"},{default:t(()=>[i("目录")]),_:1})):b("",!0)],64)):b("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(W,{open:f.value,"onUpdate:open":a[6]||(a[6]=l=>f.value=l),onOk:A,title:j.value,onCancel:N},{default:t(()=>[e(O,{model:n.value,"label-col":{span:8},ref_key:"modalFormRef",ref:U},{default:t(()=>[e(d,{label:"用户名"},{default:t(()=>[e(s,{value:n.value.username,"onUpdate:value":a[1]||(a[1]=l=>n.value.username=l)},null,8,["value"])]),_:1}),e(d,{label:"密码"},{default:t(()=>[e(J,{value:n.value.password,"onUpdate:value":a[2]||(a[2]=l=>n.value.password=l)},null,8,["value"])]),_:1}),e(d,{label:"角色"},{default:t(()=>[e(K,{value:n.value.roleId,"onUpdate:value":a[3]||(a[3]=l=>n.value.roleId=l),fieldNames:{label:"roleName",value:"roleId"},options:h.value},null,8,["value","options"])]),_:1}),e(d,{label:"名称"},{default:t(()=>[e(s,{value:n.value.name,"onUpdate:value":a[4]||(a[4]=l=>n.value.name=l)},null,8,["value"])]),_:1}),e(d,{label:"邮箱"},{default:t(()=>[e(s,{value:n.value.email,"onUpdate:value":a[5]||(a[5]=l=>n.value.email=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),he=le(Ie,[["__scopeId","data-v-f20b5a6d"]]);export{he as default};
