import{c as ne,b as g,_ as se}from"./index-BcO9VjBp.js";import ue from"./ImagePicker-BkPfVSL6.js";import{g as re,m as de,r as _,n as z,L as _e,U as ie,o as r,q as w,l as a,w as t,e as L,V as pe,W as me,J as d,P as ce,X as C,i,F as U,Y as m,R as ve,$ as fe,a0 as ge,a1 as ye,a2 as ke,a3 as be,a4 as we,a5 as Ie,ac as xe,a6 as Ce,a7 as Ue,ad as he,T as De,aa as Fe,a8 as Ne,a9 as Te}from"./.pnpm-DjRYcvsk.js";import"./resource-3U_Bq2tM.js";/* empty css                                                                    */const $e={class:"user"},Oe={class:"tools"},Re=re({__name:"UserView",setup(Ve){const p=de({keyword:"",pageNumber:1,pageSize:10}),h=_([]),P=_([{title:"用户名",key:"username",dataIndex:"username"},{title:"头像",key:"avatar",dataIndex:"avatar"},{title:"昵称",key:"name",dataIndex:"name"},{title:"邮箱",key:"email",dataIndex:"email"},{title:"电话",key:"phone",dataIndex:"phone"},{title:"状态",key:"status",dataIndex:"status"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),I=_(!1),D=_(),j=()=>{var o;(o=D.value)==null||o.resetFields(),v()},F=_(0),E=()=>{p.pageNumber=1,p.pageSize=10,v()},M=o=>{const{current:e,pageSize:s}=o;p.pageNumber=e,p.pageSize=s,v()},v=()=>{I.value=!0,g.getList(p).then(o=>{const{code:e,data:s}=o;e==200&&(h.value=s.data,F.value=s.total),I.value=!1})},N=_([]);z(()=>{v(),ne.getOrgTree().then(o=>{const{code:e,data:s,msg:u}=o;e==200&&(N.value=s)})});const y=_(!1),n=_({username:"",name:"",password:"",email:"",avatar:"",roleIds:[],phone:"",status:"1",orgId:0}),f=_("add"),q=_e(()=>({add:"新增用户",edit:"编辑用户"})[f.value]),T=_(),A=()=>{f.value="add",y.value=!0,n.value={username:"",name:"",password:"",email:"",avatar:"",roleIds:[],phone:"",status:"1",orgId:0}},J=async o=>{const{code:e,data:s}=await g.getDetail(o.userId);e==200&&(n.value=s,f.value="edit",y.value=!0)},W=async o=>{const{code:e,msg:s,data:u}=await g.remove(o.userId);e==200&&(L.success(u),v())},$=()=>{var o;(o=T.value)==null||o.resetFields()},X=()=>{let o;f.value=="add"?o=g.add:o=g.update,o(n.value).then(e=>{const{code:s}=e;s==200&&(L.success(f.value=="add"?"新增成功":"编辑成功"),v()),$(),y.value=!1})},O=_([]),Y=()=>{g.getRoleDict().then(o=>{const{code:e,data:s,msg:u}=o;e==200&&(O.value=s)})};return z(()=>{Y()}),(o,e)=>{const s=fe,u=ge,R=ye,k=ke,G=be,V=we,S=pe,b=Ie,H=xe,K=Ce,Q=Ue,Z=he,ee=De,ae=Fe,B=Ne,te=Te,le=me,x=ie("has-perm");return r(),w("div",$e,[a(S,{class:"search-area"},{default:t(()=>[a(V,{ref_key:"searchFormRef",ref:D,model:p,onFinish:E},{default:t(()=>[a(G,{gutter:24},{default:t(()=>[a(R,{span:4},{default:t(()=>[a(u,{label:"用户名",name:"keyword"},{default:t(()=>[a(s,{value:p.keyword,"onUpdate:value":e[0]||(e[0]=l=>p.keyword=l)},null,8,["value"])]),_:1})]),_:1}),a(R,{span:4,style:{"text-align":"right"}},{default:t(()=>[a(k,{type:"primary","html-type":"submit"},{default:t(()=>[d("搜索")]),_:1}),a(k,{style:{margin:"0 8px"},onClick:j},{default:t(()=>[d(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(S,null,{default:t(()=>[ce("div",Oe,[C((r(),i(k,{type:"primary",onClick:A},{default:t(()=>[d("新增")]),_:1})),[[x,"system:user:add"]])]),a(Q,{loading:I.value,columns:P.value,"data-source":h.value,scroll:{y:440},onChange:M,pagination:{current:p.pageNumber,total:F.value}},{bodyCell:t(({column:l,record:c})=>[l.key=="status"?(r(),w(U,{key:0},[c.status=="1"?(r(),i(b,{key:0,color:"#87d068"},{default:t(()=>[d("启用")]),_:1})):(r(),i(b,{key:1,color:"#f50"},{default:t(()=>[d("停用")]),_:1}))],64)):m("",!0),l.key=="avatar"?(r(),i(H,{key:1,src:`${c.avatar}`,height:"30px",width:"30px",preview:!1},null,8,["src"])):m("",!0),l.key=="role"?(r(),i(b,{key:2},{default:t(()=>[d(ve(c.role),1)]),_:2},1024)):m("",!0),l.key=="action"?(r(),w(U,{key:3},[C((r(),i(k,{type:"link",onClick:oe=>J(c)},{default:t(()=>[d("编辑")]),_:2},1032,["onClick"])),[[x,"system:user:update"]]),a(K,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:oe=>W(c)},{default:t(()=>[C((r(),i(k,{type:"link",danger:""},{default:t(()=>[d("删除")]),_:1})),[[x,"system:user:remove"]])]),_:2},1032,["onConfirm"])],64)):m("",!0),l.key=="userType"?(r(),w(U,{key:4},[c.userType=="app"?(r(),i(b,{key:0,color:"#2db7f5"},{default:t(()=>[d("菜单")]),_:1})):m("",!0),c.userType=="directory"?(r(),i(b,{key:1,color:"#87d068"},{default:t(()=>[d("目录")]),_:1})):m("",!0)],64)):m("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),a(le,{open:y.value,"onUpdate:open":e[10]||(e[10]=l=>y.value=l),onOk:X,title:q.value,onCancel:$},{default:t(()=>[a(V,{model:n.value,"label-col":{span:8},ref_key:"modalFormRef",ref:T},{default:t(()=>[a(u,{label:"用户名"},{default:t(()=>[a(s,{value:n.value.username,"onUpdate:value":e[1]||(e[1]=l=>n.value.username=l)},null,8,["value"])]),_:1}),f.value=="add"?(r(),i(u,{key:0,label:"密码"},{default:t(()=>[a(Z,{value:n.value.password,"onUpdate:value":e[2]||(e[2]=l=>n.value.password=l)},null,8,["value"])]),_:1})):m("",!0),a(u,{label:"角色"},{default:t(()=>[a(ee,{value:n.value.roleIds,"onUpdate:value":e[3]||(e[3]=l=>n.value.roleIds=l),fieldNames:{label:"roleName",value:"roleId"},mode:"multiple",options:O.value},null,8,["value","options"])]),_:1}),a(u,{label:"所属机构",name:"orgId"},{default:t(()=>[a(ae,{value:n.value.orgId,"onUpdate:value":e[4]||(e[4]=l=>n.value.orgId=l),"tree-node-filter-prop":"label","show-search":"","allow-clear":"",treeData:N.value,"field-names":{children:"children",label:"name",value:"id"}},null,8,["value","treeData"])]),_:1}),a(u,{label:"头像"},{default:t(()=>[a(ue,{value:n.value.avatar,"onUpdate:value":e[5]||(e[5]=l=>n.value.avatar=l)},null,8,["value"])]),_:1}),a(u,{label:"状态"},{default:t(()=>[a(te,{value:n.value.status,"onUpdate:value":e[6]||(e[6]=l=>n.value.status=l),"button-style":"solid"},{default:t(()=>[a(B,{value:"1"},{default:t(()=>[d("启用 ")]),_:1}),a(B,{value:"0"},{default:t(()=>[d("停用 ")]),_:1})]),_:1},8,["value"])]),_:1}),a(u,{label:"名称"},{default:t(()=>[a(s,{value:n.value.name,"onUpdate:value":e[7]||(e[7]=l=>n.value.name=l)},null,8,["value"])]),_:1}),a(u,{label:"邮箱"},{default:t(()=>[a(s,{value:n.value.email,"onUpdate:value":e[8]||(e[8]=l=>n.value.email=l)},null,8,["value"])]),_:1}),a(u,{label:"电话"},{default:t(()=>[a(s,{value:n.value.phone,"onUpdate:value":e[9]||(e[9]=l=>n.value.phone=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),je=se(Re,[["__scopeId","data-v-5c213775"]]);export{je as default};
