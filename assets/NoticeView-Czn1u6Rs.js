import{a as v}from"./notice-0-XGsy7E.js";import{c as W,_ as Z}from"./index-Cfdjy00A.js";import{g as ee,m as te,r as i,n as I,a8 as ae,o as f,q as O,l as a,w as n,e as R,ab as ne,ao as oe,ac as le,a6 as g,N as se,L as h,h as w,F as ie,ad as ce,X as ue,V as de,aI as re,ai as pe,R as me,a7 as _e,ap as ve,aq as fe,a5 as ge}from"./.pnpm-CWzuy1aI.js";const ye={class:"notice"},ke={class:"tools"},be=ee({__name:"NoticeView",setup(Ce){const o=te({keyword:"",pageNumber:1,pageSize:10,startTime:"",endTime:""}),r=i(""),B=()=>{r.value?(o.startTime=r.value[0],o.endTime=r.value[1]):(o.startTime="",o.endTime="")},T=i([]),M=i([{title:"标题",key:"title",dataIndex:"title",width:"150px"},{title:"内容",key:"content",dataIndex:"content",width:"400px",ellipsis:!0},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),k=i(!1),x=i(),U=()=>{var t;(t=x.value)==null||t.resetFields(),o.startTime="",o.endTime="",r.value="",p()},F=i(0),q=()=>{o.pageNumber=1,o.pageSize=10,p()},L=t=>{const{current:e,pageSize:l}=t;o.pageNumber=e,o.pageSize=l,p()},p=()=>{k.value=!0,v.getList(o).then(t=>{const{code:e,data:l}=t;e==200&&(T.value=l.data,F.value=l.total),k.value=!1})},N=i([]),Y=i({});I(()=>{p(),W.getDict(["configType"]).then(t=>{const{code:e,data:l,msg:c}=t;e==200&&(N.value=l.configType,Y.value=N.value.reduce((y,d)=>(y[d.value]=d.label,y),{}))})});const m=i(!1),u=i({title:"",content:""}),_=i("add"),$=ae(()=>({add:"新增通知",edit:"编辑通知"})[_.value]),b=i(),P=()=>{_.value="add",m.value=!0,u.value={title:"",content:""}},j=async t=>{const{code:e,data:l}=await v.getDetail(t.id);e==200&&(u.value=l,_.value="edit",m.value=!0)},E=async t=>{const{code:e,msg:l,data:c}=await v.remove(t.id);e==200&&(R.success(c),p())},D=()=>{var t;(t=b.value)==null||t.resetFields()},A=()=>{var t;(t=b.value)==null||t.validate().then(()=>{let e;_.value=="add"?e=v.add:e=v.update,e(u.value).then(l=>{const{code:c}=l;c==200&&(R.success(_.value=="add"?"新增成功":"编辑成功"),p()),D(),m.value=!1})})};return I(()=>{}),(t,e)=>{const l=ue,c=de,y=re,d=pe,S=me,z=ne,X=_e,G=ve,H=fe,J=ge,K=oe,C=le("has-perm");return f(),O("div",ye,[a(z,{class:"search-area"},{default:n(()=>[a(S,{ref_key:"searchFormRef",ref:x,model:o,layout:"inline",onFinish:q},{default:n(()=>[a(c,{label:"关键字",prop:"keyword"},{default:n(()=>[a(l,{value:o.keyword,"onUpdate:value":e[0]||(e[0]=s=>o.keyword=s)},null,8,["value"])]),_:1}),a(c,{label:"日期范围"},{default:n(()=>[a(y,{value:r.value,"onUpdate:value":e[1]||(e[1]=s=>r.value=s),valueFormat:"YYYY-MM-DD",onChange:e[2]||(e[2]=s=>B())},null,8,["value"])]),_:1}),a(c,null,{default:n(()=>[a(d,{type:"primary","html-type":"submit"},{default:n(()=>[g("搜索")]),_:1}),a(d,{style:{margin:"0 8px"},onClick:U},{default:n(()=>[g(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(z,null,{default:n(()=>[se("div",ke,[h((f(),w(d,{type:"primary",onClick:P},{default:n(()=>[g("新增")]),_:1})),[[C,"system:notice:add"]])]),a(H,{loading:k.value,columns:M.value,"data-source":T.value,scroll:{y:560},onChange:L,pagination:{current:o.pageNumber,total:F.value,showSizeChanger:!0,pageSize:o.pageSize}},{bodyCell:n(({column:s,record:V})=>[s.key=="action"?(f(),O(ie,{key:0},[h((f(),w(d,{type:"link",onClick:Q=>j(V)},{default:n(()=>[g("编辑")]),_:2},1032,["onClick"])),[[C,"system:notice:update"]]),a(X,{type:"vertical"}),a(G,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:Q=>E(V)},{default:n(()=>[h((f(),w(d,{type:"link",danger:""},{default:n(()=>[g("删除")]),_:1})),[[C,"system:notice:remove"]])]),_:2},1032,["onConfirm"])],64)):ce("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),a(K,{open:m.value,"onUpdate:open":e[5]||(e[5]=s=>m.value=s),onOk:A,title:$.value,onCancel:D},{default:n(()=>[a(S,{model:u.value,"label-col":{span:8},ref_key:"modalFormRef",ref:b},{default:n(()=>[a(c,{label:"标题",required:"",prop:"title"},{default:n(()=>[a(l,{value:u.value.title,"onUpdate:value":e[3]||(e[3]=s=>u.value.title=s)},null,8,["value"])]),_:1}),a(c,{label:"内容",required:"",prop:"title"},{default:n(()=>[a(J,{value:u.value.content,"onUpdate:value":e[4]||(e[4]=s=>u.value.content=s),rows:5},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),xe=Z(be,[["__scopeId","data-v-45792e0d"]]);export{xe as default};
