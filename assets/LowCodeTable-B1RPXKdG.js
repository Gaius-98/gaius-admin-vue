import{_ as j}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-BhjjBhZ0.js";import{t as P}from"./table-0qv9UioH.js";import{h as A}from"./http-BBBfgiF9.js";import{d as E,an as H,r as i,t as J,w as I,J as y,L as N,U as S,M as l,a3 as x,g as e,a0 as M,aH as Q,O as z,aa as B,Q as k,a2 as O,X as U,Z as R,ah as X,a6 as Z}from"./index-Dnllc660.js";import{C as q,_ as G,a as K}from"./index-qY2HqPh2.js";import{U as W}from"./index-xo95AWta.js";import{D as Y}from"./index-CmT_P4Rx.js";import{S as aa}from"./SyncOutlined-BaO_SCxl.js";import{_ as ta,a as ea}from"./index-q7u2mUtV.js";import"./LowCodeForm.vue_vue_type_script_setup_true_lang-DcV12_f8.js";import"./common-Cn3zKYyu.js";import"./index-CdPL3hVj.js";import"./index-2tPwGdc7.js";import"./index-OTmqiICm.js";import"./SwapRightOutlined-0xVvP0B-.js";import"./index-CYRntD6c.js";import"./form-CwkGkGuQ.js";import"./index-CMIDOs3Z.js";import"./EllipsisOutlined-UqpZrikn.js";import"./index-VeRW38yI.js";import"./index-BxK3iEOI.js";import"./FolderOutlined-6kXSNoe3.js";import"./useBreakpoint-BvZhaG7P.js";import"./index-B7UcDlnN.js";const oa=c=>{const u={};return c.reduce((r,a)=>(r[a.key]=a.defaultValue,r),u),u},na=async(c,u,r)=>{try{const a=await A.run(c.interfaceUrl,{...u,...r});return new Function("res",c.handlerFunc)(a.data)}catch(a){return a}},V={refreshData:na,transformParamsData:oa},sa={class:"low-code-table"},la={style:{"font-size":"12px"}},ra={class:"tools"},ia=["href"],ca=E({__name:"LowCodeTable",props:{id:{}},setup(c){const u=c,{id:r}=H(u),a=i({}),h=i([]),v=i({}),b=i(!1),$=()=>{v.value={},_()},m=i(!1),w=J(()=>{var o,t,n,d,g,f;return((n=(t=(o=a.value)==null?void 0:o.global)==null?void 0:t.filterCfg)==null?void 0:n.show)&&((f=(g=(d=a.value)==null?void 0:d.global)==null?void 0:g.filterCfg)==null?void 0:f.formId)}),p=i({});I(()=>r.value,()=>{P.getDetail(r.value).then(o=>{const{code:t,data:n,msg:d}=o;t==200&&(a.value=n,p.value=V.transformParamsData(a.value.variablePool),_())})},{immediate:!0}),I(()=>p.value,()=>{_()},{deep:!0});const D=i(0),_=async()=>{b.value=!0;try{const{data:o,total:t}=await V.refreshData(a.value.dataSource,p.value,v.value);h.value=o,t&&(D.value=t)}catch(o){M.error("获取数据失败:"+o)}b.value=!1};return(o,t)=>{const n=R,d=G,g=K,f=q,F=X,L=ta,T=ea;return y(),N("div",sa,[w.value?(y(),S(f,{key:0,class:"filter-panel"},{default:l(()=>[e(j,{formData:v.value,id:a.value.global.filterCfg.formId,class:Q(["filter-form",m.value?"expand":""])},null,8,["formData","id","class"]),e(g,null,{default:l(()=>[e(d,{span:24,style:{"text-align":"right"}},{default:l(()=>[e(n,{type:"primary","html-type":"submit",onClick:_},{default:l(()=>[z("搜索")]),_:1}),e(n,{style:{margin:"0 8px"},onClick:$},{default:l(()=>[z("重置")]),_:1}),e(n,{type:"link",icon:B(m.value?k(W):k(Y)),onClick:t[0]||(t[0]=s=>m.value=!m.value)},{default:l(()=>[O("span",la,U(m.value?"收起":"展开"),1)]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})):x("",!0),e(f,{class:"table-container"},{default:l(()=>[O("div",ra,[e(n,{icon:B(k(aa)),type:"link",title:"刷新数据",style:{float:"right"},onClick:_},null,8,["icon"])]),e(L,{columns:a.value.columns,"data-source":h.value,scroll:{y:w.value?470:670},loading:b.value,pagination:!1},{bodyCell:l(({column:s,record:C})=>[s.type=="image"?(y(),S(F,{key:0,src:`${C[s.dataIndex]}`,height:"130px",width:"100%"},null,8,["src"])):x("",!0),s.type=="link"?(y(),N("a",{key:1,href:`${C[s.dataIndex]}`,target:"_blank"},U(C[s.dataIndex]),9,ia)):x("",!0)]),_:1},8,["columns","data-source","scroll","loading"]),e(T,{style:{display:"flex","justify-content":"flex-end","margin-top":"20px"},current:p.value.pageNumber,"onUpdate:current":t[1]||(t[1]=s=>p.value.pageNumber=s),pageSize:p.value.pageSize||10,total:D.value,"show-less-items":""},null,8,["current","pageSize","total"])]),_:1})])}}}),$a=Z(ca,[["__scopeId","data-v-aa8aa963"]]);export{$a as default};
