import{b as y,_ as ae}from"./index-DkuvX3NQ.js";import te from"./ImagePicker-CzMKZ6e7.js";import{g as oe,m as le,r as d,n as S,L as ne,U as se,o as u,q as w,l as t,w as a,e as B,V as ue,W as re,J as i,P as de,X as C,i as p,F as h,Y as m,R as ie,$ as pe,a0 as _e,a1 as me,a2 as ce,a3 as ve,a4 as fe,a6 as ye,ac as ge,a5 as ke,a7 as be,ad as we,T as xe}from"./.pnpm-DmAI0IVr.js";import"./resource-CixWC5Ew.js";/* empty css                                                                    */const Ie={class:"user"},Ce={class:"tools"},he=oe({__name:"UserView",setup(Fe){const _=le({keyword:"",pageNumber:1,pageSize:10}),F=d([]),z=d([{title:"用户名",key:"username",dataIndex:"username"},{title:"头像",key:"avatar",dataIndex:"avatar"},{title:"昵称",key:"name",dataIndex:"name"},{title:"邮箱",key:"email",dataIndex:"email"},{title:"电话",key:"phone",dataIndex:"phone"},{title:"状态",key:"status",dataIndex:"status"},{title:"操作",key:"action",dataIndex:"action",width:"250px"}]),x=d(!1),U=d(),L=()=>{var l;(l=U.value)==null||l.resetFields(),v()},D=d(0),P=()=>{_.pageNumber=1,_.pageSize=10,v()},j=l=>{const{current:e,pageSize:s}=l;_.pageNumber=e,_.pageSize=s,v()},v=()=>{x.value=!0,y.getList(_).then(l=>{const{code:e,data:s}=l;e==200&&(F.value=s.data,D.value=s.total),x.value=!1})};S(()=>{v()});const g=d(!1),n=d({username:"",name:"",password:"",email:"",avatar:"",roleIds:[],phone:""}),f=d("add"),E=ne(()=>({add:"新增用户",edit:"编辑用户"})[f.value]),N=d(),M=()=>{f.value="add",g.value=!0,n.value={username:"",name:"",password:"",email:"",avatar:"",roleIds:[],phone:""}},q=async l=>{const{code:e,data:s}=await y.getDetail(l.userId);e==200&&(n.value=s,f.value="edit",g.value=!0)},A=async l=>{const{code:e,msg:s,data:r}=await y.remove(l.userId);e==200&&(B.success(r),v())},$=()=>{var l;(l=N.value)==null||l.resetFields()},J=()=>{let l;f.value=="add"?l=y.add:l=y.update,l(n.value).then(e=>{const{code:s}=e;s==200&&(B.success(f.value=="add"?"新增成功":"编辑成功"),v()),$(),g.value=!1})},R=d([]),W=()=>{y.getRoleDict().then(l=>{const{code:e,data:s,msg:r}=l;e==200&&(R.value=s)})};return S(()=>{W()}),(l,e)=>{const s=pe,r=_e,T=me,k=ce,X=ve,V=fe,O=ue,b=ye,Y=ge,G=ke,H=be,K=we,Q=xe,Z=re,I=se("has-perm");return u(),w("div",Ie,[t(O,{class:"search-area"},{default:a(()=>[t(V,{ref_key:"searchFormRef",ref:U,model:_,onFinish:P},{default:a(()=>[t(X,{gutter:24},{default:a(()=>[t(T,{span:4},{default:a(()=>[t(r,{label:"用户名",name:"keyword"},{default:a(()=>[t(s,{value:_.keyword,"onUpdate:value":e[0]||(e[0]=o=>_.keyword=o)},null,8,["value"])]),_:1})]),_:1}),t(T,{span:4,style:{"text-align":"right"}},{default:a(()=>[t(k,{type:"primary","html-type":"submit"},{default:a(()=>[i("搜索")]),_:1}),t(k,{style:{margin:"0 8px"},onClick:L},{default:a(()=>[i(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(O,null,{default:a(()=>[de("div",Ce,[C((u(),p(k,{type:"primary",onClick:M},{default:a(()=>[i("新增")]),_:1})),[[I,"system:user:add"]])]),t(H,{loading:x.value,columns:z.value,"data-source":F.value,scroll:{y:440},onChange:j,pagination:{current:_.pageNumber,total:D.value}},{bodyCell:a(({column:o,record:c})=>[o.key=="status"?(u(),w(h,{key:0},[c.status?(u(),p(b,{key:0,color:"#87d068"},{default:a(()=>[i("启用")]),_:1})):(u(),p(b,{key:1,color:"#f50"},{default:a(()=>[i("停用")]),_:1}))],64)):m("",!0),o.key=="avatar"?(u(),p(Y,{key:1,src:`${c.avatar}`,height:"30px",width:"30px",preview:!1},null,8,["src"])):m("",!0),o.key=="role"?(u(),p(b,{key:2},{default:a(()=>[i(ie(c.role),1)]),_:2},1024)):m("",!0),o.key=="action"?(u(),w(h,{key:3},[C((u(),p(k,{type:"link",onClick:ee=>q(c)},{default:a(()=>[i("编辑")]),_:2},1032,["onClick"])),[[I,"system:user:update"]]),t(G,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:ee=>A(c)},{default:a(()=>[C((u(),p(k,{type:"link",danger:""},{default:a(()=>[i("删除")]),_:1})),[[I,"system:user:remove"]])]),_:2},1032,["onConfirm"])],64)):m("",!0),o.key=="userType"?(u(),w(h,{key:4},[c.userType=="app"?(u(),p(b,{key:0,color:"#2db7f5"},{default:a(()=>[i("菜单")]),_:1})):m("",!0),c.userType=="directory"?(u(),p(b,{key:1,color:"#87d068"},{default:a(()=>[i("目录")]),_:1})):m("",!0)],64)):m("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),t(Z,{open:g.value,"onUpdate:open":e[8]||(e[8]=o=>g.value=o),onOk:J,title:E.value,onCancel:$},{default:a(()=>[t(V,{model:n.value,"label-col":{span:8},ref_key:"modalFormRef",ref:N},{default:a(()=>[t(r,{label:"用户名"},{default:a(()=>[t(s,{value:n.value.username,"onUpdate:value":e[1]||(e[1]=o=>n.value.username=o)},null,8,["value"])]),_:1}),f.value=="add"?(u(),p(r,{key:0,label:"密码"},{default:a(()=>[t(K,{value:n.value.password,"onUpdate:value":e[2]||(e[2]=o=>n.value.password=o)},null,8,["value"])]),_:1})):m("",!0),t(r,{label:"角色"},{default:a(()=>[t(Q,{value:n.value.roleIds,"onUpdate:value":e[3]||(e[3]=o=>n.value.roleIds=o),fieldNames:{label:"roleName",value:"roleId"},mode:"multiple",options:R.value},null,8,["value","options"])]),_:1}),t(r,{label:"头像"},{default:a(()=>[t(te,{value:n.value.avatar,"onUpdate:value":e[4]||(e[4]=o=>n.value.avatar=o)},null,8,["value"])]),_:1}),t(r,{label:"名称"},{default:a(()=>[t(s,{value:n.value.name,"onUpdate:value":e[5]||(e[5]=o=>n.value.name=o)},null,8,["value"])]),_:1}),t(r,{label:"邮箱"},{default:a(()=>[t(s,{value:n.value.email,"onUpdate:value":e[6]||(e[6]=o=>n.value.email=o)},null,8,["value"])]),_:1}),t(r,{label:"电话"},{default:a(()=>[t(s,{value:n.value.phone,"onUpdate:value":e[7]||(e[7]=o=>n.value.phone=o)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Te=ae(he,[["__scopeId","data-v-e03108a4"]]);export{Te as default};
