var M=Object.defineProperty;var K=(a,o,e)=>o in a?M(a,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[o]=e;var h=(a,o,e)=>K(a,typeof o!="symbol"?o+"":o,e);import{u as O}from"./vue-router-XjRCv15Q.js";import{_ as P}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-ChxjQ8w8.js";import{d as E,s as B}from"./pinia-C_jLcksF.js";import{c as A}from"./lodash-es-PU94eZQX.js";import{r as b,a as J,d as w,R as l,S as D,c as u,u as y,F as k,W as z,a2 as S,a3 as m,af as U,ac as R,a7 as F,U as r,X as $,J as x,a6 as T,ad as H,m as N}from"./@vue-DmVhU8xE.js";import{b as I}from"./index-D_6qM47R.js";import{Q}from"./gaius-utils-ziEu-chL.js";import{v as X}from"./uuid-CQkTLCs1.js";import{u as j,z as W,A as Y,K as q,B as G,t as Z,T as tt}from"./ant-design-vue-DGPmw3tN.js";import"./LowCodeForm.vue_vue_type_script_setup_true_lang-BkHIa_as.js";import"./common-TXtelOzI.js";import"./form-BEi9Ryuk.js";/* empty css                      */import"./axios-B4uVmeYG.js";import"./js-cookie-Cz0CWeBA.js";import"./@vueuse-CvnCfVh1.js";import"./vue-codemirror-CBA9LlYn.js";import"./codemirror-DqN-1UAR.js";import"./@codemirror-BQbZevoh.js";import"./@lezer-CciglqRQ.js";import"./crelt-C8TCjufn.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";import"./@ant-design-CHQs8cUc.js";import"./@ctrl-DOFZgDuz.js";import"./@babel-BiFW4_mA.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./dayjs-X-x4l2Bb.js";import"./throttle-debounce-CUWDS_la.js";import"./async-validator-DKvM95Vc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";const V=E("visual",()=>{const a=b({componentData:[],name:"",id:"",img:"",height:1080,width:1920}),o=b({name:"",type:"",id:"",props:{},tag:"",position:{top:0,left:0},size:{width:0,height:0},formId:""}),e=J([]),t=b(0),n=()=>{e[t.value++]=A(a.value.componentData)};return{undo:()=>{t.value>0&&(t.value--,a.value.componentData=A(e[t.value]))},redo:()=>{t.value<e.length-1&&(t.value++,a.value.componentData=A(e[t.value]))},setSnapshot:n,onClickComp:c=>{const s=a.value.componentData.findIndex(p=>p.id===c.id);s!=-1&&(o.value=a.value.componentData[s])},visualData:a,curCompData:o,addComp:c=>{a.value.componentData.push(c),n()},removeComp:c=>{const s=a.value.componentData.findIndex(p=>p.id===c.id);s!=-1&&(a.value.componentData.splice(s,1),n())},updateCompPosition:c=>{const s=a.value.componentData.findIndex(p=>p.id===c.id);s!=-1&&(a.value.componentData[s]={...a.value.componentData[s],position:{...a.value.componentData[s].position,top:c.top,left:c.left},size:{...a.value.componentData[s].size,width:c.width,height:c.height}},n())}}}),et={class:"cfg"},ot=w({__name:"CfgArea",setup(a){const o=V(),{visualData:e,curCompData:t}=B(o);return(n,_)=>(l(),D("div",et,[u(P,{"form-data":y(t),id:y(t).formId},null,8,["form-data","id"])]))}}),at=I(ot,[["__scopeId","data-v-e2943ee0"]]),nt=[{name:"图片",type:"img",tag:"img",icon:"icon-image1",props:{src:"https://avatars.githubusercontent.com/u/59641156?v=4",draggable:!1},style:{width:"100%",height:"100%"},formId:"c0c67e96-858b-4303-999c-92d0d39cb792"},{name:"文本",type:"text",tag:"span",icon:"icon-text",props:{value:"text"}},{name:"视频",type:"video",tag:"video",icon:"icon-video",props:{src:"",controls:!0,draggable:!1},style:{width:"100%",height:"100%","object-fit":"fill","z-index":-1}},{name:"嵌入页",type:"iframe",tag:"iframe",icon:"icon-HTML",props:{src:"http://120.26.161.36:8080/",draggable:!1},style:{width:"100%",height:"100%","z-index":-1}}];class st{constructor(o,e){h(this,"name","组件");h(this,"id");h(this,"type");h(this,"tag");h(this,"icon");h(this,"props");h(this,"style");h(this,"formId","");h(this,"position",{top:0,left:0});h(this,"size",{width:0,height:0});this.id=e||X(),this.type=o;const t=nt.find(n=>n.type===o);t?(this.tag=t.tag,this.props=t.props,this.name=t.name,this.style=t.style,this.icon=t.icon,this.formId=t.formId):(this.tag="div",this.icon="icon")}}const it=w({__name:"DesignArea",setup(a){const o=V(),{visualData:e,curCompData:t}=B(o),{onClickComp:n,setSnapshot:_,updateCompPosition:g,addComp:f}=o,d=b(),i=s=>{s.preventDefault()},C=s=>{s.preventDefault();let p=JSON.parse(s.dataTransfer.getData("componentData"));p&&(p=new st(p.name),p.position={top:s.offsetY,left:s.offsetX},p.size={width:100,height:100},f(p))},c=()=>{};return(s,p)=>(l(),D("div",{ref_key:"container",ref:d,class:"container",onDragover:i,onDrop:C},[(l(!0),D(k,null,z(y(e).componentData,(v,L)=>(l(),S(y(Q),{key:v.id,minh:20,minw:20,width:v.size.width,height:v.size.height,top:v.position.top,left:v.position.left,"node-key":v.id,active:v.id==y(t).id,class:"drag",style:U({zIndex:`${L+100}`}),onUpdate:c,onClick:wt=>y(n)(v)},{default:m(()=>[(l(),S(R(v.tag),F({ref_for:!0},v.props,{style:v.style||{}}),null,16,["style"]))]),_:2},1032,["width","height","top","left","node-key","active","style","onClick"]))),128))],544))}}),ct=I(it,[["__scopeId","data-v-09d0266d"]]),lt=w({__name:"NodeRelationship",setup(a){const o=V(),{visualData:e}=B(o),{onClickComp:t}=o,n=(g,f)=>{t(f.node.dataRef)},_=g=>{};return(g,f)=>{const d=j;return l(),S(d,{class:"draggable-tree",draggable:"","block-node":"","tree-data":y(e).componentData,showIcon:!1,onSelect:n,onDrop:_},{title:m(({title:i,data:C})=>[r("div",null,[r("i",{class:$(["iconfont",C.icon])},null,2),x(" "+T(C.name)+"("+T(i)+") ",1)])]),_:1},8,["tree-data"])}}}),rt=I(lt,[["__scopeId","data-v-cda592df"]]),pt={class:"component-layout"},dt=["data-component"],ut={class:"component-item-text"},mt=w({__name:"MaterialArea",setup(a){const o=b(),e=[{title:"基础组件",value:"base",list:[{label:"图片",icon:"icon-image1",name:"img"},{label:"文本",icon:"icon-text",name:"text"},{label:"视频",name:"video",icon:"icon-video"},{label:"嵌入页",name:"iframe",icon:"icon-HTML"}]}],t=n=>{n&&n.target&&n.dataTransfer&&n.dataTransfer.setData("componentData",n.target.getAttribute("data-component"))};return(n,_)=>{const g=W,f=Y;return l(),S(f,{activeKey:o.value,"onUpdate:activeKey":_[0]||(_[0]=d=>o.value=d),class:"material-area",ghost:!0},{default:m(()=>[(l(),D(k,null,z(e,d=>u(g,{header:d.title,key:d.value},{default:m(()=>[r("div",pt,[(l(!0),D(k,null,z(d.list,i=>(l(),D("div",{class:"component-item",key:i.name,draggable:"true",onDragstart:t,"data-component":JSON.stringify(i)},[r("span",{class:$(["iconfont component-item-icon",i.icon])},null,2),r("span",ut,T(i.label),1)],40,dt))),128))])]),_:2},1032,["header"])),64))]),_:1},8,["activeKey"])}}}),_t=I(mt,[["__scopeId","data-v-5d71068a"]]),ft={class:"left-side-bar"},vt={class:"bar-top"},ht=["title","onClick"],gt={class:"header"},Dt={class:"title"},Ct={class:"container"},yt=w({__name:"LeftSideBar",setup(a){const o=[{label:"素材库",value:"componentLib",icon:"appstoreadd",component:_t},{label:"节点关系",value:"nodeRelationship",icon:"link",component:rt}],e=b(),t=b(!1),n=()=>{t.value=!t.value},_=f=>{e.value=f},g=()=>{e.value=void 0};return(f,d)=>(l(),D(k,null,[r("div",ft,[r("ul",vt,[(l(),D(k,null,z(o,i=>r("li",{key:i.value,title:i.label,class:$([`iconfont icon-${i.icon}`,e.value&&e.value.value===i.value?"active":""]),onClick:C=>_(i)},null,10,ht)),64))])]),e.value?(l(),D("div",{class:$(["left-part",t.value?"affix":""]),key:e.value.value},[r("div",gt,[r("div",Dt,T(e.value.label),1),r("div",{class:$(["affix iconfont",t.value?"icon-pushpin-fill":"icon-pushpin"]),onClick:n},null,2),r("div",{class:"close iconfont icon-close",onClick:g})]),r("div",Ct,[(l(),S(R(e.value.component)))])],2)):H("",!0)],64))}}),bt=I(yt,[["__scopeId","data-v-49c5d324"]]),xt={class:"design-container"},kt=w({__name:"VisualEditor",setup(a){const o=O(),e=N(()=>"title"),t=N(()=>"desc"),n=()=>{},_=()=>{},g=()=>{o.go(-1)};return(f,d)=>{const i=G,C=Z,c=tt,s=q;return l(),D(k,null,[u(s,{title:e.value,subTitle:t.value,onBack:g,ghost:!1,style:{padding:"10px 24px"}},{extra:m(()=>[u(C,null,{default:m(()=>[u(i,null,{default:m(()=>[x("加载外部组件")]),_:1}),u(i,{onClick:n,class:"variable-btn"},{default:m(()=>[x(" 变量池配置 ")]),_:1}),u(i,{onClick:_,type:"primary",class:"save-btn"},{default:m(()=>[x(" 保存 ")]),_:1})]),_:1})]),tags:m(()=>[u(c,{color:"#87d068"},{default:m(()=>[x("启用")]),_:1}),u(c,{color:"#f50"},{default:m(()=>[x("停用")]),_:1})]),_:1},8,["title","subTitle"]),r("div",xt,[u(bt,{class:"left-sider"}),u(ct),u(at)])],64)}}}),re=I(kt,[["__scopeId","data-v-e015f8e4"]]);export{re as default};
