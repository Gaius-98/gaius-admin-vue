import{_ as j}from"./LowCodeFormId.vue_vue_type_script_setup_true_lang-DXpA8Rmr.js";import{t as P}from"./table-CRc_961G.js";import{h as A}from"./http-DHaoC6N2.js";import{d as E,ak as J,r as i,t as M,w as I,J as y,L as N,U as S,M as l,a3 as x,g as e,a0 as Q,as as R,O as z,aa as B,Q as k,a2 as O,X as U,Z as X,ah as Z,a6 as q}from"./index-DZkXttzx.js";import{C as G,_ as H,a as K}from"./index-DDmHmjDB.js";import{U as W}from"./index-BRTd78F_.js";import{D as Y}from"./index-CbZog8kM.js";import{S as aa}from"./SyncOutlined-ImuJvVYz.js";import{_ as ta,a as ea}from"./index-CpRda6tg.js";import"./LowCodeForm.vue_vue_type_script_setup_true_lang-BxxJLiR-.js";import"./common-L0hNq6V9.js";import"./index-4YR8CJXw.js";import"./index-BXxr4KJw.js";import"./index-MC718ZmO.js";import"./SwapRightOutlined-EUI3VeM8.js";import"./index-BI1jqpAh.js";import"./form-Dxxlxz6Q.js";import"./index-Bf2IWzTQ.js";import"./EllipsisOutlined-B_-cNhqN.js";import"./index-CgGsaf3u.js";import"./index-3P0CXyaO.js";import"./FolderOutlined-ZhO28QJt.js";import"./useBreakpoint-BPRCS-jZ.js";import"./index-Dgz-NsWZ.js";const oa=c=>{const u={};return c.reduce((r,a)=>(r[a.key]=a.defaultValue,r),u),u},na=async(c,u,r)=>{try{const a=await A.run(c.interfaceUrl,{...u,...r});return new Function("res",c.handlerFunc)(a.data)}catch(a){return a}},V={refreshData:na,transformParamsData:oa},sa={class:"low-code-table"},la={style:{"font-size":"12px"}},ra={class:"tools"},ia=["href"],ca=E({__name:"LowCodeTable",props:{id:{}},setup(c){const u=c,{id:r}=J(u),a=i({}),h=i([]),v=i({}),b=i(!1),$=()=>{v.value={},_()},m=i(!1),w=M(()=>{var o,t,n,d,g,f;return((n=(t=(o=a.value)==null?void 0:o.global)==null?void 0:t.filterCfg)==null?void 0:n.show)&&((f=(g=(d=a.value)==null?void 0:d.global)==null?void 0:g.filterCfg)==null?void 0:f.formId)}),p=i({});I(()=>r.value,()=>{P.getDetail(r.value).then(o=>{const{code:t,data:n,msg:d}=o;t==200&&(a.value=n,p.value=V.transformParamsData(a.value.variablePool),_())})},{immediate:!0}),I(()=>p.value,()=>{_()},{deep:!0});const D=i(0),_=async()=>{b.value=!0;try{const{data:o,total:t}=await V.refreshData(a.value.dataSource,p.value,v.value);h.value=o,t&&(D.value=t)}catch(o){Q.error("获取数据失败:"+o)}b.value=!1};return(o,t)=>{const n=X,d=H,g=K,f=G,F=Z,L=ta,T=ea;return y(),N("div",sa,[w.value?(y(),S(f,{key:0,class:"filter-panel"},{default:l(()=>[e(j,{formData:v.value,id:a.value.global.filterCfg.formId,class:R(["filter-form",m.value?"expand":""])},null,8,["formData","id","class"]),e(g,null,{default:l(()=>[e(d,{span:24,style:{"text-align":"right"}},{default:l(()=>[e(n,{type:"primary","html-type":"submit",onClick:_},{default:l(()=>[z("搜索")]),_:1}),e(n,{style:{margin:"0 8px"},onClick:$},{default:l(()=>[z("重置")]),_:1}),e(n,{type:"link",icon:B(m.value?k(W):k(Y)),onClick:t[0]||(t[0]=s=>m.value=!m.value)},{default:l(()=>[O("span",la,U(m.value?"收起":"展开"),1)]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})):x("",!0),e(f,{class:"table-container"},{default:l(()=>[O("div",ra,[e(n,{icon:B(k(aa)),type:"link",title:"刷新数据",style:{float:"right"},onClick:_},null,8,["icon"])]),e(L,{columns:a.value.columns,"data-source":h.value,scroll:{y:w.value?470:670},loading:b.value,pagination:!1},{bodyCell:l(({column:s,record:C})=>[s.type=="image"?(y(),S(F,{key:0,src:`${C[s.dataIndex]}`,height:"130px",width:"100%"},null,8,["src"])):x("",!0),s.type=="link"?(y(),N("a",{key:1,href:`${C[s.dataIndex]}`,target:"_blank"},U(C[s.dataIndex]),9,ia)):x("",!0)]),_:1},8,["columns","data-source","scroll","loading"]),e(T,{style:{display:"flex","justify-content":"flex-end","margin-top":"20px"},current:p.value.pageNumber,"onUpdate:current":t[1]||(t[1]=s=>p.value.pageNumber=s),pageSize:p.value.pageSize||10,total:D.value,"show-less-items":""},null,8,["current","pageSize","total"])]),_:1})])}}}),$a=q(ca,[["__scopeId","data-v-aa8aa963"]]);export{$a as default};
