import{a8 as c,d as ae,a2 as te,e as r,B as R,h as oe,N as _,O as w,k as e,V as t,a3 as V,a0 as m,a4 as ne,U as x,a1 as le,a5 as b,Z as z,Q as se}from"./index-Q_LEWK6E.js";import{C as ue,_ as re,a as de}from"./index-By70sYAT.js";import{M as ie}from"./index-Df3fhuFZ.js";import{I as me,_ as pe,B as ce,F as _e,b as ve}from"./index-CWL3bAtR.js";import{T as fe,S as ge}from"./index-CyGgqfN5.js";import{_ as ye,a as ke,b as be}from"./index-BKBXWhj-.js";import"./index-Dk2B38mc.js";import"./PlusOutlined-mrNONVS0.js";import"./index-xbjEHnFq.js";import"./FolderOutlined-DKfAmW6F.js";import"./RightOutlined-DC8EJ79U.js";const v={getList:u=>c({method:"get",url:"user/list",params:u}),getDetail:u=>c({method:"get",url:"user/detail",params:{username:u}}),remove:u=>c({method:"get",url:"user/remove",params:{username:u}}),add:u=>c({method:"post",url:"user/register",data:u}),update:u=>c({method:"post",url:"user/update",data:u}),getRoleDict:()=>c({method:"get",url:"role/dict"})},Ce={class:"user"},Ie={class:"tools"},we=ae({__name:"UserView",setup(u){const d=te({keyword:"",pageNumber:1,pageSize:10}),F=r([]),L=r([{title:"用户名",key:"username",dataIndex:"username"},{title:"名称",key:"name",dataIndex:"name"},{title:"邮箱",key:"email",dataIndex:"email"},{title:"角色",key:"roleId",dataIndex:"roleId"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"action",dataIndex:"action"}]),C=r(!1),N=r(),$=()=>{var o;(o=N.value)==null||o.resetFields(),p()},h=r(0),M=()=>{d.pageNumber=1,d.pageSize=10,p()},j=o=>{const{current:a,pageSize:l}=o;d.pageNumber=a,d.pageSize=l,p()},p=()=>{C.value=!0,v.getList(d).then(o=>{const{code:a,data:l}=o;a==200&&(F.value=l.data,h.value=l.total),C.value=!1})};R(()=>{p()});const f=r(!1),s=r({username:"",name:"",password:"",email:"",avatar:"",roleId:""}),g=r("add"),E=oe(()=>({add:"新增用户",edit:"编辑用户"})[g.value]),D=r(),P=()=>{g.value="add",f.value=!0,s.value={username:"",name:"",password:"",email:"",avatar:"",roleId:""}},q=async o=>{const{code:a,data:l}=await v.getDetail(o.username);a==200&&(s.value=l,g.value="edit",f.value=!0)},A=async o=>{const{code:a,msg:l,data:i}=await v.remove(o.username);a==200&&(V.success(i),p())},T=()=>{var o;(o=D.value)==null||o.resetFields()},Q=()=>{let o;g.value=="add"?o=v.add:o=v.update,o(s.value).then(a=>{const{code:l}=a;l==200&&(V.success(g.value=="add"?"新增成功":"编辑成功"),p()),T(),f.value=!1})},U=r([]),Z=()=>{v.getRoleDict().then(o=>{const{code:a,data:l,msg:i}=o;a==200&&(U.value=l)})};return R(()=>{Z()}),(o,a)=>{const l=me,i=pe,S=re,y=ce,G=de,B=_e,O=ue,I=fe,H=ye,J=ke,K=be,W=ve,X=ge,Y=ie;return _(),w("div",Ce,[e(O,{class:"search-area"},{default:t(()=>[e(B,{ref_key:"searchFormRef",ref:N,model:d,onFinish:M},{default:t(()=>[e(G,{gutter:24},{default:t(()=>[e(S,{span:4},{default:t(()=>[e(i,{label:"用户名",name:"keyword"},{default:t(()=>[e(l,{value:d.keyword,"onUpdate:value":a[0]||(a[0]=n=>d.keyword=n)},null,8,["value"])]),_:1})]),_:1}),e(S,{span:4,style:{"text-align":"right"}},{default:t(()=>[e(y,{type:"primary","html-type":"submit"},{default:t(()=>[m("搜索")]),_:1}),e(y,{style:{margin:"0 8px"},onClick:$},{default:t(()=>[m(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(O,null,{default:t(()=>[ne("div",Ie,[e(y,{type:"primary",onClick:P},{default:t(()=>[m("新增")]),_:1})]),e(K,{loading:C.value,columns:L.value,"data-source":F.value,scroll:{y:440},onChange:j,pagination:{current:d.pageNumber,total:h.value}},{bodyCell:t(({column:n,record:k})=>[n.key=="role"?(_(),x(I,{key:0},{default:t(()=>[m(le(k.role),1)]),_:2},1024)):b("",!0),n.key=="action"?(_(),w(z,{key:1},[e(y,{type:"link",onClick:ee=>q(k)},{default:t(()=>[m("编辑")]),_:2},1032,["onClick"]),e(H,{type:"vertical"}),e(J,{title:"确定要删除吗?","ok-text":"确定","cancel-text":"取消",onConfirm:ee=>A(k)},{default:t(()=>[e(y,{type:"link",danger:""},{default:t(()=>[m("删除")]),_:1})]),_:2},1032,["onConfirm"])],64)):b("",!0),n.key=="userType"?(_(),w(z,{key:2},[k.userType=="app"?(_(),x(I,{key:0,color:"#2db7f5"},{default:t(()=>[m("菜单")]),_:1})):b("",!0),k.userType=="directory"?(_(),x(I,{key:1,color:"#87d068"},{default:t(()=>[m("目录")]),_:1})):b("",!0)],64)):b("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1}),e(Y,{open:f.value,"onUpdate:open":a[6]||(a[6]=n=>f.value=n),onOk:Q,title:E.value,onCancel:T},{default:t(()=>[e(B,{model:s.value,"label-col":{span:8},ref_key:"modalFormRef",ref:D},{default:t(()=>[e(i,{label:"用户名"},{default:t(()=>[e(l,{value:s.value.username,"onUpdate:value":a[1]||(a[1]=n=>s.value.username=n)},null,8,["value"])]),_:1}),e(i,{label:"密码"},{default:t(()=>[e(W,{value:s.value.password,"onUpdate:value":a[2]||(a[2]=n=>s.value.password=n)},null,8,["value"])]),_:1}),e(i,{label:"角色"},{default:t(()=>[e(X,{value:s.value.roleId,"onUpdate:value":a[3]||(a[3]=n=>s.value.roleId=n),fieldNames:{label:"roleName",value:"roleId"},options:U.value},null,8,["value","options"])]),_:1}),e(i,{label:"名称"},{default:t(()=>[e(l,{value:s.value.name,"onUpdate:value":a[4]||(a[4]=n=>s.value.name=n)},null,8,["value"])]),_:1}),e(i,{label:"邮箱"},{default:t(()=>[e(l,{value:s.value.email,"onUpdate:value":a[5]||(a[5]=n=>s.value.email=n)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])])}}}),Ve=se(we,[["__scopeId","data-v-b9e1fb1f"]]);export{Ve as default};
